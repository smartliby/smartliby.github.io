<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[é€šè¿‡Travis CIè‡ªåŠ¨æž„å»ºé•œåƒåˆ°é˜¿é‡Œäº‘é•œåƒåº“å’Œdockehub]]></title>
    <url>%2F2020%2F04%2F19%2F%E9%80%9A%E8%BF%87Travis-CI%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E5%BA%93%E5%92%8Cdockehub%2F</url>
    <content type="text"><![CDATA[å…¶å®žä¹‹å‰æˆ‘å·²ç»å†™è¿‡ä¸€ç¯‡å…³äºŽé€šè¿‡é˜¿é‡Œäº‘é•œåƒåº“ä¸‹è½½gcr.ioé•œåƒçš„æ–‡ç« ï¼Œä½†æ˜¯è¯¥æ–¹æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯æ¬¡éœ€è¦æ–°çš„é•œåƒéƒ½éœ€è¦åœ¨é˜¿é‡Œäº‘é•œåƒåº“æ‰‹åŠ¨åˆ›å»ºï¼Œå¤ªéº»çƒ¦äº†ï¼Œè¿™ç¯‡æ–‡ç« é€šè¿‡Travis CIå¯ä»¥è‡ªåŠ¨æž„å»ºé•œåƒåˆ°é˜¿é‡Œäº‘ï¼Œæ–¹ä¾¿å¥½ç”¨ åˆ›å»ºgithubä»“åº“é¦–å…ˆç™»å½•githubåˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œåç§°è‡ªå®šä¹‰ï¼Œä»“åº“åŒ…å«å¦‚ä¸‹2ä¸ªæ–‡ä»¶ï¼š img-list.txt å¤–ç½‘é•œåƒåˆ—è¡¨æ–‡ä»¶.travis.yaml travisCIè‡ªåŠ¨æž„å»ºæ–‡ä»¶ç¤ºä¾‹ä»“åº“ï¼šhttps://github.com/smartliby/pull-docker-images .travis.yaml å†…å®¹å¦‚ä¸‹ï¼Œä¸»è¦ä»Žå›½å¤–é•œåƒä»“åº“pullé•œåƒï¼Œæ‰“tagï¼Œå¹¶pushåˆ°é˜¿é‡Œäº‘æˆ–dockerhub 1234567891011121314151617181920212223242526272829303132language: bashservices: - dockerenv: global: # change the registry name and username/password to yourself&apos;s. - DOCKER_HUB=smartliby - ALI_REGISTRY=registry.cn-hangzhou.aliyuncs.com/smartlibybefore_script: - echo &quot;$DOCKER_PASSWORD&quot; | docker login -u &quot;$DOCKER_USERNAME&quot; --password-stdin - echo &quot;$ALI_PASSWORD&quot; | docker login &quot;$ALI_REGISTRY&quot; -u &quot;$ALI_USERNAME&quot; --password-stdin script: - echo &quot;start pull and retag and push&quot; - | for image in $(cat img-list.txt) do image_name=$&#123;image##*/&#125; image_name=$&#123;image_name%@*&#125; docker pull $image docker tag $image $DOCKER_HUB/$image_name echo $ALI_REGISTRY docker tag $image $ALI_REGISTRY/$image_name # pushåˆ°dockerhub docker push $DOCKER_HUB/$image_name # pushåˆ°é˜¿é‡Œäº‘ä»“åº“ docker push $ALI_REGISTRY/$image_name done .travis.yamlæ–‡ä»¶ç›‘æµ‹githubä»“åº“çš„ä»£ç å˜åŠ¨ï¼Œå½“æœ‰ä»£ç å˜åŠ¨æ—¶æ¯”å¦‚img-list.txtå†™å…¥æ–°çš„é•œåƒåˆ—è¡¨æ—¶å°†è§¦å‘tarvisçš„è‡ªåŠ¨æž„å»ºè¿™é‡Œéœ€è¦ç™»å½•é˜¿é‡Œäº‘æˆ–dockerhubæ‰èƒ½æ‰§è¡Œdocker pushæ“ä½œï¼Œå…¶ä¸­$ALI_USERNAMEè¿™ç±»å˜é‡åœ¨TravisCIç®¡ç†ç•Œé¢å®šä¹‰å¥½å³å¯ã€‚ Travis CIé…ç½®è®¿é—®traviså®˜ç½‘ï¼š https://www.travis-ci.comï¼Œ ä½¿ç”¨githubè´¦å·ç™»å½•ã€‚ å¼€å¯éœ€è¦è¿›è¡Œè‡ªåŠ¨åŒ–æž„å»ºçš„ä»“åº“å¹¶è®¾ç½®$ALI_USERNAMEè¿™ç±»å˜é‡å³å¯ å½“å¯¹githubä»“åº“æ‰§è¡Œgit commitã€git pushæ“ä½œæ—¶å°†è‡ªåŠ¨è§¦å‘æž„å»ºï¼Œæ‰§è¡Œä»“åº“ä¸­çš„è„šæœ¬ ç™»å½•é˜¿é‡Œäº‘æˆ–dockerhubæŸ¥çœ‹ï¼Œimg-list.txt åˆ—è¡¨ä¸­çš„é•œåƒå·²ç»æˆåŠŸè¢«pushä¸Šæ¥ å‚è€ƒ[1] https://blog.csdn.net/networken/article/details/84571373]]></content>
      <categories>
        <category>k8s</category>
      </categories>
      <tags>
        <tag>k8s</tag>
        <tag>github</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[miniKFå®‰è£…æ•™ç¨‹]]></title>
    <url>%2F2020%2F04%2F19%2FminiKF%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[MiniKF is a fast and easy way to get started with Kubeflow. With just a few clicks, you are up for experimentation, and for running complete Kubeflow Pipelines. ä¸‹è½½vagrant12wget https://releases.hashicorp.com/vagrant/2.2.7/vagrant_2.2.7_x86_64.debsudo dpkg -i vagrant_2.2.7_x86_64.deb å®‰è£… Virtual Box12wget https://download.virtualbox.org/virtualbox/6.1.6/virtualbox-6.1_6.1.6-137129~Ubuntu~bionic_amd64.debsudo dpkg -i virtualbox-6.1_6.1.6-137129~Ubuntu~bionic_amd64.deb å®‰è£…MiniKFOpen a terminal on your laptop, create a new directory, switch into it, and run the following commands to install MiniKF 1234mkdir -p /data/miniKF/cd /data/miniKF/vagrant init arrikto/minikfvagrant up æ•´ä¸ªå®‰è£…è¿‡ç¨‹éœ€è¦ä¸‹è½½30Gå·¦å³çš„æ–‡ä»¶ï¼Œå¹¶ä¸”éœ€è¦è®¿é—®googleï¼Œæ‰€ä»¥éœ€è¦ä»£ç†,å‡ºçŽ°å¦‚ä¸‹å†…å®¹è¡¨ç¤ºå®‰è£…æˆåŠŸ 123456789101112131415161718192021222324==&gt; default: Machine booted and ready!==&gt; default: Checking for guest additions in VM... default: The guest additions on this VM do not match the installed version of default: VirtualBox! In most cases this is fine, but in rare cases it can default: prevent things such as shared folders from working properly. If you see default: shared folder errors, please make sure the guest additions within the default: virtual machine match the version of VirtualBox you have installed on default: your host and reload your VM. default: default: Guest Additions Version: 6.0.14_Ubuntu r132055 default: VirtualBox Version: 5.2==&gt; default: Using /data/miniKF/minikf-user-data.vdi for persistent storage.==&gt; default: ** Managing persistent storage **==&gt; default: Setting hostname...==&gt; default: Configuring and enabling network interfaces...==&gt; default: Mounting shared folders... default: /vagrant =&gt; /data/miniKF==&gt; default: Machine &apos;default&apos; has a post `vagrant up` message. This is a message==&gt; default: from the creator of the Vagrantfile, and not from Vagrant itself:==&gt; default: ==&gt; default: Welcome to MiniKF!==&gt; default: Visit http://10.10.10.10/ to get started.==&gt; default: è®¿é—®http://10.10.10.10/ï¼Œç‚¹å‡»é¡µé¢çš„OKæŒ‰é’®ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åŽæ•´ä¸ªæœåŠ¡å°±å¯åŠ¨äº†ï¼Œç‚¹å‡»connect to Kubeflowå°±è¿›å…¥äº†kubeflowçš„æ“ä½œç•Œé¢ å‚è€ƒ[1] https://www.kubeflow.org/docs/started/workstation/getting-started-minikf/]]></content>
      <categories>
        <category>miniKF</category>
      </categories>
      <tags>
        <tag>k8s</tag>
        <tag>miniKF</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[minikubeå®‰è£…æ•™ç¨‹]]></title>
    <url>%2F2020%2F04%2F18%2Fminikube%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[minikube æ˜¯ K8S å®˜æ–¹ä¸ºäº†å¼€å‘è€…èƒ½åœ¨ä¸ªäººç”µè„‘ä¸Šè¿è¡Œ K8S è€Œæä¾›çš„ä¸€å¥—å·¥å…·ã€‚å®žçŽ°ä¸Šæ˜¯é€šè¿‡ Go è¯­è¨€ç¼–å†™ï¼Œé€šè¿‡è°ƒç”¨è™šæ‹ŸåŒ–ç®¡ç†ç¨‹åºï¼Œåˆ›å»ºå‡ºä¸€ä¸ªè¿è¡Œåœ¨è™šæ‹Ÿæœºå†…çš„å•èŠ‚ç‚¹é›†ç¾¤ã€‚ æœ¬æ¬¡å®‰è£…çš„minikubeç‰ˆæœ¬ä¸º1.2.0ï¼ˆk8s 1.15.0ï¼‰ï¼Œå¹¶æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆ1.9.2ï¼ŒåŽŸå› æ˜¯æˆ‘è¦åŸºäºŽk8så®‰è£…kubeflowï¼Œkubeflowå¯¹k8s 1.16åŠä»¥ä¸Šç‰ˆæœ¬å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥ä¸ºé¿å…ä¸å¿…è¦çš„éº»çƒ¦å°±å®‰è£…äº†è€ç‰ˆæœ¬çš„minikubeã€‚ å®‰è£…docker123456789apt-get update apt-get install -y apt-transport-https ca-certificates curl software-properties-common curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - add-apt-repository \ &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \ $(lsb_release -cs) \ Stable&quot; apt-get update apt-get install -y docker-ce æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ 1docker run hello-world å®‰è£…kubectl1curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.15.0/bin/linux/amd64/kubectl å¦‚æžœç”±äºŽå¢™çš„é—®é¢˜æ— æ³•ä¸‹è½½å¯ä»¥è®¿é—®ä¸‹é¢çš„githubåœ°å€ï¼Œç‚¹å‡»é€‰æ‹©å¯¹åº”ç‰ˆæœ¬mdè¿›å…¥ï¼Œæ‰¾åˆ°client binariesï¼ˆä¹Ÿå°±æ˜¯kubectlï¼‰ï¼Œé€‰æ‹©å¯¹åº”æ“ä½œç³»ç»Ÿçš„å®¢æˆ·ç«¯ç„¶åŽå¤åˆ¶è¿žæŽ¥åœ°å€ä¸‹è½½ 1https://github.com/kubernetes/kubernetes/tree/master/CHANGELOG èµ‹äºˆæ‰§è¡Œæƒé™ 12chmod +x ./kubectlsudo mv ./kubectl /usr/bin/kubectl æŸ¥çœ‹ç‰ˆæœ¬ 1sudo kubectl version --client ç»“æžœå¦‚ä¸‹ 1Client Version: version.Info&#123;Major:&quot;1&quot;, Minor:&quot;15&quot;, GitVersion:&quot;v1.15.0&quot;, GitCommit:&quot;e8462b5b5dc2584fdcd18e6bcfe9f1e4d970a529&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-06-19T16:40:16Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;&#125; å®‰è£…minikubeä¸‹è½½minikube 1https://github.com/kubernetes/minikube/releases/download/v1.2.0/minikube_1.2.0.deb å®‰è£…minikube 1sudo dpkg -i minikube_1.2.0.deb å¯åŠ¨minikube1sudo minikube start --vm-driver=none --image-repository=registry.cn-hangzhou.aliyuncs.com/google_containers --cpus 6 --memory 12288 --disk-size=120g --extra-config=apiserver.authorization-mode=RBAC --extra-config=kubelet.resolv-conf=/run/systemd/resolve/resolv.conf --extra-config kubeadm.ignore-preflight-errors=SystemVerification æ‰§è¡Œç»“æžœå¦‚ä¸‹è¡¨ç¤ºéƒ¨ç½²å¯åŠ¨æˆåŠŸ 1234567891011121314151617181920212223242526ðŸ˜„ minikube v1.2.0 on linux (amd64)âœ… using image repository registry.cn-hangzhou.aliyuncs.com/google_containersðŸ”¥ Creating none VM (CPUs=6, Memory=12288MB, Disk=120000MB) ...ðŸ³ Configuring environment for Kubernetes v1.15.0 on Docker 19.03.8 â–ª apiserver.authorization-mode=RBAC â–ª kubelet.resolv-conf=/run/systemd/resolve/resolv.conf â–ª kubeadm.ignore-preflight-errors=SystemVerification â–ª kubelet.resolv-conf=/run/systemd/resolve/resolv.confðŸšœ Pulling images ...ðŸš€ Launching Kubernetes ... ðŸ¤¹ Configuring local host environment ...âš ï¸ The &apos;none&apos; driver provides limited isolation and may reduce system security and reliability.âš ï¸ For more information, see:ðŸ‘‰ https://github.com/kubernetes/minikube/blob/master/docs/vmdriver-none.mdâš ï¸ kubectl and minikube configuration will be stored in /home/libyâš ï¸ To use kubectl or minikube commands as your own user, you mayâš ï¸ need to relocate them. For example, to overwrite your own settings: â–ª sudo mv /home/liby/.kube /home/liby/.minikube $HOME â–ª sudo chown -R $USER $HOME/.kube $HOME/.minikubeðŸ’¡ This can also be done automatically by setting the env var CHANGE_MINIKUBE_NONE_USER=trueâŒ› Verifying: apiserver proxy etcd scheduler controller dnsðŸ„ Done! kubectl is now configured to use &quot;minikube&quot; æ‰§è¡Œsudo minikube statusæŸ¥çœ‹minikubeè¿è¡Œæƒ…å†µ 1234host: Runningkubelet: Runningapiserver: Runningkubectl: Correctly Configured: pointing to minikube-vm at 192.168.0.110 æŸ¥çœ‹podè¿è¡Œæƒ…å†µ 1sudo kubectl get pods --all-namespaces å¦‚ä¸‹podè¿è¡Œæ­£å¸¸ 1234567891011NAMESPACE NAME READY STATUS RESTARTS AGEkube-system coredns-6967fb4995-svq2c 1/1 Running 79 3d19hkube-system coredns-6967fb4995-wlk48 1/1 Running 79 3d19hkube-system etcd-minikube 1/1 Running 0 13hkube-system kube-addon-manager-minikube 1/1 Running 5 3d19hkube-system kube-apiserver-minikube 1/1 Running 0 13hkube-system kube-controller-manager-minikube 1/1 Running 45 3d19hkube-system kube-proxy-fxp74 1/1 Running 5 3d19hkube-system kube-scheduler-minikube 1/1 Running 37 3d19hkube-system kubernetes-dashboard-95564f4f-ql2zr 1/1 Running 8 3d19hkube-system storage-provisioner 1/1 Running 0 12h æ‰§è¡Œsudo minikube dashboardæ‰“å¼€KubernetesæŽ§åˆ¶å° 1234ðŸ¤” Verifying dashboard health ...ðŸš€ Launching proxy ...ðŸ¤” Verifying proxy health ...ðŸŽ‰ Opening http://127.0.0.1:41123/api/v1/namespaces/kube-system/services/http:kubernetes-dashboard:/proxy/ in your default browser... minikubeåŸºæœ¬æ“ä½œæ£€æµ‹é›†ç¾¤çŠ¶æ€ 1sudo kubectl cluster-info minikubeçš„é…ç½®æ–‡ä»¶åœ¨å¦‚ä¸‹è·¯å¾„ 1~/.minikube/machines/minikube/config.json æ£€éªŒnodeçŠ¶æ€ 1sudo kubectl get nodes åœæ­¢è¿è¡Œä¸­çš„kubernetesé›†ç¾¤ 1sudo minikube stop åˆ é™¤æœ¬åœ°çš„kubernetesé›†ç¾¤ 1sudo minikube delete å¦‚æžœå®‰è£…äº†kubeflowï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤èŽ·å–Kubeflow Dashboardçš„è®¿é—®ipå’Œç«¯å£ 12export INGRESS_HOST=$(sudo minikube ip)export INGRESS_PORT=$(sudo kubectl -n istio-system get service istio-ingressgateway -o jsonpath=&apos;&#123;.spec.ports[?(@.name==&quot;http2&quot;)].nodePort&#125;â€™)]]></content>
      <categories>
        <category>minikube</category>
      </categories>
      <tags>
        <tag>k8s</tag>
        <tag>ubuntu</tag>
        <tag>minikube</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu+Hexo+Github Pagesæ­å»ºä¸ªäººåšå®¢]]></title>
    <url>%2F2020%2F04%2F06%2FUbuntu-Hexo-Github-Pages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%2F</url>
    <content type="text"><![CDATA[æˆ‘çš„ä¸ªäººåšå®¢å…¶å®žè‹¥å¹²å¹´å‰å°±æ­å»ºå®Œæˆå¹¶æŠ•å…¥ä½¿ç”¨äº†ï¼Œä½†æ˜¯æ¯”è¾ƒæ‡’ä¸€ç›´æ²¡æœ‰å†™ç¬”è®°ï¼Œæœ€è¿‘å‘çŽ°ç™¾åº¦çˆ¬è™«æ²¡æœ‰æ”¶å½•æˆ‘çš„ä¸ªäººåšå®¢æ–‡ç« ï¼Œç ”ç©¶äº†ä¸€ä¸‹å‘çŽ°æ˜¯githubæŠŠç™¾åº¦çˆ¬è™«ç»™ç¦æŽ‰äº†ï¼Œè§£å†³ä¸€ä¸‹é¡ºä¾¿è¡¥ä¸€ä¸‹ç¬”è®°å§ å®‰è£…NodejsNode.jsæ˜¯åŸºäºŽChrome V8å¼•æ“Žçš„JavaScriptè¿è¡ŒçŽ¯å¢ƒï¼Œnpmæ˜¯éšNode.jsä¸€èµ·å®‰è£…çš„åŒ…ç®¡ç†å·¥å…·ï¼Œæ–°ç‰ˆçš„Node.jsé›†æˆäº†npmã€‚ 12sudo apt install nodejssudo apt install npm æ£€æŸ¥nodeç‰ˆæœ¬ï¼šnode -v 1v8.10.0 æ£€æŸ¥npmç‰ˆæœ¬ï¼šnpm -v 16.9.0 å®‰è£…HexoHexoæ˜¯ä¸€ä¸ªåŸºäºŽnode.jsçš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æž¶ï¼Œæ”¯æŒMarkdownè§£æžæ–‡ç« ã€‚ç®€è¨€ä¹‹ï¼Œhexoå°†Markdownç¼–å†™çš„æ–‡ç« ç”Ÿæˆä¸ºé™æ€htmlé¡µé¢ï¼Œç„¶åŽéƒ¨ç½²åˆ°githubã€‚å®‰è£…hexoï¼šsudo npm install -g hexoã€‚åœ¨æŒ‡å®šæ–‡ä»¶å¤¹æ–°å»ºæ‰€éœ€çš„æ–‡ä»¶ï¼š 123hexo init &lt;blog-name&gt;cd &lt;blog-name&gt;npm install è¯¥ä½ç½®å°±æ˜¯hexoçš„å·¥ä½œç©ºé—´ï¼Œè¯¥å·¥ä½œç©ºé—´çš„ç›®å½•å¦‚ä¸‹ï¼š 12345678.â”œâ”€â”€ _config.ymlâ”œâ”€â”€ package.jsonâ”œâ”€â”€ scaffoldsâ”œâ”€â”€ source| â”œâ”€â”€ _drafts| â””â”€â”€ _postsâ””â”€â”€ themes å…¶ä¸­ï¼Œ_config.ymlæ˜¯åšå®¢ç½‘ç«™çš„é…ç½®æ–‡ä»¶,sourceæ–‡ä»¶å¤¹æ˜¯å­˜æ”¾ç”¨æˆ·èµ„æºçš„åœ°æ–¹ï¼Œ_posts æ–‡ä»¶å¤¹å­˜æ”¾Markdownæ–‡ä»¶ï¼ˆ.mdï¼‰ï¼Œscaffoldsæ˜¯æ¨¡æ¿æ–‡ä»¶å¤¹ï¼Œå½“ç”¨hexoæ–°å»ºæ–‡ç« æ—¶ï¼Œhexoä¼šæ ¹æ®scaffoldsæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶æ¥å»ºç«‹æ–‡ä»¶ï¼Œthemesæ–‡ä»¶å¤¹æ˜¯å­˜æ”¾ä¸»é¢˜çš„æ–‡ä»¶å¤¹ï¼Œhexoæ ¹æ®ä¸»é¢˜ç”Ÿæˆé™æ€é¡µé¢ã€‚å…³äºŽ_config.ymlçš„è¡¥å……è¯´æ˜Žï¼šå…¶ä¸­å·¥ä½œç©ºé—´æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ª_config.ymlï¼Œæ˜¯åšå®¢ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œthemesæ–‡ä»¶å¤¹ä¸­å¯¹åº”ä¸åŒä¸»é¢˜çš„ç›®å½•ä¸‹ä¹Ÿæœ‰ä¸€ä¸ª_config.ymlæ–‡ä»¶å¤¹ï¼Œæ˜¯ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ã€‚ é…ç½®Hexohexoå¸¸ç”¨å‘½ä»¤ å‘½ä»¤ ä½œç”¨ ç®€å†™ hexo init â€œfolder-nameâ€ æ–°å»ºä¸€ä¸ªç½‘ç«™ hexo new â€œtitle-nameâ€ æ–°å»ºä¸€ç¯‡æ–‡ç«  hexo clean æ¸…é™¤ç¼“å­˜æ–‡ä»¶ hexo generate ç”Ÿæˆé™æ€æ–‡ä»¶ hexo g hexo server å¯åŠ¨æœåŠ¡å™¨ï¼Œé»˜è®¤æœåŠ¡å™¨ç½‘å€ï¼šhttp://localhost:4000/ hexo s hexo deploy éƒ¨ç½²ç½‘ç«™ hexo d æ›´æ¢ä¸»é¢˜é»˜è®¤ä¸»é¢˜ä¸ºlandscapeï¼Œæ›´æ¢ä¸ºnextæˆ–å…¶å®ƒä¸»é¢˜ã€‚ä¸‹è½½ä¸»é¢˜å‘½ä»¤ï¼š 12git clone https://github.com/theme-next/hexo-theme-nextgit pull æˆ‘ä¸€èˆ¬ä¼šåœ¨è‡ªå·±çš„githubä¿å­˜hexo-theme-nextä¸»é¢˜ï¼Œè¿™æ ·æ–¹ä¾¿ä¸ªæ€§åŒ–ä¿®æ”¹ä¿å­˜ï¼Œæˆ‘çš„ä¸»é¢˜åœ°å€å¤§å®¶å¯ä»¥å‚è€ƒä¸‹ 1git@github.com:smartliby/hexo-theme-next.git é‡‡ç”¨gitå‘½ä»¤å…‹éš†ä¸»é¢˜æ–‡ä»¶ï¼Œä»¥åŽæ›´æ–°å¯ä»¥é€šè¿‡git pullå‘½ä»¤æ¥å¿«é€Ÿæ›´æ–°ï¼Œè€Œä¸ç”¨å†æ¬¡ä¸‹è½½å®‰è£…åŒ…è¿›è¡Œæ›¿æ¢ã€‚æ‰“å¼€_config.ymlæ–‡ä»¶ï¼Œä¿®æ”¹themeä¸ºnextã€‚ç„¶åŽè¿è¡Œï¼š 123hexo cleanhexo ghexo s æ‰“å¼€http://localhost:4000/å¯ä»¥å‘çŽ°ä¸»é¢˜æ›´æ”¹äº†ã€‚ å®‰è£…é…ç½®githubé¦–å…ˆæŸ¥çœ‹æ˜¯å¦å·²ç»å®‰è£…gitï¼Œgit --versionï¼Œä¸€èˆ¬ubuntuè‡ªå¸¦gitã€‚è‹¥æ²¡æœ‰å®‰è£…é‡‡ç”¨sudo apt install gitè¿›è¡Œå®‰è£…ã€‚ é…ç½®githubå‘½ä»¤è¡Œè¾“å…¥ï¼š 12git config --global user.name &quot;your user name&quot;git config --global user.email &quot;your email address&quot; åˆ›å»ºå…¬é’¥å‘½ä»¤è¡Œè¾“å…¥ï¼š 1ssh-keygen -C &apos;your email address&apos; -t rsa ä¸€ç›´æŒ‰å›žè½¦ç›´è‡³ç»“æŸï¼Œç»“æŸåŽä¼šåœ¨ï½ž/.ssh/ä¸‹å»ºç«‹å¯†é’¥æ–‡ä»¶ï¼Œå³~/.ssh/id_rsa_pubï¼Œæ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå¤åˆ¶å…¨éƒ¨å†…å®¹ã€‚ githubæ·»åŠ å…¬é’¥ç‚¹å‡»ä¸ªäººå¤´åƒâ€”&gt;settingsâ€”&gt;SSH and GPG keysâ€”&gt;New SSH keyï¼Œç²˜è´´åˆšæ‰å¤åˆ¶çš„æ–‡æœ¬ã€‚ åˆ›å»ºé¡¹ç›®ä»“åº“åœ¨githubé¡µé¢ï¼Œé€‰æ‹©New repositoryï¼ŒRespository nameè¾“å…¥username.github.ioï¼Œç‚¹å‡»ç¡®å®šã€‚ hexoå°†é™æ€é¡µé¢éƒ¨ç½²åˆ°githubæ‰“å¼€hexoç›®å½•ä¸‹çš„_config.ymlï¼Œåœ¨æœ€åŽæ·»åŠ ï¼š 1234deploy: type: git repository: git@github.com:username/username.github.io.git branch: master masteråˆ†æ”¯æ‰˜ç®¡publicç›®å½•ä¸‹çš„é™æ€ç½‘é¡µä»£ç ï¼Œsourceåˆ†æ”¯æ‰˜ç®¡markdownæºç ï¼Œè¿™æ ·å°±ä¸ç”¨æ‹…å¿ƒæºç ä¸¢å¤±äº†ï¼Œå°±ç®—ç”µè„‘ä¸¢äº†ä¹Ÿä¸æ€•ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿ç®¡ç†ï¼Œå¹³æ—¶åœ¨sourceåˆ†æ”¯å¼€å‘å³å¯ã€‚ æˆ‘å¹³æ—¶å†™æ–‡ç« çš„æµç¨‹ï¼š hexo new â€œtitle-nameâ€ hexo g ç”Ÿæˆé™æ€ç½‘é¡µä»£ç  hexo d pushåˆ°è¿œç¨‹masteråˆ†æ”¯ åœ¨sourceåˆ†æ”¯æ‰§è¡Œ git add -A git commit -m &quot;æäº¤å†…å®¹&quot; git push ç„¶åŽå®‰è£…hexoæ’ä»¶ï¼š 1npm install hexo-deployer-git --save æœ€ç»ˆè¿›è¡Œéƒ¨ç½²ï¼Œå‘½ä»¤è¡Œè¾“å…¥ï¼š 123hexo cleanhexo ghexo d çŽ°åœ¨å°±å¯ä»¥é€šè¿‡username.github.ioè®¿é—®ä½ çš„åšå®¢äº†ï¼ ä¸°å¯Œåšå®¢åŠŸèƒ½å®‰è£…ä¸€äº›æ’ä»¶æˆ–è€…é…ç½® gitalk è¯„è®ºåŠŸèƒ½ busuanzi æžç®€ç½‘é¡µè®¡æ•°å™¨ local_search æœç´¢åŠŸèƒ½ google_analytics ç½‘ç«™è¿è¡Œæƒ…å†µåˆ†æž baidu_analytics ç½‘ç«™è¿è¡Œæƒ…å†µåˆ†æž google_site_verification éªŒè¯ç½‘ç«™æ‰€æœ‰æƒ,SEOä¼˜åŒ– baidu_site_verification éªŒè¯ç½‘ç«™æ‰€æœ‰æƒ,SEOä¼˜åŒ– needmoreshare2 åˆ†äº«åŠŸèƒ½ ä»¥ä¸Šæ˜¯æœ¬äººä½¿ç”¨çš„ä¸€äº›æ’ä»¶å’Œé…ç½®ï¼Œå¤§å®¶å‚è€ƒä¸€ä¸‹ï¼Œå¯æ ¹æ®è‡ªå·±æƒ…å†µé€‰æ‹©å®‰è£…å’Œé…ç½®,å…·ä½“å®‰è£…å’Œé…ç½®æ–¹æ³•å¯è‡ªè¡Œgoogle ç»‘å®šåŸŸåé¦–å…ˆç”³è¯·åŸŸåï¼Œæˆ‘æ˜¯åœ¨é˜¿é‡Œäº‘ç”³è¯·çš„ï¼Œéœ€è¦å¤‡æ¡ˆ åŸŸåè§£æžé…ç½®,æ·»åŠ ä¸€æ¡CNAMEè®°å½• github pages ä¸Š CNAME æ–‡ä»¶é…ç½® æ–¹æ³•1ï¼šé™æ€æºç ä¸­æ·»åŠ CNAMEæ–‡ä»¶ï¼Œå†…å®¹ä¸ºç”³è¯·çš„åŸŸåå¹¶æ‰§è¡Œhexo g hexo déƒ¨ç½²åˆ°githubä¸Š æ–¹æ³•2ï¼šç›´æŽ¥åœ¨github.ioä»“åº“çš„Settingsçš„GitHub Pagesé¡¹ç›´æŽ¥è®¾ç½®Custom domain,githubä¼šè‡ªåŠ¨æ·»åŠ CNAMEæ–‡ä»¶ çŽ°åœ¨ä½¿ç”¨ç”³è¯·çš„åŸŸåè®¿é—®ä¸€ä¸‹è¯•è¯•å§ è§£å†³ç™¾åº¦çˆ¬è™«æ— æ³•çˆ¬å– Github Pages ä¸ªäººåšå®¢é—®é¢˜ç½‘ä¸Šæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥ä½¿ç™¾åº¦çˆ¬è™«çˆ¬å–åšå®¢é¡µé¢ï¼Œæ€»ç»“èµ·æ¥ä¸»è¦æœ‰ï¼š CDNï¼Œåˆ©ç”¨äº‘æœåŠ¡æä¾›å•†å°† blog å¤šåšå‡ ä¸ªé•œåƒã€‚ æ¢æ‰˜ç®¡å¹³å°ï¼Œæ¯”å¦‚è¯´å›½å†…çš„ä»£ç æ‰˜ç®¡å¹³å°ã€‚ è‡ªè¡Œä½¿ç”¨ VPS æ‰˜ç®¡ã€‚ CDN æ¯”è¾ƒè´µè¿˜ä¸å®Œç¾Žï¼Œä¸é€‚åˆå°æµé‡ç½‘ç«™ï¼Œåˆä¸æƒ³æ¢æ‰˜ç®¡å¹³å°ï¼ŒVPS å¤§é™†è®¿é—®é€Ÿåº¦ä¸å¿«ã€‚ æœ‰æ²¡æœ‰ç®€å•ã€å¯é è¿˜å…è´¹çš„æ–¹æ³•ï¼Ÿ æœ‰ï¼ŒçœŸçš„æœ‰ï¼Œzeit.coå°±æ˜¯ç›®å‰æ¯”è¾ƒå¥½çš„ä¸€ä¸ªé€‰æ‹©ï¼Œä¸€ä¸ªé™æ€ç½‘é¡µå’Œæ— çŠ¶æ€å‡½æ•°æ‰˜ç®¡çš„äº‘å¹³å°ã€‚è¯•ç”¨äº†ä¹‹åŽï¼Œæ„Ÿè§‰éžå¸¸å¼ºå¤§ï¼Œå®ƒèƒ½å¤Ÿä»¥ Github App çš„å½¢å¼ä¸Ž GitHub é›†æˆï¼ŒæŽ¥ç®¡ repo çš„ CIï¼Œè¿›è¡Œæ·±åº¦å®šåˆ¶ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¿«é€Ÿéƒ¨ç½²ã€è‡ªåŠ¨ä¼¸ç¼©ã€‚ å…³é”®æ˜¯ï¼ŒçŽ°åœ¨åŸºæœ¬åŠŸèƒ½æ˜¯å…è´¹çš„ï¼Œè¿™å¯¹äºŽæˆ‘ä»¬æ‰˜ç®¡åšå®¢æ¥è¯´ï¼Œå·²ç»å¾ˆå¤Ÿç”¨äº†ã€‚æ›´æƒŠå–œçš„æ˜¯ï¼Œå®ƒè¿˜æä¾›æ™ºèƒ½ CDN å’Œæ™ºèƒ½ DNS æœ¬è´¨ä¸Šä»–ä»¬æä¾›äº† Storage + CDN + DNS è¿™ä¸€å¥—å®Œæ•´æœåŠ¡ã€‚æ ¹æ®ä»–ä»¬çš„æ–‡æ¡£ï¼Œæ•´ä¸ªè¿‡ç¨‹æˆ‘åªéœ€è¦ï¼š ç”¨æˆ‘çš„ Github è´¦æˆ·ç™»é™† Import Projectâ€”&gt;Import Git Repositoryâ€”&gt;ç»™zeit æˆ‘çš„é™æ€ç½‘é¡µ repo çš„ read æƒé™ å¯¼å…¥è¿‡ç¨‹ä¸­ï¼Œé€‰æ‹© other æ¨¡æ¿å³å¯ï¼Œé»˜è®¤ ci å‘½ä»¤ä¸ç”¨æ”¹ï¼ŒRoot Directory ä¹Ÿä¸ç”¨æ”¹ï¼Œå¯¼å…¥å®ŒæˆåŽå°±ä¼šè‡ªåŠ¨å¸®ä½  deployã€‚ ç­‰å‡ ç§’ï¼Œimporting éƒ¨ç½²æˆåŠŸï¼ ä¸ç”¨å†™ä»»ä½• codeï¼Œç‚¹ä¸¤ä¸‹é¼ æ ‡å°±å®Œäº‹äº†ã€‚éƒ¨ç½²å®ŒæˆåŽï¼Œä¼šç”Ÿæˆä¸€ä¸ªç±»ä¼¼äºŽ xxxxxxx.now.sh çš„é“¾æŽ¥ï¼Œç‚¹å‡»å³å¯è®¿é—®ï¼Œé™æ€èµ„æºå·²ç»éƒ¨ç½²åˆ°äº†ä»–ä»¬çš„è¾¹ç¼˜ CDN èŠ‚ç‚¹ä¸Šã€‚ æŽ¥ç€åœ¨zeit.coè®¾ç½®åŸŸå Selecting Your Projectâ€”&gt;Settingsâ€”&gt;Domainsâ€”&gt;Entering Your Chosen Domainâ€”&gt;Add the Domain è¿™æ—¶å€™å®ƒä¼šæŠ¥é”™ï¼Œå› ä¸ºä½ çš„åŸŸåè¿˜æ²¡æœ‰æ·»åŠ è§£æžã€‚è¿™é‡Œï¼Œä»–ä»¬æŽ¨èçš„æ–¹å¼æ˜¯è®©ä½ çš„åŸŸåä½¿ç”¨ä»–ä»¬çš„Nameserverï¼Œæˆ–è€…è¯´è®©ä»–ä»¬æä¾›DNSè§£æžæœåŠ¡ã€‚ä½†æ˜¯æˆ‘è¿™é‡Œé€‰æ‹©CNAMEçš„æ–¹å¼ã€‚å› ä¸ºæˆ‘ä¸€ç›´ä½¿ç”¨çš„æ˜¯cloudflareçš„DNSè§£æžï¼Œæˆ‘ç”³è¯·çš„åŸŸåä¹‹å‰æ˜¯ä¸ºæ¢¯å­ç”¨çš„ï¼Œcloudflareçš„CDNå…è´¹å¹¶ä¸”æ”¯æŒwebsocketï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œå°±ç»§ç»­è¿™ä¹ˆç”¨äº†ï¼Œåœ¨cloudflareä¸Šæ·»åŠ  CNAME è®°å½•å°±è¡Œäº†ï¼Œå†…å®¹ä¸ºä¸Šå›¾çš„valueå€¼ï¼šalias.zeit.coã€‚ å¦‚æžœè¿˜æ˜¯æŠ¥é”™çš„è¯ï¼Œä½ å¯ä»¥è¯•ç€åˆ é™¤ï¼ˆå…ˆç‚¹å‡»â€œEditâ€æŒ‰é’®ï¼Œç„¶åŽç‚¹å‡»â€œRemoveâ€ï¼‰åŽé‡æ–°æ·»åŠ ï¼Œå¦‚ä¸‹å›¾å³è¡¨ç¤ºè®¾ç½®æˆåŠŸäº† ç™¾åº¦çˆ¬å–æœ€åŽåœ¨ç™¾åº¦ç«™é•¿å·¥å…·é¡µé¢ï¼Œåœ¨ æ•°æ®ç›‘æŽ§ &gt; æŠ“å–è¯Šæ–­ï¼Œè¿›è¡Œæµ‹è¯•ï¼Œæµ‹è¯•é€šè¿‡åŽé€‰æ‹©é“¾æŽ¥æäº¤ä»¥sitemapæ–¹å¼æäº¤é“¾æŽ¥å³å¯ï¼Œä¹‹åŽç™¾åº¦å°±ä¼šå¼€å§‹çˆ¬å–æˆ‘ä»¬çš„åšå®¢äº† å‚è€ƒ[1] è§£å†³ç™¾åº¦çˆ¬è™«æ— æ³•çˆ¬å– Github Pages ä¸ªäººåšå®¢çš„é—®é¢˜ï¼šhttps://zpjiang.me/2020/01/15/let-baidu-index-github-page/[2] zeit.co å¸®åŠ©æ–‡æ¡£ï¼šhttps://zeit.co/docs[3] ä½¿ç”¨ zeit.co æ‰˜ç®¡ Hexo é™æ€åšå®¢ï¼šhttps://www.qtmuniao.com/2020/03/15/hexo-to-zeit-co/[4] åŸŸåç»‘å®šï¼šhttps://segmentfault.com/a/1190000011203711[5] zeitåŸŸåè§£æžï¼šhttps://blog.solariar.tech/2020/how-this-site-work-v2/]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>hexo</tag>
        <tag>gitHub pages</tag>
        <tag>zeit.co</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ä¸‹è½½gcr.ioé•œåƒ]]></title>
    <url>%2F2020%2F04%2F05%2F%E9%80%9A%E8%BF%87%E9%98%BF%E9%87%8C%E4%BA%91%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1%E4%B8%8B%E8%BD%BDgcr-io%E9%95%9C%E5%83%8F%2F</url>
    <content type="text"><![CDATA[å®‰è£…k8sæ—¶å‘çŽ°å¥½å¤šé•œåƒéƒ½æ˜¯gcr.ioä¸Šçš„ï¼Œåœ¨å›½å†…ç”±äºŽè¢«å¢™è€Œä¸èƒ½æ­£å¸¸ä¸‹è½½ï¼Œä¹Ÿå°±å¯¼è‡´äº†é›†ç¾¤ä¸èƒ½æ­£å¸¸å®‰è£…ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¦æ€Žæ ·æ‰èƒ½ä¸‹è½½è¿™äº›é•œåƒå‘¢ï¼Ÿæˆ‘ä»¬è¦å¯»æ‰¾å…è´¹ä¸‹è½½gcr.ioé•œåƒçš„é€”å¾„ï¼Œé˜¿é‡Œäº‘å°±æä¾›äº†è¿™ä¸€æœåŠ¡ã€‚æœ¬æ–‡é€šè¿‡githubè®¾ç½®ä»£ç æºä¸‹è½½æ‰€éœ€çš„gcr.ioé•œåƒã€‚ githubåˆ›å»ºä»“åº“é¦–å…ˆåœ¨githubåˆ›å»ºä¸€ä¸ªrepositoryï¼Œåˆ›å»ºå¥½åŽç„¶åŽgit cloneåˆ°æœ¬åœ°ï¼Œå¹¶åœ¨æœ¬åœ°åˆ›å»ºæ‰€éœ€ä¸‹è½½çš„é•œåƒdockerfileï¼Œè¿™é‡Œæœ¬åœ°çš„ç›®å½•å±‚çº§ä¸º é•œåƒåç§°-&gt;ç‰ˆæœ¬å·-&gt;dockerfileã€‚åˆ›å»ºä¹‹åŽå†æŠŠæ‰€æœ‰çš„æ–‡ä»¶pushåˆ°githubä»“åº“ã€‚è¿™é‡Œæ˜¯æˆ‘çš„githubä¸Šçš„dockderfileä»“åº“ï¼Œå¤§å®¶å¯ä»¥followæˆ‘çš„é¡¹ç›® é€‰å–å…¶ä¸­ä¸€ä¸ªç»„ä»¶çš„dockerfileï¼ŒæŸ¥çœ‹å…¶ä¸­çš„å†…å®¹ 12FROM gcr.io/kubeflow-images-public/tensorflow-1.15.2-notebook-cpu:1.0.0MAINTAINER smartliby &lt;liboyuma@qq.com&gt; é‡Œé¢çš„å†…å®¹éžå¸¸å°‘ï¼Œå°±ä¸¤è¡Œï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œæ˜¯åŸºäºŽæŸä¸ªé•œåƒåˆ¶ä½œçš„æ–°é•œåƒï¼Œç¬¬äºŒè¡Œä¸ºä½œè€…ä¿¡æ¯ã€‚é€šè¿‡è¿™ä¸ªdockerfileæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºç«¯å€ªæ¥äº†ï¼Œå…¶å®žæˆ‘ä»¬ä»€ä¹ˆéƒ½æ²¡åšï¼Œå°±æ˜¯åˆ©ç”¨é˜¿é‡Œäº‘è¿™ä¸ªä»‹è´¨å¸®æˆ‘ä»¬ç¿»å¢™åŽ»ä¸‹è½½é•œåƒã€‚ ç™»å½•é˜¿é‡Œäº‘é•œåƒåˆ›å»ºé•œåƒä»“åº“ é€‰æ‹©é•œåƒæž„å»ºæ‰€ä¾èµ–çš„åœ¨githubä»“åº“ è¿›å…¥åˆšåˆ›å»ºçš„ä»“åº“ç„¶åŽé€‰æ‹©æž„å»ºèœå•ç‚¹å‡»æ·»åŠ æž„å»ºè§„åˆ™ ç‚¹å‡»ç«‹å³æž„å»º æž„å»ºæˆåŠŸ ä½¿ç”¨é•œåƒ12docker pull registry.cn-beijing.aliyuncs.com/smartliby/tensorflow-1.15.2-notebook-gpu:1.0.0docker tag registry.cn-beijing.aliyuncs.com/smartliby/tensorflow-1.15.2-notebook-gpu:1.0.0 gcr.io/kubeflow-images-public/tensorflow-1.15.2-notebook-gpu:1.0.0]]></content>
      <categories>
        <category>k8s</category>
      </categories>
      <tags>
        <tag>k8s</tag>
        <tag>github</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[kubeflow 1.0 å®‰è£…æ•™ç¨‹]]></title>
    <url>%2F2020%2F04%2F04%2Fkubeflow%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[Kubeflowæ˜¯GoogleæŽ¨å‡ºçš„åŸºäºŽkubernetesçŽ¯å¢ƒä¸‹çš„æœºå™¨å­¦ä¹ ç»„ä»¶ï¼Œé€šè¿‡Kubeflowå¯ä»¥å®žçŽ°å¯¹TFJobç­‰èµ„æºç±»åž‹å®šä¹‰ï¼Œå¯ä»¥åƒéƒ¨ç½²åº”ç”¨ä¸€æ ·å®Œæˆåœ¨TFJobåˆ†å¸ƒå¼è®­ç»ƒæ¨¡åž‹çš„è¿‡ç¨‹ã€‚æœ€åˆçš„è®¾è®¡æ˜¯å°†Kuberneteså’ŒTensorflowç»“åˆå®žçŽ°å¯¹Tensorflowåˆ†å¸ƒå¼è®­ç»ƒçš„æ”¯æŒã€‚ä½†æ˜¯ä»…ä»…å®žçŽ°å¯¹Tensorflowçš„æ”¯æŒè¿˜æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼ŒKubeflowç¤¾åŒºåˆé™†ç»­å¯¹å„ç§æ·±åº¦å­¦ä¹ æ¡†æž¶è¿›è¡Œæ”¯æŒ,ä¾‹å¦‚:MXNet, Caffee, PyTorchç­‰ã€‚ä½¿å¾—æœºå™¨å­¦ä¹ ç®—æ³•åŒå­¦åªéœ€å…³å¿ƒç®—æ³•å®žçŽ°ï¼Œè€ŒåŽç»­çš„æ¨¡åž‹è®­ç»ƒå’ŒæœåŠ¡ä¸Šçº¿éƒ½äº¤ç»™å¹³å°æ¥åš,è§£æ”¾ç®—æ³•åŒå­¦ä½¿å…¶ä¸“åšè‡ªå·±æ“…é•¿çš„äº‹å„¿ã€‚ ç›®å‰Kubeflowä»…æ”¯æŒåœ¨v1.15.11åŠä»¥ä¸‹ç‰ˆæœ¬çš„k8sä¸Šéƒ¨ç½²ï¼Œv1.16åŠä»¥ä¸Šå­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œå…·ä½“æƒ…å†µå¯å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬åŸºäºŽMicrok8sï¼ˆç‰ˆæœ¬1.15/stableï¼‰éƒ¨ç½²kubeflow v1.0 å®‰è£…kubeflowä¸‹è½½ kfctl binary from the Kubeflow releases page è§£åŽ‹å®‰è£…åŒ…å¹¶æ·»åŠ åˆ°æ‰§è¡Œç›®å½• 12tar -xvf kfctl_v1.0.1-0-gf3edb9b_linux.tar.gzsudo cp kfctl /usr/bin è®¾ç½®çŽ¯å¢ƒ 1234export BASE_DIR=/data/export KF_NAME=my-kubeflowexport KF_DIR=$&#123;BASE_DIR&#125;/$&#123;KF_NAME&#125;export CONFIG_URI=&quot;https://raw.githubusercontent.com/kubeflow/manifests/v1.0-branch/kfdef/kfctl_k8s_istio.v1.0.1.yaml&quot; éƒ¨ç½²kubeflow 1234mkdir -p $&#123;KF_DIR&#125;cd $&#123;KF_DIR&#125;kfctl apply -V -f $&#123;CONFIG_URI&#125;kubectl -n kubeflow get all è¾“å‡ºå¦‚ä¸‹æ—¥å¿—å³å®‰è£…æˆåŠŸ æŸ¥çœ‹å½“å‰ Kubernetes pods çŠ¶æ€ 1kubectl get pods --namespace kubeflow å‘çŽ°kubeflowçš„podå¤§éƒ¨åˆ†æ²¡æœ‰å¯åŠ¨æˆåŠŸï¼ŒåŽŸå› è¿˜æ˜¯ç½‘ç»œé—®é¢˜ï¼Œéœ€è¦è®¿é—®gcr.ioä¸‹è½½é•œåƒï¼Œä¹‹å‰æˆ‘éƒ½æ˜¯é€šè¿‡gcr.azk8s.cné•œåƒåœ°å€ä¸‹è½½çš„ï¼Œä½†æ˜¯æœ€è¿‘å‘çŽ°gcr.azk8s.cnè¿™ä¸ªåœ°å€æ— æ³•ä½¿ç”¨äº†ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡è‡ªå·±æž„å»ºç„¶åŽä¿å­˜åˆ°é˜¿é‡Œäº‘é•œåƒåº“é‡Œï¼Œå¤§å®¶å¯ä»¥ç›´æŽ¥ä½¿ç”¨æˆ‘å·²ç»æž„å»ºå¥½çš„é•œåƒï¼Œæ‰§è¡Œä¸‹é¢è„šæœ¬å³å¯ï¼Œä¹Ÿå¯è‡ªå·±æž„å»ºï¼Œå…·ä½“æž„å»ºæµç¨‹å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  æ‰§è¡Œä»¥ä¸‹è„šæœ¬å°†é•œåƒä¸‹è½½åˆ°æœ¬åœ°å¹¶å¯¼å…¥åˆ°microk8s 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#!/usr/bin/env bashecho ""echo "=========================================================="echo "pull kubeflow v1.0 images from aliyuncs ..."echo "=========================================================="echo ""# registry.cn-hangzhou.aliyuncs.com/smartlibygcr_imgs=( "registry.cn-hangzhou.aliyuncs.com/smartliby/kfserving-controller:0.2.2,gcr.io/kfserving/kfserving-controller:0.2.2" "registry.cn-hangzhou.aliyuncs.com/smartliby/api-server:0.2.0,gcr.io/ml-pipeline/api-server:0.2.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/kfam:v1.0.0-gf3e09203,gcr.io/kubeflow-images-public/kfam:v1.0.0-gf3e09203" "registry.cn-hangzhou.aliyuncs.com/smartliby/ingress-setup:latest,gcr.io/kubeflow-images-public/ingress-setup:latest" "registry.cn-hangzhou.aliyuncs.com/smartliby/application:1.0-beta,gcr.io/kubeflow-images-public/kubernetes-sigs/application:1.0-beta" "registry.cn-hangzhou.aliyuncs.com/smartliby/centraldashboard:v1.0.0-g3ec0de71,gcr.io/kubeflow-images-public/centraldashboard:v1.0.0-g3ec0de71" "registry.cn-hangzhou.aliyuncs.com/smartliby/jupyter-web-app:v1.0.0-g2bd63238,gcr.io/kubeflow-images-public/jupyter-web-app:v1.0.0-g2bd63238" "registry.cn-hangzhou.aliyuncs.com/smartliby/katib-controller:v0.8.0,gcr.io/kubeflow-images-public/katib/v1alpha3/katib-controller:v0.8.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/katib-db-manager:v0.8.0,gcr.io/kubeflow-images-public/katib/v1alpha3/katib-db-manager:v0.8.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/katib-ui:v0.8.0,gcr.io/kubeflow-images-public/katib/v1alpha3/katib-ui:v0.8.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/kube-rbac-proxy:v0.4.0,gcr.io/kubebuilder/kube-rbac-proxy:v0.4.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/metacontroller:v0.3.0,gcr.io/metacontroller/metacontroller:v0.3.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/metadata:v0.1.11,gcr.io/kubeflow-images-public/metadata:v0.1.11" "registry.cn-hangzhou.aliyuncs.com/smartliby/envoy:metadata-grpc,gcr.io/ml-pipeline/envoy:metadata-grpc" "registry.cn-hangzhou.aliyuncs.com/smartliby/ml_metadata_store_server:v0.21.1,gcr.io/tfx-oss-public/ml_metadata_store_server:v0.21.1" "registry.cn-hangzhou.aliyuncs.com/smartliby/metadata-frontend:v0.1.8,gcr.io/kubeflow-images-public/metadata-frontend:v0.1.8" "registry.cn-hangzhou.aliyuncs.com/smartliby/visualization-server:0.2.0,gcr.io/ml-pipeline/visualization-server:0.2.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/persistenceagent:0.2.0,gcr.io/ml-pipeline/persistenceagent:0.2.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/scheduledworkflow:0.2.0,gcr.io/ml-pipeline/scheduledworkflow:0.2.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/frontend:0.2.0,gcr.io/ml-pipeline/frontend:0.2.0" "registry.cn-hangzhou.aliyuncs.com/smartliby,gcr.io/ml-pipeline/viewer-crd-controller:0.2.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/notebook-controller:v1.0.0-gcd65ce25,gcr.io/kubeflow-images-public/notebook-controller:v1.0.0-gcd65ce25" "registry.cn-hangzhou.aliyuncs.com/smartliby/profile-controller:v1.0.0-ge50a8531,gcr.io/kubeflow-images-public/profile-controller:v1.0.0-ge50a8531" "registry.cn-hangzhou.aliyuncs.com/smartliby/pytorch-operator:v1.0.0-g047cf0f,gcr.io/kubeflow-images-public/pytorch-operator:v1.0.0-g047cf0f" "registry.cn-hangzhou.aliyuncs.com/smartliby/spark-operator:v1beta2-1.0.0-2.4.4,gcr.io/spark-operator/spark-operator:v1beta2-1.0.0-2.4.4" "registry.cn-hangzhou.aliyuncs.com/smartliby/spartakus-amd64:v1.1.0,gcr.io/google_containers/spartakus-amd64:v1.1.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/tf_operator:v1.0.0-g92389064,gcr.io/kubeflow-images-public/tf_operator:v1.0.0-g92389064" "registry.cn-hangzhou.aliyuncs.com/smartliby/admission-webhook:v1.0.0-gaf96e4e3,gcr.io/kubeflow-images-public/admission-webhook:v1.0.0-gaf96e4e3" "smartliby/kfam:v1.0.0-gf3e09203,gcr.io/kubeflow-images-public/kfam:v1.0.0-gf3e09203" "smartliby/api-server:0.2.0,gcr.io/ml-pipeline/api-server:0.2.0")for img in $&#123;gcr_imgs[@]&#125;do img_array=($&#123;img//,/ &#125;) # æ‹‰å–é•œåƒ docker pull $&#123;img_array[0]&#125; # æ·»åŠ Tag image_name=$&#123;img_array[1]&#125; image_name=$&#123;image_name##*/&#125; image_name=$&#123;image_name%@*&#125; docker tag $&#123;img_array[0]&#125; $&#123;image_name&#125; # è¾“å‡º docker save $&#123;image_name&#125; &gt; /data/k8s_img/kubeflow/$&#123;image_name&#125;.tar # è¾“å…¥ microk8s.ctr --namespace k8s.io image import /data/k8s_img/kubeflow/$&#123;image_name&#125;.tar # åˆ é™¤Tag docker rmi $&#123;img_array[0]&#125; $&#123;image_name&#125;doneecho ""echo "=========================================================="echo "pull kubeflow v1.0 images from aliyuncs finished."echo "=========================================================="echo "" æ‰§è¡Œå®Œä»¥ä¸Šè„šæœ¬åŽå‘çŽ°knative-servingè¿˜æ˜¯æ²¡æœ‰å¯åŠ¨ï¼ŒåŽŸå› æ˜¯å› ä¸ºknativeé•œåƒä½¿ç”¨çš„æ˜¯sha256ï¼Œæ²¡æœ‰ä½¿ç”¨å…·ä½“ç‰ˆæœ¬å·ï¼Œè€Œé•œåƒä¸‹è½½åˆ°é˜¿é‡Œäº‘ä¹‹åŽsha256å°±å˜æ›´äº†ï¼Œæ‰€ä»¥æ— æ³•ä¸‹è½½ï¼Œåªèƒ½é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ›´æ”¹ä¸‹è½½åœ°å€äº† 1vim /data/my-kubeflow/kustomize/knative-install/base/deployment.yaml é•œåƒåœ°å€å¦‚ä¸‹æ ¼å¼ 123456gcr.io/knative-releases/knative.dev/serving/cmd/activator@sha256:8e606671215cc029683e8cd633ec5de9eabeaa6e9a4392ff289883304be1f418gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler-hpa@sha256:5e0fadf574e66fb1c893806b5c5e5f19139cc476ebf1dff9860789fe4ac5f545gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler@sha256:ef1f01b5fb3886d4c488a219687aac72d28e72f808691132f658259e4e02bb27gcr.io/knative-releases/knative.dev/serving/cmd/networking/istio@sha256:727a623ccb17676fae8058cb1691207a9658a8d71bc7603d701e23b1a6037e6cgcr.io/knative-releases/knative.dev/serving/cmd/webhook@sha256:1ef3328282f31704b5802c1136bd117e8598fd9f437df8209ca87366c5ce9fcbgcr.io/knative-releases/knative.dev/serving/cmd/controller@sha256:5ca13e5b3ce5e2819c4567b75c0984650a57272ece44bc1dabf930f9fe1e19a1 æ”¹æˆ 123456smartliby/activator:latestsmartliby/autoscaler-hpa:latestsmartliby/autoscaler:latestsmartliby/istio:latestsmartliby/webhook:latestsmartliby/controller:latest æœ€åŽæ‰§è¡Œkfctl apply -V -f ${CONFIG_URI}é‡æ–°å®‰è£…å³å¯ å¦‚æžœè¿˜æ˜¯æœ‰podæ— æ³•å¯åŠ¨ï¼Œå¯é€šè¿‡kubectl describe pod æœªå¯åŠ¨podçš„åç§° -n kubeflowæŸ¥çœ‹åŽŸå›  å¦‚æžœæ˜¯å› ä¸ºé•œåƒæ— æ³•ä¸‹è½½ï¼Œå¯ä»¥å°†ä¾èµ–çš„é•œåƒåŠ åˆ°ä¸Šé¢çš„è„šæœ¬é‡Œä¸‹è½½é•œåƒ å¦‚æžœæ˜¯å› ä¸ºé•œåƒæ‹‰å–ç­–ç•¥å¯¼è‡´æ¯æ¬¡éƒ½é‡æ–°ä¸‹è½½é—®é¢˜ï¼Œå¯é€šè¿‡ä¸‹é¢å‘½ä»¤æˆ–è€…kubernetes-dashboardä¿®æ”¹ï¼Œå°†Always æ”¹ä¸º IfNotPresent 1kubectl edit pod æœªå¯åŠ¨podçš„åç§° -n kubeflow æ‰§è¡Œ kubectl get pods --namespace kubeflowæŸ¥çœ‹kubeflowçš„podéƒ½å·²è¿è¡Œèµ·æ¥ 123456789101112131415161718192021222324252627282930313233343536NAME READY STATUS RESTARTS AGEadmission-webhook-bootstrap-stateful-set-0 1/1 Running 6 2d4hadmission-webhook-deployment-569558c8b6-n8b7k 1/1 Running 0 13happlication-controller-stateful-set-0 1/1 Running 3 2d4hargo-ui-7ffb9b6577-w8pb7 1/1 Running 7 3d7hcentraldashboard-659bd78c-fxgqd 1/1 Running 3 3d7hjupyter-web-app-deployment-878f9c988-xgh82 1/1 Running 3 2d5hkatib-controller-7f58569f7d-8bw7z 1/1 Running 4 3d7hkatib-db-manager-54b66f9f9d-ngqw9 1/1 Running 3 3d7hkatib-mysql-dcf7dcbd5-7wbck 1/1 Running 12 4d1hkatib-ui-6f97756598-4mtjs 1/1 Running 3 3d7hkfserving-controller-manager-0 2/2 Running 7 2d5hmetacontroller-0 1/1 Running 5 3d7hmetadata-db-65fb5b695d-wq8vh 1/1 Running 12 4d1hmetadata-deployment-65ccddfd4c-vwfd2 1/1 Running 3 3d7hmetadata-envoy-deployment-7754f56bff-svtz2 1/1 Running 3 3d7hmetadata-grpc-deployment-75f9888cbf-zj4sn 1/1 Running 5 3d7hmetadata-ui-7c85545947-v68l7 1/1 Running 3 3d7hminio-69b4676bb7-w96xk 1/1 Running 12 4d1hml-pipeline-5cddb75848-bsc48 1/1 Running 3 2d6hml-pipeline-ml-pipeline-visualizationserver-7f6fcb68c8-vxjj7 1/1 Running 3 2d7hml-pipeline-persistenceagent-6ff9fb86dc-dvxx4 1/1 Running 5 2d6hml-pipeline-scheduledworkflow-7f84b54646-ndxcb 1/1 Running 3 2d7hml-pipeline-ui-6758f58868-gqvlp 1/1 Running 3 2d6hml-pipeline-viewer-controller-deployment-685874bc58-jljw8 1/1 Running 3 2d5hmysql-6bcbfbb6b8-xmphz 1/1 Running 12 4d1hnotebook-controller-deployment-7db7c8589d-mlgb4 1/1 Running 3 2d5hprofiles-deployment-56b7c6788f-kk8kh 2/2 Running 6 2d7hpytorch-operator-cf8c5c497-nmfnv 1/1 Running 7 3d7hseldon-controller-manager-6b4b969447-qp7l4 1/1 Running 20 4d1hspark-operatorcrd-cleanup-rrpxd 0/2 Completed 0 3d7hspark-operatorsparkoperator-76dd5f5688-kn28n 1/1 Running 3 3d7hspartakus-volunteer-5dc96f4447-xjclm 1/1 Running 3 3d7htensorboard-5f685f9d79-9x549 1/1 Running 12 4d1htf-job-operator-5fb85c5fb7-lqvrg 1/1 Running 6 3d7hworkflow-controller-689d6c8846-znvt9 1/1 Running 12 4d1h æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œç«¯å£æ˜ å°„è®¿é—®Kubeflow UI 1nohup kubectl port-forward -n istio-system svc/istio-ingressgateway 8088:80 &amp; è®¿é—®http://127.0.0.1:8088/ åˆ›å»ºJupyter notebook server ç‚¹å‡»è¿žæŽ¥ä¹‹åŽå°±å¯ä»¥è·‘æ¨¡åž‹è®­ç»ƒäº† æµ‹è¯•Jupyteråˆ›å»ºPython 3 notebookï¼Œæ‰§è¡Œå¦‚ä¸‹ä»£ç  123456789101112131415161718192021222324252627from tensorflow.examples.tutorials.mnist import input_datamnist = input_data.read_data_sets(&quot;MNIST_data/&quot;, one_hot=True)import tensorflow as tfx = tf.placeholder(tf.float32, [None, 784])W = tf.Variable(tf.zeros([784, 10]))b = tf.Variable(tf.zeros([10]))y = tf.nn.softmax(tf.matmul(x, W) + b)y_ = tf.placeholder(tf.float32, [None, 10])cross_entropy = tf.reduce_mean(-tf.reduce_sum(y_ * tf.log(y), reduction_indices=[1]))train_step = tf.train.GradientDescentOptimizer(0.05).minimize(cross_entropy)sess = tf.InteractiveSession()tf.global_variables_initializer().run()for _ in range(1000): batch_xs, batch_ys = mnist.train.next_batch(100) sess.run(train_step, feed_dict=&#123;x: batch_xs, y_: batch_ys&#125;)correct_prediction = tf.equal(tf.argmax(y,1), tf.argmax(y_,1))accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))print(&quot;Accuracy: &quot;, sess.run(accuracy, feed_dict=&#123;x: mnist.test.images, y_: mnist.test.labels&#125;)) è¿è¡Œç»“æžœå¦‚ä¸‹ 1Accuracy: 0.9012 æµ‹è¯•pipelines]]></content>
      <categories>
        <category>kubeflow</category>
      </categories>
      <tags>
        <tag>k8s</tag>
        <tag>kubeflow</tag>
        <tag>microk8s</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu 18.04å®‰è£…microk8sæ•™ç¨‹]]></title>
    <url>%2F2020%2F04%2F03%2Fmicrok8s%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[Microk8sæ˜¯ä¸€ä¸ªé›†æˆåŒ–çš„å®¹å™¨ç®¡ç†å¹³å°ï¼Œä¸ŽKuberneteså®Œå…¨å…¼å®¹ï¼Œä¸»è¦é¢å‘å·¥ä½œç«™ã€è¾¹ç¼˜è®¡ç®—å’ŒIoTç­‰é¢†åŸŸå»ºç«‹å®¹å™¨è®¡ç®—å¹³å°ã€‚ å®‰è£… microk8s1snap install microk8s --classic --channel=1.15/stable è®¾ç½®åˆ«å1sudo snap alias microk8s.kubectl kubectl configé…ç½®1sudo microk8s.kubectl config view --raw &gt; $HOME/.kube/config å¯ç”¨k8sç»„ä»¶1microk8s.enable dashboard dns ingress istio registry storage å¦‚æžœæœ‰GPU1microk8s.enable gpu æ‰§è¡Œ microk8s.enable é¡ºåˆ©çš„è¯ï¼Œä½ å°†çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„æ—¥å¿—12345678910111213141516171819202122logentry.config.istio.io/accesslog createdlogentry.config.istio.io/tcpaccesslog createdrule.config.istio.io/stdio createdrule.config.istio.io/stdiotcp created......Istio is startingEnabling the private registryEnabling default storage classdeployment.extensions/hostpath-provisioner createdstorageclass.storage.k8s.io/microk8s-hostpath createdStorage will be available soonApplying registry manifestnamespace/container-registry createdpersistentvolumeclaim/registry-claim createddeployment.extensions/registry createdservice/registry createdThe registry is enabledEnabling default storage classdeployment.extensions/hostpath-provisioner unchangedstorageclass.storage.k8s.io/microk8s-hostpath unchangedStorage will be available soon ä½¿ç”¨ microk8s.status æ£€æŸ¥å„ä¸ªç»„ä»¶çš„çŠ¶æ€1234567891011121314151617microk8s is runningaddons:knative: disabledjaeger: disabledfluentd: disabledgpu: enabledcilium: disabledstorage: enabledregistry: enabledrbac: disabledingress: enableddns: enabledmetrics-server: disabledlinkerd: disabledprometheus: disabledistio: enableddashboard: enabled ä½¿ç”¨ microk8s.inspect æŽ’æŸ¥ä¸‹å®‰è£…éƒ¨ç½²ç»“æžœ123456789101112131415161718Inspecting services Service snap.microk8s.daemon-containerd is running Service snap.microk8s.daemon-docker is running Service snap.microk8s.daemon-apiserver is running Service snap.microk8s.daemon-proxy is running Service snap.microk8s.daemon-kubelet is running Service snap.microk8s.daemon-scheduler is running Service snap.microk8s.daemon-controller-manager is running Service snap.microk8s.daemon-etcd is running Copy service arguments to the final report tarballInspecting AppArmor configurationGathering system info Copy network configuration to the final report tarball Copy processes list to the final report tarball Copy snap list to the final report tarball Inspect kubernetes cluster WARNING: IPtables FORWARD policy is DROP. Consider enabling traffic forwarding with: sudo iptables -P FORWARD ACCEPT æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ 12sudo ufw default allow routedsudo iptables -P FORWARD ACCEPT å†æ¬¡ä½¿ç”¨ microk8s.inspect å‘½ä»¤æ£€æŸ¥ï¼Œä¼šå‘çŽ° WARNINGæ¶ˆå¤±äº† ä½¿ç”¨ microk8s.kubectl get pods --all-namespaces æŸ¥çœ‹å½“å‰ Kubernetes pods çŠ¶æ€123456NAMESPACE NAME READY STATUS RESTARTS AGEcontainer-registry registry-7fc4594d64-rrgs9 0/1 Pending 0 15mdefault default-http-backend-855bc7bc45-t4st8 0/1 ContainerCreating 0 16mdefault nginx-ingress-microk8s-controller-kgjtl 0/1 ContainerCreating 0 16m...... å¤§éƒ¨åˆ†podéƒ½æ²¡æœ‰å¯åŠ¨èµ·æ¥ï¼Œä»€ä¹ˆåŽŸå› å‘¢ï¼Ÿ ä½¿ç”¨ describe å‘½ä»¤æŸ¥çœ‹ pod1kubectl describe pod default-http-backend -n container-registry æ—¥å¿—å¦‚ä¸‹ 1234Events: Type Reason Age From Message ---- ------ ---- ---- ------- Warning FailedCreatePodSandBox 22m (x33 over 69m) kubelet, izwz9h8m2chowowqckbcy0z Failed create pod sandbox: rpc error: code = Unknown desc = failed to get sandbox image &quot;k8s.gcr.io/pause:3.1&quot;: failed to pull image &quot;k8s.gcr.io/pause:3.1&quot;: failed to resolve image &quot;k8s.gcr.io/pause:3.1&quot;: no available registry endpoint: failed to do request: Head https://k8s.gcr.io/v2/pause/manifests/3.1: dial tcp 108.177.97.82:443: i/o timeout è¿™æ˜¯ pod çš„ sandbox é•œåƒæ‹‰å–å¤±è´¥ã€‚ ç½‘ä¸ŠæŸ¥èµ„æ–™ï¼Œk8s.gcr.io/pause:3.1 æ˜¯å­˜æ”¾åœ¨ google cloud ä¸Šçš„é•œåƒï¼Œç”±äºŽä¼—æ‰€å‘¨çŸ¥çš„åŽŸå› ï¼Œè®¿é—®å¤±è´¥äº†ã€‚ è§£å†³çš„æ–¹æ³•æœ‰ï¼š ç§‘å­¦ä¸Šç½‘ æ‰‹åŠ¨ä¸‹è½½é•œåƒ æ–¹æ³•1æ“ä½œæµç¨‹ç¼–è¾‘ MicroK8s ä½¿ç”¨çš„ docker çŽ¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ï¼Œvim /var/snap/microk8s/current/args/containerd-envåœ¨å…¶ä¸­æ·»åŠ ä»£ç†é…ç½® 1HTTPS_PROXY=https://127.0.0.1:8123 é‡å¯ docker 1sudo systemctl restart snap.microk8s.daemon-docker.service é‡ç½® MicroK8s å¹¶å†æ¬¡å°è¯•å®‰è£…å„ç§ç»„ä»¶ 12microk8s.resetmicrok8s.enable dashboard dns ingress istio registry storage æ–¹æ³•2æ“ä½œæµç¨‹å®‰è£… docker 1sudo apt install docker-ce æ„Ÿè°¢å¾®è½¯ azure æä¾› gcr é•œåƒä¸‹è½½ï¼šåœ°å€ 12docker pull gcr.azk8s.cn/google_containers/pause:3.1docker tag gcr.azk8s.cn/google_containers/pause:3.1 k8s.gcr.io/pause:3.1 v1.14 ä¹‹åŽ microk8s ä½¿ç”¨ containerd ä»£æ›¿ dockerdï¼Œå…·ä½“å¯è§è¿™ä¸ªissue Indeed in the 1.14 release contanerd replaced dockerd. è¦ä¹ˆä½¿ç”¨ç§æœ‰ä»“åº“ registryï¼Œè¦ä¹ˆæ‰‹åŠ¨æŠŠ docker é•œåƒå¯¼å…¥åˆ° containerdã€‚microk8s å®˜ç½‘æä¾›äº†ä¾‹å­ï¼šWorking with locally built images without a registryã€‚ è¿™é‡Œå…ˆä½¿ç”¨æ‰‹åŠ¨æ“ä½œï¼Œä»¥åŽå†å»ºç«‹ç§æœ‰ä»“åº“ 12docker save k8s.gcr.io/pause:3.1 &gt; pause.tarmicrok8s.ctr -n k8s.io image import pause.tar -n æ˜¯æŒ‡å®š namespaceã€‚microk8s.ctr -n k8s.io image lsï¼Œçœ‹åˆ°å¯¼å…¥çš„é•œåƒäº†ï¼š 1k8s.gcr.io/pause:3.1 application/vnd.oci.image.manifest.v1+json sha256:3efe4ff64c93123e1217b0ad6d23b4c87a1fc2109afeff55d2f27d70c55d8f73 728.9 KiB linux/amd64 io.cri-containerd.image=managed å…¶ä»–ç»„ä»¶å¦‚æžœé‡åˆ°gcr.ioæ— æ³•è®¿é—®çš„æƒ…å†µä¹Ÿå¯ä½¿ç”¨å¦‚ä¸Šçš„æ–¹æ³•ï¼Œè¿™é‡Œç‰¹åˆ«å†™äº†ä¸ªè„šæœ¬æ¥è‡ªåŠ¨ä¸‹è½½å¹¶å¯¼å…¥è¿™äº›é•œåƒ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465#!/usr/bin/env bashecho ""echo "=========================================================="echo "pull microk8s v1.15.11 images from aliyuncs ..."echo "=========================================================="echo ""# registry.cn-hangzhou.aliyuncs.com/smartlibygcr_imgs=( "registry.cn-hangzhou.aliyuncs.com/smartliby/pause:3.1,k8s.gcr.io/pause:3.1" "registry.cn-hangzhou.aliyuncs.com/smartliby/heapster-influxdb-amd64:v1.3.3,k8s.gcr.io/heapster-influxdb-amd64:v1.3.3" "registry.cn-hangzhou.aliyuncs.com/smartliby/heapster-grafana-amd64:v4.4.3,k8s.gcr.io/heapster-grafana-amd64:v4.4.3" "registry.cn-hangzhou.aliyuncs.com/smartliby/kubernetes-dashboard-amd64:v1.10.1,k8s.gcr.io/google_containers/kubernetes-dashboard-amd64:v1.10.1" "registry.cn-hangzhou.aliyuncs.com/smartliby/heapster-amd64:v1.5.2,k8s.gcr.io/heapster-amd64:v1.5.2" "registry.cn-hangzhou.aliyuncs.com/smartliby/defaultbackend-amd64:1.4,gcr.io/google_containers/defaultbackend-amd64:1.4" "registry.cn-hangzhou.aliyuncs.com/smartliby/nginx-ingress-controller-amd64:0.24.1,quay.io/kubernetes-ingress-controller/nginx-ingress-controller-amd64:0.24.1" "registry.cn-hangzhou.aliyuncs.com/smartliby/grafana:6.1.6,grafana/grafana:6.1.6" "registry.cn-hangzhou.aliyuncs.com/smartliby/addon-resizer-amd64:1.8.1,cdkbot/addon-resizer-amd64:1.8.1" "registry.cn-hangzhou.aliyuncs.com/smartliby/hostpath-provisioner-amd64:1.0.0,cdkbot/hostpath-provisioner-amd64:1.0.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/dashboard:v2.0.0-rc5,kubernetesui/dashboard:v2.0.0-rc5" "registry.cn-hangzhou.aliyuncs.com/smartliby/k8s-device-plugin:1.11,nvidia/k8s-device-plugin:1.11" "registry.cn-hangzhou.aliyuncs.com/smartliby/controller:v0.8.2,metallb/controller:v0.8.2" "registry.cn-hangzhou.aliyuncs.com/smartliby/speaker:v0.8.2,metallb/speaker:v0.8.2" "registry.cn-hangzhou.aliyuncs.com/smartliby/citadel:1.3.4,docker.io/istio/citadel:1.3.4" "registry.cn-hangzhou.aliyuncs.com/smartliby/jujud-operator:2.7.3,jujusolutions/jujud-operator:2.7.3" "registry.cn-hangzhou.aliyuncs.com/smartliby/kicbase:v0.0.8,gcr.io/k8s-minikube/kicbase:v0.0.8" "registry.cn-hangzhou.aliyuncs.com/smartliby/k8s-dns-dnsmasq-nanny-amd64:1.14.7,gcr.io/google_containers/k8s-dns-dnsmasq-nanny-amd64:1.14.7" "registry.cn-hangzhou.aliyuncs.com/smartliby/k8s-dns-kube-dns-amd64:1.14.7,gcr.io/google_containers/k8s-dns-kube-dns-amd64:1.14.7" "registry.cn-hangzhou.aliyuncs.com/smartliby/k8s-dns-sidecar-amd64:1.14.7,gcr.io/google_containers/k8s-dns-sidecar-amd64:1.14.7" "registry.cn-hangzhou.aliyuncs.com/smartliby/kubernetes-dashboard-amd64:v1.8.3,k8s.gcr.io/kubernetes-dashboard-amd64:v1.8.3" "registry.cn-hangzhou.aliyuncs.com/smartliby/cert-manager-controller:v0.11.0,quay.io/jetstack/cert-manager-controller:v0.11.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/sidecar_injector:1.1.6,docker.io/istio/sidecar_injector:1.1.6" "registry.cn-hangzhou.aliyuncs.com/smartliby/prometheus:v2.3.1,docker.io/prom/prometheus:v2.3.1" "registry.cn-hangzhou.aliyuncs.com/smartliby/galley:1.1.6,docker.io/istio/galley:1.1.6" "registry.cn-hangzhou.aliyuncs.com/smartliby/cert-manager-cainjector:v0.11.0,quay.io/jetstack/cert-manager-cainjector:v0.11.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/cert-manager-webhook:v0.11.0,quay.io/jetstack/cert-manager-webhook:v0.11.0" "registry.cn-hangzhou.aliyuncs.com/smartliby/application:1.0-beta,gcr.io/kubeflow-images-public/kubernetes-sigs/application:1.0-beta" "registry.cn-hangzhou.aliyuncs.com/smartliby/kiali:v0.16,docker.io/kiali/kiali:v0.16")for img in $&#123;gcr_imgs[@]&#125;do img_array=($&#123;img//,/ &#125;) # æ‹‰å–é•œåƒ docker pull $&#123;img_array[0]&#125; # æ·»åŠ Tag image_name=$&#123;img_array[1]&#125; image_name=$&#123;image_name##*/&#125; image_name=$&#123;image_name%@*&#125; docker tag $&#123;img_array[0]&#125; $&#123;image_name&#125; # è¾“å‡º docker save $&#123;image_name&#125; &gt; /data/k8s_img/kubeflow/$&#123;image_name&#125;.tar # è¾“å…¥ microk8s.ctr --namespace k8s.io image import /data/k8s_img/kubeflow/$&#123;image_name&#125;.tar # åˆ é™¤Tag docker rmi $&#123;img_array[0]&#125; $&#123;image_name&#125;doneecho ""echo "=========================================================="echo "pull microk8s v1.15.11 images from aliyuncs finished."echo "=========================================================="echo "" ä½¿ç”¨ microk8s.kubectl get pods --all-namespaces ç»§ç»­è¿›è¡ŒéªŒè¯ 123456789101112131415161718192021222324252627282930NAMESPACE NAME READY STATUS RESTARTS AGEcert-manager cert-manager-5d849b9888-8nh9j 1/1 Running 12 3d18hcert-manager cert-manager-cainjector-dccb4d7f-7rrkf 1/1 Running 15 3dcert-manager cert-manager-webhook-695df7dbb-gpsqs 1/1 Running 12 3d18hcontainer-registry registry-6c99589dc-gttcq 1/1 Running 15 4d4hdefault default-http-backend-5d5ff5d4f5-g9h8h 1/1 Running 15 4d4hdefault nginx-ingress-microk8s-controller-td2mz 1/1 Running 59 3h26mistio-system cluster-local-gateway-7bf56777fb-rbjjn 1/1 Running 12 3d18histio-system grafana-6575997f54-j77rc 1/1 Running 6 3distio-system istio-citadel-894d98c85-xr8qm 1/1 Running 12 3d19histio-system istio-cleanup-secrets-1.2.2-l4djr 0/1 Completed 0 3d19histio-system istio-egressgateway-9b7866bf5-h8ltc 1/1 Running 10 3distio-system istio-galley-5b984f89b-w26n9 1/1 Running 0 6h43mistio-system istio-grafana-post-install-1.2.2-v5sfg 0/1 Completed 0 3d19histio-system istio-ingressgateway-75ddf64567-glfkm 1/1 Running 12 3d19histio-system istio-pilot-5d77c559d4-nhc7d 2/2 Running 14 3distio-system istio-policy-86478df5d4-w2lgb 2/2 Running 46 3distio-system istio-security-post-install-1.2.2-sczrc 0/1 Completed 0 3d19histio-system istio-sidecar-injector-7b98dd6bcc-g597g 1/1 Running 8 3distio-system istio-telemetry-786747687f-t8k6k 2/2 Running 35 3distio-system istio-tracing-555cf644d-4d9f4 1/1 Running 13 3d19histio-system kfserving-ingressgateway-64c7bd9b76-2rcxt 1/1 Running 12 3d18histio-system kiali-6cd6f9dfb5-tlwzq 1/1 Running 13 3d19histio-system prometheus-7d7b9f7844-swqf8 1/1 Running 19 3d19hkube-system coredns-f7867546d-wkv76 1/1 Running 15 4d4hkube-system heapster-v1.5.2-844b564688-kr9t8 4/4 Running 60 4d4hkube-system hostpath-provisioner-65cfd8595b-rjlhz 1/1 Running 5 3dkube-system kubernetes-dashboard-7d75c474bb-s7n2t 1/1 Running 15 4d4hkube-system monitoring-influxdb-grafana-v4-6b6954958c-spcqb 2/2 Running 32 4d4hkube-system nvidia-device-plugin-daemonset-jv96f 1/1 Running 14 3d23h å¦‚æžœä½ çœ‹åˆ°çš„ç»“æžœç±»ä¼¼ä¸Šé¢è¿™æ ·ï¼Œè¯´æ˜Ž Kubernetes æ˜¯çœŸçš„å°±ç»ªäº†ã€‚ æŸ¥çœ‹ Dashboardmicrok8s.kubectl describe service kubernetes-dashboard -n kube-systemèŽ·å–è®¿é—®ipå’Œç«¯å£ 123456789Name: kubernetes-dashboardNamespace: kube-systemLabels: k8s-app=kubernetes-dashboardAnnotations: kubectl.kubernetes.io/last-applied-configuration: &#123;&quot;apiVersion&quot;:&quot;v1&quot;,&quot;kind&quot;:&quot;Service&quot;,&quot;metadata&quot;:&#123;&quot;annotations&quot;:&#123;&#125;,&quot;labels&quot;:&#123;&quot;k8s-app&quot;:&quot;kubernetes-dashboard&quot;&#125;,&quot;name&quot;:&quot;kubernetes-dashboard&quot;...Selector: k8s-app=kubernetes-dashboardType: ClusterIPIP: 10.152.183.151Port: &lt;unset&gt; 443/TCP æŽ¥ç€è®¿é—®ä¸‹é¢çš„åœ°å€ï¼Œå°±èƒ½çœ‹åˆ°æˆ‘ä»¬ç†Ÿæ‚‰çš„ Dashboard 1https://10.152.183.151/ ä½¿ç”¨ä»¤ç‰Œç™»å½•èŽ·å–token 123token=$(microk8s kubectl -n kube-system get secret | grep default-token | cut -d " " -f1) echo $tokenmicrok8s kubectl -n kube-system describe secret $token è¾“å…¥tokenåŽå°±è¿›å…¥ç®¡ç†é¡µé¢äº†]]></content>
      <categories>
        <category>k8s</category>
      </categories>
      <tags>
        <tag>k8s</tag>
        <tag>microk8s</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Macã€Ubuntuç³»ç»Ÿçš„ä¸‹è½½ç¥žå™¨aria2]]></title>
    <url>%2F2019%2F05%2F12%2FMac%E3%80%81Ubuntu%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%B8%8B%E8%BD%BD%E7%A5%9E%E5%99%A8aria2%2F</url>
    <content type="text"><![CDATA[èƒŒæ™¯Mac ç”¨æˆ·è‚¯å®šéƒ½å—å¤Ÿäº†ç™¾åº¦ç½‘ç›˜åœ¨è‡ªå·±ç”µè„‘ä¸Šçš„ç³Ÿç³•ä½“éªŒï¼Œè‡³å°‘æˆ‘æ˜¯å¦‚æ­¤ï¼šå®‰è£…å®˜æ–¹çš„ Appï¼Œç»å¸¸ä¸‹è½½æ—¶ä¸­æ–­ï¼Œæœ‰æ—¶ç”šè‡³ Bug èˆ¬è¿žç»­ä¸­æ–­ï¼Œæ— å¥ˆä½¿ç”¨æµè§ˆå™¨ä¸‹è½½ï¼Œé€Ÿåº¦å´æ˜¯ä»¤äººæŒ å¤´ã€‚èŠ±ç‚¹æ—¶é—´æ¥é…ç½® aria2ï¼Œç»“åˆ Chromeï¼Œä¸€å®šè®©ä½ èˆ’å¿ƒ aria2 æ˜¯ä»€ä¹ˆï¼Ÿ aria2 æ˜¯ä¸€æ¬¾æ”¯æŒå¤šç§åè®®çš„è½»é‡çº§å‘½ä»¤è¡Œä¸‹è½½å·¥å…·ã€‚æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š å¤šçº¿ç¨‹è¿žçº¿ï¼šaria2 ä¼šè‡ªåŠ¨ä»Žå¤šä¸ªçº¿ç¨‹ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶å……åˆ†åˆ©ç”¨ä½ çš„å¸¦å®½ï¼› è½»é‡ï¼šè¿è¡Œæ—¶ä¸ä¼šå ç”¨è¿‡å¤šèµ„æºï¼Œæ ¹æ®å®˜æ–¹ä»‹ç»ï¼Œå†…å­˜å ç”¨é€šå¸¸åœ¨ 4MB~9MBï¼Œä½¿ç”¨ BitTorrent åè®®ï¼Œä¸‹è¡Œé€Ÿåº¦ 2.8MB/s æ—¶ CPU å ç”¨çŽ‡çº¦ 6%ï¼› å…¨åŠŸèƒ½ BitTorrent å®¢æˆ·ç«¯ï¼› æ”¯æŒ RPC ç•Œé¢è¿œç¨‹æŽ§åˆ¶ï¼ˆä¸‹æ–‡é‡ç‚¹ä»‹ç»ï¼‰ã€‚ å¼€å§‹å§ 1.å®‰è£… aria21brew install aria2 2.è®¾ç½®é…ç½®æ–‡ä»¶aria2 æä¾›ä¸¤ç§æ–¹å¼ä½¿ç”¨ï¼Œä¸€ç§æ˜¯ç›´æŽ¥å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è½½ï¼Œä¸æŽ¨èä½¿ç”¨è¿™ç§æ–¹æ³•ï¼ŒæŽ¨èä½¿ç”¨å¦å¤–ä¸€ç§ RPC æ¨¡å¼ï¼Œè¿™ç§æ–¹å¼ aria å¯åŠ¨ä¹‹åŽåªä¼šå®‰é™çš„ç­‰å¾…ä¸‹è½½è¯·æ±‚ï¼Œä¸‹è½½å®ŒæˆåŽä¹Ÿåªä¼šå®‰é™çš„é©»ç•™åŽå°ä¸ä¼šè‡ªåŠ¨é€€å‡ºã€‚è€Œä½¿ç”¨RPCæ¨¡å¼æŽ¨èåšä¸€ä¸ªé…ç½®æ–‡ä»¶æ–¹ä¾¿ä½¿ç”¨ã€‚æˆ‘ä»¬æŠŠé…ç½®æ–‡ä»¶æ”¾åœ¨ ~/.aria2 ä¸‹ï¼Œä¾æ¬¡è¾“å…¥å‘½ä»¤ï¼š 1234cd ~mkdir .aria2cd .aria2vim aria2.conf å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ°aria2.conf 12345678910111213141516171819202122232425262728293031323334353637383940414243444546#ç”¨æˆ·å#rpc-user=user#å¯†ç #rpc-passwd=passwd#ä¸Šé¢çš„è®¤è¯æ–¹å¼ä¸å»ºè®®ä½¿ç”¨,å»ºè®®ä½¿ç”¨ä¸‹é¢çš„tokenæ–¹å¼#è®¾ç½®åŠ å¯†çš„å¯†é’¥#rpc-secret=token#å…è®¸rpcenable-rpc=true#å…è®¸æ‰€æœ‰æ¥æº, webç•Œé¢è·¨åŸŸæƒé™éœ€è¦rpc-allow-origin-all=true#å…è®¸å¤–éƒ¨è®¿é—®ï¼Œfalseçš„è¯åªç›‘å¬æœ¬åœ°ç«¯å£rpc-listen-all=true#RPCç«¯å£, ä»…å½“é»˜è®¤ç«¯å£è¢«å ç”¨æ—¶ä¿®æ”¹#rpc-listen-port=6800#æœ€å¤§åŒæ—¶ä¸‹è½½æ•°(ä»»åŠ¡æ•°), è·¯ç”±å»ºè®®å€¼: 3max-concurrent-downloads=5#æ–­ç‚¹ç»­ä¼ continue=true#åŒæœåŠ¡å™¨è¿žæŽ¥æ•°max-connection-per-server=5#æœ€å°æ–‡ä»¶åˆ†ç‰‡å¤§å°, ä¸‹è½½çº¿ç¨‹æ•°ä¸Šé™å–å†³äºŽèƒ½åˆ†å‡ºå¤šå°‘ç‰‡, å¯¹äºŽå°æ–‡ä»¶é‡è¦min-split-size=10M#å•æ–‡ä»¶æœ€å¤§çº¿ç¨‹æ•°, è·¯ç”±å»ºè®®å€¼: 5split=10#ä¸‹è½½é€Ÿåº¦é™åˆ¶max-overall-download-limit=0#å•æ–‡ä»¶é€Ÿåº¦é™åˆ¶max-download-limit=0#ä¸Šä¼ é€Ÿåº¦é™åˆ¶max-overall-upload-limit=0#å•æ–‡ä»¶é€Ÿåº¦é™åˆ¶max-upload-limit=0#æ–­å¼€é€Ÿåº¦è¿‡æ…¢çš„è¿žæŽ¥#lowest-speed-limit=0#éªŒè¯ç”¨ï¼Œéœ€è¦1.16.1ä¹‹åŽçš„releaseç‰ˆæœ¬#referer=*#æ–‡ä»¶ä¿å­˜è·¯å¾„, é»˜è®¤ä¸ºå½“å‰å¯åŠ¨ä½ç½®dir=/Users/xxx/Downloads#æ–‡ä»¶ç¼“å­˜, ä½¿ç”¨å†…ç½®çš„æ–‡ä»¶ç¼“å­˜, å¦‚æžœä½ ä¸ç›¸ä¿¡Linuxå†…æ ¸æ–‡ä»¶ç¼“å­˜å’Œç£ç›˜å†…ç½®ç¼“å­˜æ—¶ä½¿ç”¨, éœ€è¦1.16åŠä»¥ä¸Šç‰ˆæœ¬#disk-cache=0#å¦ä¸€ç§Linuxæ–‡ä»¶ç¼“å­˜æ–¹å¼, ä½¿ç”¨å‰ç¡®ä¿æ‚¨ä½¿ç”¨çš„å†…æ ¸æ”¯æŒæ­¤é€‰é¡¹, éœ€è¦1.15åŠä»¥ä¸Šç‰ˆæœ¬(?)#enable-mmap=true#æ–‡ä»¶é¢„åˆ†é…, èƒ½æœ‰æ•ˆé™ä½Žæ–‡ä»¶ç¢Žç‰‡, æé«˜ç£ç›˜æ€§èƒ½. ç¼ºç‚¹æ˜¯é¢„åˆ†é…æ—¶é—´è¾ƒé•¿#æ‰€éœ€æ—¶é—´ none &lt; falloc ? trunc Â« prealloc, fallocå’Œtruncéœ€è¦æ–‡ä»¶ç³»ç»Ÿå’Œå†…æ ¸æ”¯æŒfile-allocation=prealloc é»˜è®¤ä¸‹è½½è·¯å¾„çš„ã€Œ/Users/xxx/Downloadsã€å¯ä»¥æ”¹ä¸ºä»»ä½•ä½ æƒ³è¦çš„ç»å¯¹è·¯å¾„ã€‚æ­¤å¤„å†™ä¸º Downloads ç›®å½•ï¼Œxxx è¯·è‡ªè¡Œæ›¿æ¢æˆä½ çš„ Mac ç”¨æˆ·åï¼Œç„¶åŽä¿å­˜ï¼Œé€€å‡ºç¼–è¾‘å™¨ã€‚ 3.å¯åŠ¨ RPC æ¨¡å¼åœ¨ç»ˆç«¯è¾“å…¥aria2c â€“conf-path=â€/Users/xxxxxx/.aria2/aria2.confâ€ -Dï¼Œç„¶åŽ aria2 å°±å¯åŠ¨äº†ï¼Œä½†æ˜¯å¦‚ä½•æžå®šç™¾åº¦ç½‘ç›˜ï¼Ÿè¿˜éœ€è¦åœ¨Chromeç½‘ä¸Šåº”ç”¨å•†åº—ä¸‹è½½ç™¾åº¦ç½‘ç›˜åŠ©æ‰‹æ’ä»¶ã€‚ 4.è®¿é—®webUIé¦–å…ˆä»Žgithubä¸­å…‹éš†webui-aria2é¡¹ç›® 1git clone https://github.com/ziahamza/webui-aria2 æ–¹æ³•ä¸€ï¼šä¸éœ€åˆ›å»ºä»»ä½• web æœåŠ¡å™¨ï¼Œåªéœ€ç›´æŽ¥åŒå‡»è¿è¡Œ index.html æ–¹æ³•äºŒï¼šåœ¨ç»ˆç«¯æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ 1python -m SimpleHTTPServer 6801 åœ¨æµè§ˆå™¨ä¸­è®¿é—®http://localhost:6801 å³å¯ 5.å¦‚ä½•è¿›è¡Œä¸‹è½½æ“ä½œéšä¾¿æ‰“å¼€ä¸€ä¸ªç™¾åº¦ç½‘ç›˜çš„é“¾æŽ¥ï¼Œä¼šå‘çŽ°ç½‘é¡µä¸Šå¤šå‡ºä¸€ä¸ªã€Œå¯¼å‡ºä¸‹è½½ã€æŒ‰é’®ï¼Œç‚¹å‡»å®ƒå¼¹å‡ºçš„ã€ŒARIA2 RPCã€å°±è‡ªåŠ¨æ·»åŠ åˆ°ä½ çš„ä¸‹è½½é˜Ÿåˆ—é‡Œäº†ï¼Œç„¶åŽåˆ©ç”¨ è¿™é‡Œ æä¾›çš„ç½‘é¡µç•Œé¢ç®¡ç†ä½ çš„ä¸‹è½½ä»»åŠ¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½ å¯ä»¥åˆ©ç”¨å›¾å½¢ç•Œé¢è¿›è¡Œè®¸å¤šæ“ä½œï¼š 6.å…³é—­ aria2å¦‚æžœä½ æƒ³å…³æŽ‰åŽå°çš„ aria2ï¼Œå¯ä»¥åˆ°æ´»åŠ¨ç›‘è§†å™¨ä¸­æ‰¾åˆ° aria2c æ€æŽ‰ 7.è®¾ç½®aria2å¼€æœºè‡ªåŠ¨å¯åŠ¨åœ¨å®¶ç›®å½• /Users/liby/ æ‰§è¡Œ vim aria2-starter,ç„¶åŽæ·»åŠ å¦‚ä¸‹å†…å®¹ 1234#!/bin/basharia2c --conf-path=&quot;/Users/liby/.aria2/aria2.conf&quot; -Dnohup python -m SimpleHTTPServer 6801 &amp;exit è®¾ç½®è¯¥è„šæœ¬ä¸ºå¯æ‰§è¡Œæ–‡ä»¶æœ€åŽåœ¨ ç³»ç»Ÿåå¥½è®¾ç½®-&gt;ç”¨æˆ·ä¸Žç»„ç¾¤-&gt;ç™»å½•é¡¹ æ·»åŠ è¯¥æ‰§è¡Œè„šæœ¬ 8.æ€»ç»“é€šè¿‡ Aria2 ä¸‹è½½åŽï¼Œé€Ÿåº¦ä¸€èˆ¬å¯è¾¾300KBä»¥ä¸Šï¼Œå¦‚æžœä¸ç”¨ï¼ŒåŒä¸€ä¸ªæ–‡ä»¶å¯èƒ½æ‰åªæœ‰å‡ åæˆ–è€…100Kå·¦å³çš„é€Ÿåº¦ï¼Œè¿™ä¸ªå·®åˆ«çœŸæ˜¯éžå¸¸å¤§å•Šï¼]]></content>
      <categories>
        <category>Ubuntu</category>
      </categories>
      <tags>
        <tag>ç³»ç»Ÿè®¾ç½®</tag>
        <tag>aria2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu16.04ç³»ç»Ÿå·¥ä½œçŽ¯å¢ƒè®¾ç½®]]></title>
    <url>%2F2017%2F03%2F11%2FUbuntu16-04%E7%B3%BB%E7%BB%9F%E5%B7%A5%E4%BD%9C%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[ä¸»é¢˜ç¾ŽåŒ–1.æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…Flatabulousä¸»é¢˜ 1234sudo apt-get install unity-tweak-toolsudo add-apt-repository ppa:noobslab/themessudo apt-get updatesudo apt-get install flatabulous-theme 2.è¯¥ä¸»é¢˜æœ‰é…å¥—çš„å›¾æ ‡ï¼Œå®‰è£…æ–¹å¼å¦‚ä¸‹ 123sudo add-apt-repository ppa:noobslab/iconssudo apt-get updatesudo apt-get install ultra-flat-icons 3.å®‰è£…å®ŒæˆåŽï¼Œæ‰“å¼€unity-tweak-toolè½¯ä»¶ï¼Œä¿®æ”¹ä¸»é¢˜å’Œå›¾æ ‡ 4.è¿›å…¥Themeï¼Œä¿®æ”¹ä¸ºFlatabulous 5.åœ¨æ­¤ç•Œé¢ä¸‹è¿›å…¥Iconsæ ï¼Œä¿®æ”¹ä¸ºUltra-flat 6.å®‰è£…å­—ä½“YaHei Consolas Hybrid 1234è¦æƒ³å®‰è£…è¿™æ¬¾å­—ä½“ï¼Œé¦–å…ˆéœ€è¦å®‰è£… Font Manager (å­—ä½“ç®¡ç†)è½¯ä»¶ã€‚sudo apt-get install font-managergoogleæœç´¢ YaHei.Consolas ä¸‹è½½è¿™æ¬¾å­—ä½“ã€‚åœ¨ Font Manager ä¸­ç‚¹å‡» Manager Fonts - Install Fonts ï¼Œå°±å¯ä»¥å®‰è£… ttf å­—ä½“äº†ã€‚ ç³»ç»Ÿæ›´æ–°12sudo apt-get updatesudo apt-get upgrade å®‰è£…vim1sudo apt-get install vim å®‰è£… maximum-awesome-linux12git clone https://github.com/smartliby/maximum-awesome-linux.gitcd maximum-awesome-linux &amp;&amp; rake å®‰è£…zshã€oh-my-zshå®‰è£…zsh 1sudo apt install zsh via curl download Oh My Zsh 1sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)" åˆ‡æ¢åˆ°zsh 1chsh -s /usr/bin/zsh å®‰è£…terminatorUbuntuè‡ªå¸¦çš„ç»ˆç«¯æ˜¯gnome-terminalï¼Œè™½ç„¶ä¹Ÿè¿˜ä¸é”™ï¼Œä½†æ˜¯ä¸èƒ½æ”¯æŒå±å¹•åˆ†å‰²ã€é€‰æ‹©å¤åˆ¶ç­‰åŠŸèƒ½è®©æˆ‘å¾ˆä¸çˆ½ï¼ŒäºŽæ˜¯æˆ‘æ¢ç”¨terminatorä½œä¸ºç»ˆç«¯ï¼Œterminatorå¯ä»¥æ”¯æŒå±å¹•åˆ†å‰²ï¼Œå¹¶ä¸”é»˜è®¤å¿«æ·é”®å’Œgnome-terminalæ— å¼‚ï¼Œç†Ÿæ‚‰gnome-terminalçš„è¯å¯ä»¥å¿«é€Ÿä¸Šæ‰‹ã€‚ Ubuntuä¸‹å¯ä»¥è¿™æ ·å®‰è£…terminator 1sudo apt-get install terminator terminatorå¸¸ç”¨å¿«æ·é”® Ctrl-Shift-c æ‹·è´ Ctrl-Shift-v ç²˜è´´ Ctrl-Shift-t å¼€æ–°Tabçª—å£ Ctrl-Shift-o ä¸Šä¸‹æ‹†åˆ†å±å¹• Ctrl-Shift-e å·¦å³æ‹†åˆ†å±å¹• Ctrl-Shift-w å…³é—­å½“å‰çª—å£ Ctrl-Shift-q å…³é—­æ•´ä¸ªç»ˆç«¯ é…ç½®terminatorä½¿ç”¨solarizedé…è‰² 12mkdir -p ~/.config/terminator/curl https://raw.github.com/ghuntley/terminator-solarized/master/config &gt; ~/.config/terminator/config ç„¶åŽé‡æ–°æ‰“å¼€terminatorå°±å·²ç»æ˜¯solarizedé…è‰²äº†ã€‚ å¯¹terminatoræ›´å¤šçš„é…ç½® æŽ¥ä¸‹æ¥ï¼Œå¯ä»¥åœ¨terminator-solarizedé…ç½®æ–‡ä»¶çš„åŸºç¡€ä¸Šè¿›è¡Œæ›´å¤šçš„é…ç½®ï¼Œä¾‹å¦‚èƒŒæ™¯é€æ˜Žã€å¯ç”¨é€‰æ‹©å¤åˆ¶ç­‰ã€‚ å…³äºŽterminatorçš„è¯¦ç»†é…ç½®é€‰é¡¹å¯ä»¥å‚è€ƒterminator manpageï¼Œä¸‹é¢è´´å‡ºæˆ‘çš„~/.config/terminator/configä¾›å‚è€ƒï¼š 12345678910111213141516171819202122232425262728293031323334353637383940[global_config] title_transmit_bg_color = "#d30102" focus = system suppress_multiple_term_dialog = True[keybindings][profiles] [[default]] palette = "#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3" copy_on_selection = True background_image = None background_darkness = 0.95 background_type = transparent use_system_font = False cursor_color = "#eee8d5" foreground_color = "#839496" show_titlebar = False font = Monospace 11 background_color = "#002b36" [[solarized-dark]] palette = "#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3" background_color = "#002b36" background_image = None cursor_color = "#eee8d5" foreground_color = "#839496" [[solarized-light]] palette = "#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3" background_color = "#fdf6e3" background_image = None cursor_color = "#002b36" foreground_color = "#657b83"[layouts] [[default]] [[[child1]]] type = Terminal parent = window0 profile = default [[[window0]]] type = Window parent = ""[plugins] é…ç½®dircolors å®Œæˆä¸Šè¿°é…ç½®åŽï¼Œä½ ä¼šå‘çŽ°ç”¨lså‘½ä»¤æŸ¥çœ‹ç›®å½•å’Œæ–‡ä»¶æ—¶æ˜¯ä¸€ç‰‡ç°è‰²ã€‚è¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹solarizedå„ç§brightæ–¹æ¡ˆåŸºæœ¬éƒ½æ˜¯ç°è‰²ï¼Œè€Œç³»ç»Ÿé»˜è®¤æ˜¾ç¤ºç›®å½•å’Œæ–‡ä»¶æ—¶å¤šç”¨brightè‰²ï¼Œæ­¤æ—¶éœ€è¦é…ç½®dircolorsæ‰èƒ½æ˜¾ç¤ºå‡ºå½©è‰²çš„æ–‡ä»¶å’Œç›®å½•ã€‚ dircolors-solarizedé¡¹ç›®æä¾›äº†é€‚åˆäºŽsolarizedçš„dircolorsé…è‰²æ–¹æ¡ˆï¼Œåªè¦é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆä½¿ç”¨å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚æˆ‘æ˜¯ç”¨çš„solarized darké…è‰²ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©é€‚åˆè¿™ä¸ªé…è‰²çš„dircolors.ansi-dark 1curl https://raw.github.com/seebi/dircolors-solarized/master/dircolors.ansi-dark &gt; ~/.dircolors ç„¶åŽåœ¨~/.zshrcä¸­åŠ å…¥å¦‚ä¸‹é…ç½®ï¼š 12345678910111213141516# enable color support of ls and also add handy aliasesif [ -x /usr/bin/dircolors ]; then test -r ~/.dircolors &amp;&amp; eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)" alias ls='ls --color=auto' #alias dir='dir --color=auto' #alias vdir='vdir --color=auto' alias grep='grep --color=auto' alias fgrep='fgrep --color=auto' alias egrep='egrep --color=auto'fi# some more ls aliasesalias ll='ls -alF'alias la='ls -A'alias l='ls -CF' æ‰§è¡Œ 1source ~/.zshrc åŽï¼Œå†æ‰§è¡Œlsæˆ–llå°±å¯ä»¥çœ‹åˆ°å½©è‰²çš„ç›®å½•æˆ–æ–‡ä»¶äº†ã€‚ é…ç½®å®Œçš„terminatoræ•ˆæžœå¦‚ä¸‹ï¼š å®‰è£…jdk1.81234567891011121.ä¸‹è½½jdkï¼Œå› ä¸ºoracleçŽ°åœ¨è¦åŒæ„åè®®æ‰èƒ½ä¸‹è½½ï¼Œç›´æŽ¥ä½¿ç”¨wgetåŠ é“¾æŽ¥ä¸‹è½½ä¸åˆ°ï¼Œæ‰€ä»¥è¦åŠ ä¸Šå‰é¢çš„é‚£äº›ä»£ç  wget --no-check-certificate --no-cookie --header "Cookie: oraclelicense=accept-securebackup-cookie;" http://download.oracle.com/otn-pub/java/jdk/8u121-b13/jdk-8u121-linux-x64.tar.gz2.å®‰è£…jdk tar -zxvf jdk-8u121-linux-x64.tar.gz3.è®¾ç½®çŽ¯å¢ƒå˜é‡ vim /home/liby/.zshrc,æ·»åŠ å¦‚ä¸‹å†…å®¹ export JAVA_HOME=/home/liby/local/jdk1.8.0_121/ export JRE_HOME=$&#123;JAVA_HOME&#125;/jre export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib export MAVEN_HOME=/home/liby/local/apache-maven-3.3.9 export PATH=$&#123;JAVA_HOME&#125;/bin:$&#123;MAVEN_HOME&#125;/bin:$PATH4.åˆ·æ–°é…ç½®æ–‡ä»¶ source /home/liby/.zshrc å®‰è£…maven1234567891011121.ä¸‹è½½maven wget http://mirror.cc.columbia.edu/pub/software/apache/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.tar.gz2.å®‰è£…maven tar -zxvf apache-maven-3.3.9-bin.tar.gz3.è®¾ç½®çŽ¯å¢ƒå˜é‡ vim /home/liby/.zshrc,æ·»åŠ å¦‚ä¸‹å†…å®¹ export JAVA_HOME=/home/liby/local/jdk1.8.0_121/ export JRE_HOME=$&#123;JAVA_HOME&#125;/jre export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib export MAVEN_HOME=/home/liby/local/apache-maven-3.3.9 export PATH=$&#123;JAVA_HOME&#125;/bin:$&#123;MAVEN_HOME&#125;/bin:$PATH4.åˆ·æ–°é…ç½®æ–‡ä»¶ source /home/liby/.zshrc ä¸‹è½½chrome123wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.debsudo dpkg -i google-chrome-stable_current_amd64.debç™»å½•è´¦å·å¹¶åŒæ­¥æ•°æ® å®‰è£…æœç‹—è¾“å…¥æ³•12wget http://cdn2.ime.sogou.com/dl/index/1475147394/sogoupinyin_2.1.0.0082_amd64.deb?st=_vb5fHHeRyUHCwduavC5Qw&amp;e=1489585347&amp;fn=sogoupinyin_2.1.0.0082_amd64.debsudo dpkg -i sogoupinyin_2.1.0.0082_amd64.deb å®‰è£…virtualbox12wget http://download.virtualbox.org/virtualbox/5.1.16/virtualbox-5.1_5.1.16-113841~Ubuntu~xenial_amd64.debsudo dpkg -i virtualbox-5.1_5.1.16-113841~Ubuntu~xenial_amd64.deb å®‰è£…idea123wget https://download.jetbrains.8686c.com/idea/ideaIU-2016.3.5.tar.gztar -zxvf ideaIU-2016.3.5.tar.gzå®‰è£…æ’ä»¶ï¼šscala,.ignore,python,Markdown Navigator2.3.2ç ´è§£ç‰ˆ,VisualVM Launcher å®‰è£…pycharm123wget https://download.jetbrains.8686c.com/python/pycharm-professional-2016.3.2.tar.gztar -zxvf pycharm-professional-2016.3.2.tar.gzå®‰è£…æ’ä»¶ï¼š.ignore,Markdown Navigator2.3.2ç ´è§£ç‰ˆ ä¿®å¤ideaå’Œpycharmå­—ä½“æ¨¡ç³Šé”¯é½¿å’Œä¹±ç ç­‰çŽ°è±¡è®¾ç½®å­—ä½“ä¸ºYaHei Consolas Hybridï¼ŒåŒæ—¶æ”¯æŒä¸­è‹±æ–‡ ideaä¸Žç³»ç»Ÿå†²çªçš„å¿«æ·é”®è®¾ç½®1234561.Change or disable the Lock Screen action, assigned to Ctrl + Alt + L (Reformat code)2.Change or disable the Launch terminal action, assigned to Ctrl + Alt + T (Surround with)3.Change or disable the Switch to workspace action, assigned to Ctrl + Alt + Arrow Keys(Navigation)4.Disable the Move window action, assigned to Alt + F7 (Find usages)5.Change or disable the Resize window action, assigned to Alt + F8 (Evaluate expression)6.Fcitxè¾“å…¥æ³•æ¿€æ´»å¿«æ·é”®ï¼Œassigned to Ctrl + ç©ºæ ¼ (code completion basic) è§£å†³åŠžæ³•æ˜¯æ‰“å¼€ç³»ç»Ÿè®¾ç½®ä¸­çš„é”®ç›˜ï¼Œä¿®æ”¹å†²çªçš„å¿«æ·é”®ï¼Œå°†ç³»ç»Ÿçš„å¿«æ·é”®ç¦ç”¨æˆ–è€…ä¿®æ”¹ideaå¿«æ·é”®ã€‚ 1234561.ä¿®æ”¹ideaå¿«æ·é”®ä¸ºCtrl + L2.ç”¨çš„åœ°æ–¹ä¸å¤šï¼Œå…ˆä¸ä¿®æ”¹äº†3.çª—å£ä¸­çš„ç§»åŠ¨çª—å£ç¦ç”¨4.å¯¼èˆªä¸­çš„åˆ‡æ¢è‡³å·¦ä¾§å·¥ä½œåŒº/åˆ‡æ¢è‡³å³ä¾§å·¥ä½œåŒº/åˆ‡æ¢è‡³ä¾§ä¸Šå·¥ä½œåŒº/åˆ‡æ¢è‡³ä¸‹ä¾§å·¥ä½œåŒºç¦ç”¨5.çª—å£ä¸­çš„è°ƒæ•´çª—å£å¤§å°ç¦ç”¨6.ç¦ç”¨Fcitxè¾“å…¥æ³•æ¿€æ´»å¿«æ·é”® å®‰è£…atom12wget https://atom-installer.github.com/v1.15.0/atom-amd64.deb?s=1489019656&amp;ext=.debsudo dpkg -i atom-amd64.deb å®‰è£…æ’ä»¶ï¼šmarkdown-writerã€autocomplete-pythonã€ile-iconsã€git-controlã€language-hqlã€markdown-pdfã€pdf-viewã€activate-power-mode å®‰è£…markdownç¥žå™¨1234567# optional, but recommendedsudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys BA300B7755AFCFAE# add Typora's repositorysudo add-apt-repository 'deb https://typora.io ./linux/'sudo apt-get update# install typorasudo apt-get install typora æˆªå›¾å·¥å…·1sudo apt-get install shutter ç½‘æ˜“äº‘éŸ³ä¹123wget http://s1.music.126.net/download/pc/netease-cloud-music_1.0.0_amd64_ubuntu16.04.debsudo dpkg -i netease-cloud-music_1.0.0_amd64_ubuntu16.04.debç™»å½•è´¦å·å¹¶åŒæ­¥æ•°æ® å¼€å¯sshæœåŠ¡ï¼Œå…è®¸è¿œç¨‹è¿žæŽ¥12sudo apt-get install openssh-serverè¿™æ ·å…¶ä»–çš„ç”µè„‘å°±å¯ä»¥sshç™»å½•å…¬å¸çš„è¿™å°ç”µè„‘äº† å¼€å¯è¿œç¨‹æ¡Œé¢æœåŠ¡ 1.Dashä¸­æ‰“å¼€æ¡Œé¢å…±äº« 2.å®‰è£…å¹¶è¿è¡Œdconf-editorï¼ŒæŠŠåŠ å¯†é€‰é¡¹åŽ»æŽ‰ 12sudo apt-get install dconf-editordconf-editor ä¾æ¬¡å±•å¼€org-&gt;gnome-&gt;desktop-&gt;remote-accessè¿™é‡Œä¹Ÿå¯ä»¥ç›´æŽ¥è®¾ç½®è¿œç¨‹æŽ§åˆ¶é€‰é¡¹ï¼Œä½†é‡è¦çš„æ˜¯å°†â€œrequre-encryptionâ€åŽ»æŽ‰ã€‚ ä¹‹åŽå°±å¯ä»¥åœ¨å…¶ä»–çš„ç”µè„‘ä¸Šä½¿ç”¨è¿œç¨‹æ¡Œé¢ç™»å½•äº† 16.04é»˜è®¤æ²¡æœ‰æ‰“å¼€å·¥ä½œåŒºåˆ‡æ¢åŠŸèƒ½éœ€è¦æ‰‹åŠ¨æ‰“å¼€ï¼Œä½¿ç”¨èµ·æ¥æ–¹ä¾¿å¤šäº†ã€‚ æœ€ç»ˆçš„æ•ˆæžœå›¾]]></content>
      <categories>
        <category>Ubuntu</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ç³»ç»Ÿè®¾ç½®</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flume1.7æºç è°ƒè¯•]]></title>
    <url>%2F2017%2F02%2F14%2FFlume1-7%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95%2F</url>
    <content type="text"><![CDATA[ä¸‹è½½æºç git clone https://github.com/apache/flume.git å°†æºç å¯¼å…¥Idea ç¼–è¯‘æ—¶ä¼šæœ‰ä»¥ä¸‹jarä»“åº“ä¸­æ— æ³•æ‰¾åˆ°å¹¶ä¸‹è½½ï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“1linq4j-0.4.jar pentaho-aggdesigner-algorithm-5.1.3-jhyde.jar quidem-0.1.1.jar ä»¥ä¸Šjaræ–‡ä»¶å¯ä»¥åœ¨ä¸‹é¢çš„ç½‘ç«™ä¸­æ‰¾åˆ° 12http://conjars.org/repo/http://repository.pentaho.org/artifactory/repo/ æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°†jarä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ 123mvn install:install-file -Dfile=pentaho-aggdesigner-algorithm-5.1.3-jhyde.jar -DgroupId=org.pentaho -DartifactId=pentaho-aggdesigner-algorithm -Dversion=5.1.3-jhyde -Dpackaging=jarmvn install:install-file -Dfile=linq4j-0.4.jar -DgroupId=net.hydromatic -DartifactId=linq4j -Dversion=0.4 -Dpackaging=jarmvn install:install-file -Dfile=quidem-0.1.1.jar -DgroupId=net.hydromatic -DartifactId=quidem -Dversion=0.1.1 -Dpackaging=jar æ‰§è¡Œç¼–è¯‘å‘½ä»¤1mvn clean install -DskipTests æœ¬åœ°è°ƒè¯•12ä¸»ç±»ï¼šorg.apache.flume.node.Applicationå‚æ•°ï¼š-n agent -f /home/liby/local/apache-flume-1.7.0-bin/conf/flume-conf.properties flume-conf.properties 123456789101112131415161718# Name the components on this agentagent.sources = r1agent.sinks = k1agent.channels = c1# Describe/configure the sourceagent.sources.r1.type = netcatagent.sources.r1.bind = localhostagent.sources.r1.port = 44445# Describe the sink# å°†æ•°æ®è¾“å‡ºè‡³æ—¥å¿—ä¸­agent.sinks.k1.type = logger# Use a channel which buffers events in memoryagent.channels.c1.type = memoryagent.channels.c1.capacity = 1000agent.channels.c1.transactionCapacity = 100# Bind the source and sink to the channelagent.sources.r1.channels = c1agent.sinks.k1.channel = c1 è¿è¡Œæ•ˆæžœ è¿œç¨‹è°ƒè¯•åœ¨conf/flume-env.propertieså¢žåŠ ä»¥ä¸‹é…ç½®ï¼Œç„¶åŽå¯åŠ¨flume 1-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 åœ¨ideaä¸­å¯åŠ¨è¿œç¨‹è°ƒè¯•]]></content>
      <categories>
        <category>Flume</category>
      </categories>
      <tags>
        <tag>Flume</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javaå­—ç¬¦ç¼–ç æµ…æž]]></title>
    <url>%2F2016%2F07%2F14%2Fjava%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E6%B5%85%E6%9E%90%2F</url>
    <content type="text"><![CDATA[javaå­—ç¬¦ç¼–ç æµ…æž å…³äºŽè¿™ç¯‡æ–‡ç« å…¶å®žæ˜¯ä»Žä¸€ä¸ªé—®é¢˜å¼€å§‹çš„ï¼šjavaä¸­charç±»åž‹èƒ½å­˜å‚¨æ±‰å­—å—ï¼Ÿ UTF-8ç¼–ç UTF-8å°±æ˜¯åœ¨äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿çš„ä¸€ç§Unicodeçš„å®žçŽ°æ–¹å¼ã€‚å…¶ä»–å®žçŽ°æ–¹å¼è¿˜åŒ…æ‹¬UTF-16ï¼ˆå­—ç¬¦ç”¨ä¸¤ä¸ªå­—èŠ‚æˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰å’ŒUTF-32ï¼ˆå­—ç¬¦ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰ï¼Œä¸è¿‡åœ¨äº’è”ç½‘ä¸ŠåŸºæœ¬ä¸ç”¨ã€‚é‡å¤ä¸€éï¼Œè¿™é‡Œçš„å…³ç³»æ˜¯ï¼ŒUTF-8æ˜¯Unicodeçš„å®žçŽ°æ–¹å¼ä¹‹ä¸€ã€‚UTF-8æœ€å¤§çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯å®ƒæ˜¯ä¸€ç§å˜é•¿çš„ç¼–ç æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚UTF-8çš„ç¼–ç è§„åˆ™å¾ˆç®€å•ï¼Œåªæœ‰äºŒæ¡ï¼š 1.å¯¹äºŽå•å­—èŠ‚çš„ç¬¦å·ï¼Œå­—èŠ‚çš„ç¬¬ä¸€ä½è®¾ä¸º0ï¼ŒåŽé¢7ä½ä¸ºè¿™ä¸ªç¬¦å·çš„unicodeç ã€‚å› æ­¤å¯¹äºŽè‹±è¯­å­—æ¯ï¼ŒUTF-8ç¼–ç å’ŒASCIIç æ˜¯ç›¸åŒçš„ã€‚2.å¯¹äºŽnå­—èŠ‚çš„ç¬¦å·ï¼ˆn&gt;1ï¼‰ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰nä½éƒ½è®¾ä¸º1ï¼Œç¬¬n+1ä½è®¾ä¸º0ï¼ŒåŽé¢å­—èŠ‚çš„å‰ä¸¤ä½ä¸€å¾‹è®¾ä¸º10ã€‚å‰©ä¸‹çš„æ²¡æœ‰æåŠçš„äºŒè¿›åˆ¶ä½ï¼Œå…¨éƒ¨ä¸ºè¿™ä¸ªç¬¦å·çš„unicodeç ã€‚ä¸‹è¡¨æ€»ç»“äº†ç¼–ç è§„åˆ™ï¼Œå­—æ¯xè¡¨ç¤ºå¯ç”¨ç¼–ç çš„ä½ã€‚ Unicodeç¬¦å·èŒƒå›´(åå…­è¿›åˆ¶) UTF-8ç¼–ç æ–¹å¼(äºŒè¿›åˆ¶) 0000 0000-0000 007F 0xxxxxxx 0000 0080-0000 07FF 110xxxxx 10xxxxxx 0000 0800-0000 FFFF 1110xxxx 10xxxxxx 10xxxxxx 0001 0000-0010 FFFF 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx è·Ÿæ®ä¸Šè¡¨ï¼Œè§£è¯»UTF-8ç¼–ç éžå¸¸ç®€å•ã€‚å¦‚æžœä¸€ä¸ªå­—èŠ‚çš„ç¬¬ä¸€ä½æ˜¯0ï¼Œåˆ™è¿™ä¸ªå­—èŠ‚å•ç‹¬å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼›å¦‚æžœç¬¬ä¸€ä½æ˜¯1ï¼Œåˆ™è¿žç»­æœ‰å¤šå°‘ä¸ª1ï¼Œå°±è¡¨ç¤ºå½“å‰å­—ç¬¦å ç”¨å¤šå°‘ä¸ªå­—èŠ‚ã€‚ä¸‹é¢ï¼Œè¿˜æ˜¯ä»¥æ±‰å­—â€ä¸¥â€ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å®žçŽ°UTF-8ç¼–ç ã€‚å·²çŸ¥â€ä¸¥â€çš„unicodeæ˜¯4E25ï¼ˆ100111000100101ï¼‰ï¼Œæ ¹æ®ä¸Šè¡¨ï¼Œå¯ä»¥å‘çŽ°4E25å¤„åœ¨ç¬¬ä¸‰è¡Œçš„èŒƒå›´å†…ï¼ˆ0000 0800-0000 FFFFï¼‰ï¼Œå› æ­¤â€ä¸¥â€çš„UTF-8ç¼–ç éœ€è¦ä¸‰ä¸ªå­—èŠ‚ï¼Œå³æ ¼å¼æ˜¯â€1110xxxx 10xxxxxx 10xxxxxxâ€ã€‚ç„¶åŽï¼Œä»Žâ€ä¸¥â€çš„æœ€åŽä¸€ä¸ªäºŒè¿›åˆ¶ä½å¼€å§‹ï¼Œä¾æ¬¡ä»ŽåŽå‘å‰å¡«å…¥æ ¼å¼ä¸­çš„xï¼Œå¤šå‡ºçš„ä½è¡¥0ã€‚è¿™æ ·å°±å¾—åˆ°äº†ï¼Œâ€ä¸¥â€çš„UTF-8ç¼–ç æ˜¯â€11100100 10111000 10100101â€ï¼Œè½¬æ¢æˆåå…­è¿›åˆ¶å°±æ˜¯E4B8A5ã€‚ UTF-16ç¼–ç UTF-16æ˜¯Unicodeçš„å…¶ä¸­ä¸€ä¸ªä½¿ç”¨æ–¹å¼ã€‚ UTFæ˜¯ Unicode TransferFormatï¼Œå³æŠŠUnicodeè½¬åšæŸç§æ ¼å¼çš„æ„æ€ã€‚UTF-16æ¯”èµ·UTF-8ï¼Œå¥½å¤„åœ¨äºŽå¤§éƒ¨åˆ†å­—ç¬¦éƒ½ä»¥å›ºå®šé•¿åº¦çš„å­—èŠ‚ (2å­—èŠ‚) å‚¨å­˜ï¼Œä½†UTF-16å´æ— æ³•å…¼å®¹äºŽASCIIç¼–ç ã€‚UTF-16çš„å¤§ç«¯å’Œå°ç«¯å‚¨å­˜å½¢å¼éƒ½åœ¨ç”¨ã€‚ä¸ºäº†å¼„æ¸…æ¥šUTF-16æ–‡ä»¶çš„å¤§å°ç«¯ï¼Œåœ¨UTF-16æ–‡ä»¶çš„å¼€é¦–ï¼Œéƒ½ä¼šæ”¾ç½®ä¸€ä¸ªU+FEFFå­—ç¬¦ä½œä¸ºByte Order Markï¼ˆUTF-16LEä»¥FF FEä»£è¡¨ï¼ŒUTF-16BEä»¥FE FFä»£è¡¨ï¼‰ï¼Œä»¥æ˜¾ç¤ºè¿™ä¸ªæ–‡å­—æ¡£æ¡ˆæ˜¯ä»¥UTF-16ç¼–ç ï¼Œå…¶ä¸­U+FEFFå­—ç¬¦åœ¨UNICODEä¸­ä»£è¡¨çš„æ„ä¹‰æ˜¯ZERO WIDTH NO-BREAK SPACEï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯ä¸ªæ²¡æœ‰å®½åº¦ä¹Ÿæ²¡æœ‰æ–­å­—çš„ç©ºç™½ã€‚ å®žä¾‹è®²è§£ä¾‹1123456789101112String s = &quot;I&apos;m æŽåšçŽ‰&quot;;byte[] charArr = s.getBytes(Charset.forName(&quot;UTF-16&quot;)); for (byte b : charArr) &#123; System.out.printf(&quot;%X &quot;, b); &#125;System.out.println(s.getBytes(Charset.forName(&quot;UTF-16&quot;)).length);charArr = s.getBytes(Charset.forName(&quot;UTF-8&quot;)); for (byte b : charArr) &#123; System.out.printf(&quot;%X &quot;, b); &#125;System.out.println(s.getBytes(Charset.forName(&quot;UTF-8&quot;)).length); è¾“å‡ºçš„ç»“æžœæ˜¯ä»€ä¹ˆå‘¢ï¼ŸFE FF 0 49 0 27 0 6D 0 20 67 4E 53 5A 73 891649 27 6D 20 E6 9D 8E E5 8D 9A E7 8E 8913 1.UTF-16çš„ç¼–ç ä¸ºä»€ä¹ˆæ˜¯16ï¼Ÿå¯¹äºŽå¤§éƒ¨åˆ†å­—ç¬¦æ¥è®²ï¼ŒUTF-16éƒ½ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚ä½†æ˜¯UTF-16æ˜¯æ”¯æŒå¤§å°ç«¯çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨å­—ç¬¦çš„å¼€å¤´ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚çš„é¢å¤–ç©ºé—´æŒ‡å®šå¥½å®ƒçš„å­—èŠ‚åºï¼ŒFE FF è¡¨ç¤ºä½¿ç”¨å¤§ç«¯å­˜å‚¨ã€‚7 x 2 + 2 = 162.UTF-8çš„ç¼–ç ä¸ºä»€ä¹ˆæ˜¯13ï¼ŸUTF-8æ˜¯å®Œå…¨å…¼å®¹ASCIIç¼–ç çš„ï¼Œæ‰€ä»¥è‹±æ–‡æ˜¯å ä¸€ä¸ªå­—èŠ‚ï¼Œä¸­æ–‡å¤§éƒ¨åˆ†å 3ä¸ªå­—èŠ‚ï¼Œä¸å¸¸ç”¨çš„å 4ä¸ªå­—èŠ‚4 + 3 x 3 = 13 ä¾‹2String s1 = â€œæŽâ€;String s2 = â€œâ€œSystem.out.println(s1.length());System.out.println(s2.length()); è¾“å‡ºçš„ç»“æžœæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ12çœ‹åˆ°è¿™ä¸ªç»“æžœæ˜¯ä¸æ˜¯å´©æºƒäº†ï¼Œåˆ°åº•æ€Žä¹ˆå›žäº‹ï¼Ÿ 1.é¦–å…ˆè¦æ˜Žç™½.lengthæŒ‡çš„æ˜¯ä»€ä¹ˆï¼ŒStringå†…éƒ¨æ˜¯ä»¥charæ•°ç»„çš„å½¢å¼å­˜å‚¨çš„ï¼Œ.lengthæ˜¯æŒ‡charæ•°ç»„çš„é•¿åº¦ï¼Œcharæ˜¯ä»¥UTF-16ç¼–ç çš„ï¼ŒæŽæ˜¯å¸¸ç”¨å­—ï¼ŒUTF-16ç¼–ç åŽå ä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªcharå°±èƒ½å¤Ÿå­˜å‚¨ï¼Œæ‰€ä»¥æ˜¯é•¿åº¦æ˜¯1ï¼Œè€ŒUTF-16ç¼–ç åŽå å››ä¸ªå­—èŠ‚ï¼Œä¸¤ä¸ªcharæ¥å­˜å‚¨ï¼Œæ‰€ä»¥é•¿åº¦æ˜¯2]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ç¼–ç </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼19ä¹‹ è¿­ä»£å™¨(Iterator)æ¨¡å¼(è¡Œä¸ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F06%2F03%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F19%E4%B9%8B-%E8%BF%AD%E4%BB%A3%E5%99%A8-Iterator-%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[è¿­ä»£å™¨æ¨¡å¼ç®€ä»‹ è¿­ä»£å™¨æ¨¡å¼åˆå«æ¸¸æ ‡(Cursor)æ¨¡å¼ï¼Œæ˜¯å¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ã€‚è¿­ä»£å™¨æ¨¡å¼å¯ä»¥é¡ºåºåœ°è®¿é—®ä¸€ä¸ªèšé›†ä¸­çš„å…ƒç´ è€Œä¸å¿…æš´éœ²èšé›†çš„å†…éƒ¨è¡¨è±¡ï¼ˆinternal representationï¼‰ã€‚ è¿­ä»£å™¨æ¨¡å¼æ˜¯è®¾è®¡æ¨¡å¼ä¸­æœ€å¸¸è§çš„å‡ ä¸ªæ¨¡å¼ä¹‹ä¸€ã€‚åœ¨Javaçš„é›†åˆ(Collection)æ¡†æž¶ä¸­ï¼Œå¹¿æ³›çš„ä½¿ç”¨è¿­ä»£å™¨(Iteratorå’ŒEnumeration)æ¥éåŽ†é›†åˆçš„å…ƒç´ ã€‚ è¿­ä»£å™¨æ¨¡å¼æ¶‰åŠåˆ°ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼šæŠ½è±¡è¿­ä»£å™¨(Iterator)ï¼Œå…·ä½“è¿­ä»£å™¨(ConcreteIterator)ï¼Œèšé›†(Aggregate)ï¼Œå…·ä½“èšé›†(ConcreteAggregate)ï¼Œå®¢æˆ·ç«¯(Client)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡è¿­ä»£å™¨ æ­¤æŠ½è±¡è§’è‰²å®šä¹‰å‡ºéåŽ†å…ƒç´ æ‰€éœ€çš„æŽ¥å£ã€‚ å…·ä½“è¿­ä»£å™¨ æ­¤è§’è‰²å®žçŽ°äº†æŠ½è±¡è¿­ä»£å™¨çš„æŽ¥å£ï¼Œå¹¶ä¿æŒè¿­ä»£è¿‡ç¨‹ä¸­çš„æ¸¸æ ‡ä½ç½®ã€‚ èšé›† æ­¤æŠ½è±¡è§’è‰²ç»™å‡ºåˆ›å»ºè¿­ä»£å™¨(Iterator)å¯¹è±¡çš„æŽ¥å£ã€‚ å…·ä½“èšé›† å®žçŽ°äº†åˆ›å»ºè¿­ä»£å™¨(Iterator)å¯¹è±¡çš„æŽ¥å£ï¼Œè¿”å›žä¸€ä¸ªåˆé€‚çš„å…·ä½“è¿­ä»£å™¨å®žä¾‹ã€‚ å®¢æˆ·ç«¯ æŒæœ‰å¯¹èšé›†åŠå…¶è¿­ä»£å™¨å¯¹è±¡çš„å¼•ç”¨ï¼Œè°ƒç”¨è¿­ä»£å™¨å¯¹è±¡çš„è¿­ä»£æŽ¥å£ï¼Œä¹Ÿæœ‰å¯èƒ½é€šè¿‡è¿­ä»£å™¨æ“ä½œèšé›†å…ƒç´ çš„å¢žåŠ å’Œåˆ é™¤ã€‚ è¿­ä»£å™¨æ¨¡å¼æœ‰ä¸¤ç§ï¼šå¤–ç¦€è¿­ä»£å™¨å’Œå†…ç¦€è¿­ä»£å™¨ã€‚å¤–ç¦€è¿­ä»£å™¨ â€“ â€œå…·ä½“è¿­ä»£å™¨â€æ˜¯åœ¨â€å…·ä½“èšé›†â€ä¹‹å¤–å®žçŽ°çš„ã€‚å†…ç¦€è¿­ä»£å™¨ â€“ â€œå…·ä½“è¿­ä»£å™¨â€æ˜¯åœ¨â€å…·ä½“èšé›†â€é‡Œé¢å®žçŽ°çš„ï¼Œâ€å…·ä½“è¿­ä»£å™¨â€æ˜¯â€å…·ä½“èšé›†â€çš„ç§æœ‰å†…éƒ¨ç±»ã€‚ åœ¨å¤–ç¦€è¿­ä»£å™¨ä¸­ï¼Œâ€å…·ä½“èšé›†â€å‘å¤–æä¾›äº†è®¿é—®èšé›†ä¸­å„ä¸ªå…ƒç´ çš„æŽ¥å£ï¼›è€Œåœ¨å†…ç¦€è¿­ä»£å™¨ä¸­ï¼Œâ€å…·ä½“èšé›†â€åŒ…å«äº†å†…éƒ¨ç±»â€å…·ä½“è¿­ä»£å™¨â€ï¼Œè¿™å°±æ„å‘³ç€â€å…·ä½“è¿­ä»£å™¨â€å¯ä»¥ç›´æŽ¥è®¿é—®â€å…·ä½“èšé›†â€çš„æˆå‘˜å¯¹è±¡ï¼Œè€Œä¸éœ€è¦é€šè¿‡å‡½æ•°æŽ¥å£åŽ»è®¿é—®ã€‚ å¤–ç¦€è¿­ä»£å™¨ å¦‚æžœè¿­ä»£å™¨æ˜¯åœ¨èšé›†ç»“æž„ä¹‹å¤–å®žçŽ°çš„ï¼Œè¿™æ ·çš„è¿­ä»£å™¨è¢«ç§°ä¸ºå¤–ç¦€è¿­ä»£å™¨(Extrinsic Iterator)ã€‚ ä¸‹é¢çœ‹çœ‹â€å¤–ç¦€è¿­ä»£å™¨â€ä¸­å„ä¸ªè§’è‰²çš„ä»£ç ã€‚ æŠ½è±¡è¿­ä»£å™¨ç±»public interface Iterator { // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªå…ƒç´  public void first(); // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´  public void next(); // è¿­ä»£æ–¹æ³•ï¼šæ˜¯å¦ä¸ºæœ€åŽä¸€ä¸ªå…ƒç´  public boolean isDone(); // è¿­ä»£æ–¹æ³•ï¼šè¿”è¿˜å½“å‰å…ƒç´  public Object currentItem(); } å…·ä½“è¿­ä»£å™¨ç±»public class ConcreteIterator implements Iterator { private ConcreteAggregate agg; // ç´¢å¼•ä½ç½® private int index = 0; // é›†åˆå¤§å° private int size = 0; public ConcreteIterator(ConcreteAggregate agg){ this.agg = agg; this.size = agg.size(); index = 0; } // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªå…ƒç´  @Override public void first() { index = 0; } // è¿­ä»£æ–¹æ³•ï¼šæ˜¯å¦ä¸ºæœ€åŽä¸€ä¸ªå…ƒç´  @Override public boolean isDone() { return (index &gt;= size); } // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´  @Override public void next() { if(index &lt; size) { index ++; } } // è¿­ä»£æ–¹æ³•ï¼šè¿”è¿˜å½“å‰å…ƒç´  @Override public Object currentItem() { return agg.getElement(index); } } èšé›†ç±»abstract public class Aggregate { // å·¥åŽ‚æ–¹æ³•ï¼šè¿”å›žè¿­ä»£å™¨å¯¹è±¡ public abstract Iterator createIterator(); } å…·ä½“èšé›†ç±»public class ConcreteAggregate extends Aggregate { private Object[] objs = {&quot;Monk Tang&quot;, &quot;Monkey&quot;, &quot;Pigsy&quot;, &quot;Sandy&quot;, &quot;Horse&quot;}; @Override public Iterator createIterator() { return new ConcreteIterator(this); } // å–å€¼æ–¹æ³•ï¼šå‘å¤–ç•Œæä¾›èšé›†å…ƒç´  public Object getElement(int index){ if(index &lt; objs.length){ return objs[index]; }else{ return null; } } // å–å€¼æ–¹æ³•ï¼šå‘å¤–ç•Œæä¾›èšé›†çš„å¤§å° public int size(){ return objs.length; } } å®¢æˆ·ç«¯ç±»public class Client { private Iterator it; private Aggregate agg = new ConcreteAggregate(); public void operation() { it = agg.createIterator(); while(!it.isDone()) { System.out.println(it.currentItem()); it.next(); } }3.4 public static void main(String[] args) { Client client = new Client(); client.operation(); } } è¿è¡Œç»“æžœï¼š Monk Tang Monkey Pigsy Sandy Horse å†…ç¦€è¿­ä»£å™¨ å¦‚æžœå°†â€å¤–ç¦€è¿­ä»£å™¨â€ä¸­çš„â€å…·ä½“è¿­ä»£å™¨â€æ”¹å†™æˆâ€å…·ä½“èšé›†ç±»â€çš„ä¸€ä¸ªç§æœ‰ç±»ï¼Œå³è¿­ä»£å™¨æ˜¯åœ¨èšé›†ç»“æž„ä¹‹å†…å®žçŽ°ï¼›è¿™æ ·çš„è¿­ä»£å™¨ï¼Œå°±è¢«ç§°ä¸ºå†…ç¦€è¿­ä»£å™¨(Intrinsic Iterator)ã€‚ ä¸‹é¢çœ‹çœ‹â€å†…ç¦€è¿­ä»£å™¨â€ä¸­å„ä¸ªè§’è‰²çš„ä»£ç ã€‚ æŠ½è±¡è¿­ä»£å™¨ç±»public interface Iterator { // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªå…ƒç´  public void first(); // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´  public void next(); // è¿­ä»£æ–¹æ³•ï¼šæ˜¯å¦ä¸ºæœ€åŽä¸€ä¸ªå…ƒç´  public boolean isDone(); // è¿­ä»£æ–¹æ³•ï¼šè¿”è¿˜å½“å‰å…ƒç´  public Object currentItem(); } èšé›†ç±»abstract public class Aggregate { // å·¥åŽ‚æ–¹æ³•ï¼šè¿”å›žè¿­ä»£å™¨å¯¹è±¡ public abstract Iterator createIterator(); } å…·ä½“èšé›†ç±»public class ConcreteAggregate extends Aggregate { private Object[] objs = {&quot;Monk Tang&quot;, &quot;Monkey&quot;, &quot;Pigsy&quot;, &quot;Sandy&quot;, &quot;Horse&quot;}; @Override public Iterator createIterator() { return new ConcreteIterator(); } private class ConcreteIterator implements Iterator { // ç´¢å¼•ä½ç½® private int index = 0; // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªå…ƒç´  @Override public void first() { index = 0; } // è¿­ä»£æ–¹æ³•ï¼šæ˜¯å¦ä¸ºæœ€åŽä¸€ä¸ªå…ƒç´  @Override public boolean isDone() { return (index == objs.length); } // è¿­ä»£æ–¹æ³•ï¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´  @Override public void next() { if(index &lt; objs.length) { index ++; } } // è¿­ä»£æ–¹æ³•ï¼šè¿”è¿˜å½“å‰å…ƒç´  @Override public Object currentItem() { return objs[index]; } } } å®¢æˆ·ç«¯ç±»public class Client { private Iterator it; private Aggregate agg = new ConcreteAggregate(); public void operation() { it = agg.createIterator(); while(!it.isDone()) { System.out.println(it.currentItem()); it.next(); } } public static void main(String[] args) { Client client = new Client(); client.operation(); } } è¿è¡Œç»“æžœï¼š Monk Tang Monkey Pigsy Sandy Horse]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è¿­ä»£å™¨æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼18ä¹‹ è§‚å¯Ÿè€…(Observer)æ¨¡å¼(è¡Œä¸ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F06%2F02%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F18%E4%B9%8B-%E8%A7%82%E5%AF%9F%E8%80%85-Observer-%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[è§‚å¯Ÿè€…æ¨¡å¼ç®€ä»‹ è§‚å¯Ÿè€…æ¨¡å¼æ˜¯å¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ï¼Œåˆå«å‘å¸ƒ-è®¢é˜…(Publish/Subscribe)æ¨¡å¼ã€æ¨¡åž‹-è§†å›¾(Model/View)æ¨¡å¼ã€æº-ç›‘å¬å™¨(Source/Listener)æ¨¡å¼æˆ–ä»Žå±žè€…(Dependents)æ¨¡å¼ã€‚ è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€ä¸Šå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚ ä¾‹å¦‚ï¼Œé©¬è·¯ä¸Šçš„äº¤é€šæŒ‡ç¤ºç¯ä¸ºçº¢ç¯äº®çš„è¯ï¼Œæ±½è½¦ä¼šåœæ­¢ï¼Œè¡Œäººå¯ä»¥é€šè¡Œã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œäº¤é€šæŒ‡ç¤ºç­‰å°±æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œè€Œè¡Œäººå’Œæ±½è½¦åˆ™æ˜¯è§‚å¯Ÿè€…ï¼Œä»–ä»¬ä¼šæ ¹æ®è§‚å¯Ÿåˆ°çš„äº¤é€šæŒ‡ç¤ºç¯çš„çŠ¶å†µä½œå‡ºç›¸åº”çš„è¡Œä¸ºã€‚ è§‚å¯Ÿè€…çš„UMLç±»å›¾å¦‚ä¸‹ï¼š è§‚å¯Ÿè€…æ¨¡å¼æ‰€æ¶‰åŠçš„è§’è‰²æœ‰ï¼šæŠ½è±¡ä¸»é¢˜(Subject)ï¼Œå…·ä½“ä¸»é¢˜(ConcreteSubject)ï¼ŒæŠ½è±¡è§‚å¯Ÿè€…(Observer)ï¼Œå…·ä½“è§‚å¯Ÿè€…(ConcreteObserver)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡ä¸»é¢˜ æŠ½è±¡ä¸»é¢˜è§’è‰²æŠŠæ‰€æœ‰å¯¹è§‚å¯Ÿè€…å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åœ¨ä¸€ä¸ªé›†åˆ(æ¯”å¦‚Vectorå¯¹è±¡)é‡Œï¼Œæ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»ä½•æ•°é‡çš„è§‚å¯Ÿè€…ã€‚æŠ½è±¡ä¸»é¢˜æä¾›ä¸€ä¸ªæŽ¥å£ï¼Œå¯ä»¥å¢žåŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ï¼ŒæŠ½è±¡ä¸»é¢˜è§’è‰²åˆå«åšæŠ½è±¡è¢«è§‚å¯Ÿè€…(Observable)è§’è‰²ï¼Œä¸€èˆ¬ç”¨ä¸€ä¸ªæŠ½è±¡ç±»æˆ–è€…ä¸€ä¸ªæŽ¥å£å®žçŽ°ã€‚ å…·ä½“ä¸»é¢˜ å°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ï¼›åœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚å…·ä½“ä¸»é¢˜è§’è‰²åˆå«åšå…·ä½“è¢«è§‚å¯Ÿè€…(Concrete Observable)è§’è‰²ã€‚å…·ä½“ä¸»é¢˜é€šå¸¸ç”¨ä¸€ä¸ªå…·ä½“å­ç±»å®žçŽ°ã€‚ æŠ½è±¡è§‚å¯Ÿè€… ä¸ºæ‰€æœ‰çš„å…·ä½“è§‚å¯Ÿè€…å®šä¹‰ä¸€ä¸ªæŽ¥å£ï¼Œåœ¨å¾—åˆ°ä¸»é¢˜çš„é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±ã€‚è¿™ä¸ªæŽ¥å£å«åšæ›´æ–°æŽ¥å£ã€‚æŠ½è±¡è§‚å¯Ÿè€…ä¸€èˆ¬ç”¨ä¸€ä¸ªæŠ½è±¡ç±»æˆ–è€…ä¸€ä¸ªæŽ¥å£å®žçŽ°ã€‚ å…·ä½“è§‚å¯Ÿè€… å­˜å‚¨ä¸Žä¸»é¢˜çš„çŠ¶æ€è‡ªæ°çš„çŠ¶æ€ã€‚å…·ä½“è§‚å¯Ÿè€…è§’è‰²å®žçŽ°æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²æ‰€è¦æ±‚çš„æ›´æ–°æŽ¥å£ï¼Œä»¥ä¾¿ä½¿æœ¬èº«çš„çŠ¶æ€ä¸Žä¸»é¢˜çš„çŠ¶æ€ç›¸åè°ƒã€‚å¦‚æžœéœ€è¦ï¼Œå…·ä½“è§‚å¯Ÿè€…è§’è‰²å¯ä»¥ä¿æŒä¸€ä¸ªæŒ‡å‘å…·ä½“ä¸»é¢˜å¯¹è±¡çš„å¼•ç”¨ã€‚å®ƒé€šå¸¸ç”¨ä¸€ä¸ªå…·ä½“å­ç±»å®žçŽ°ã€‚ ç¤ºæ„ä»£ç æŠ½è±¡ä¸»é¢˜ç±» import java.util.Vector; import java.util.Enumeration; abstract public class Subject { private Vector observersVector = new Vector(); // æ³¨å†Œè§‚å¯Ÿè€…å¯¹è±¡ public void attach(Observer observer) { observersVector.addElement(observer); } // æ³¨é”€è§‚å¯Ÿè€…å¯¹è±¡ public void detach(Observer observer) { observersVector.removeElement(observer); } // é€šçŸ¥æ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…å¯¹è±¡ public void notifyObservers() { Enumeration enu = observers(); while (enu.hasMoreElements()) { ((Observer)enu.nextElement()).update(); } } public Enumeration observers(){ return ((Vector)observersVector.clone()).elements(); } } å…·ä½“ä¸»é¢˜ç±» public class ConcreteSubject extends Subject{ private String state; // æ”¹å˜ä¸»é¢˜çš„æ–¹æ³•ã€‚ public void change(String newState){ state = newState; this.notifyObservers(); } } æŠ½è±¡è§‚å¯Ÿè€…ç±» public interface Observer { // é€šçŸ¥æŽ¥å£ public void update(); } å…·ä½“è§‚å¯Ÿè€…ç±» public class ConcreteObserver implements Observer { @Override public void update() { System.out.println(&quot;I am notified.&quot;); } } å®¢æˆ·ç«¯ç±» public class Client { private static ConcreteSubject subject; private static Observer observer; public static void main(String[] args) { // åˆ›å»ºä¸»é¢˜ subject = new ConcreteSubject(); // åˆ›å»ºè§‚å¯Ÿè€… observer = new ConcreteObserver(); // å°†è§‚å¯Ÿè€…æ³¨å†Œåˆ°&quot;ä¸»é¢˜&quot;ä¸Š subject.attach(observer); // æ”¹å˜ä¸»é¢˜å¯¹è±¡çš„çŠ¶æ€ subject.change(&quot;new state&quot;); } } è¿è¡Œç»“æžœï¼š I am notified. Javaä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼ Javaè¯­è¨€æœ¬èº«æ”¯æŒâ€è§‚å¯Ÿè€…æ¨¡å¼â€ï¼Œå®ƒæä¾›äº†ç›¸åº”çš„â€æŠ½è±¡ä¸»é¢˜ç±»(Observable)â€å’Œâ€æŠ½è±¡è§‚å¯Ÿè€…ç±»(Observer)â€ã€‚ Observableæ˜¯ä¸ªå®žä¾‹ç±»ã€‚å®ƒæä¾›å…¬å¼€çš„æ–¹æ³•æ”¯æŒè§‚å¯Ÿè€…å¯¹è±¡ï¼Œè¿™äº›æ–¹æ³•ä¸­æœ‰ä¸¤ä¸ªå¯¹Observableçš„å­ç±»éžå¸¸é‡è¦ï¼šä¸€ä¸ªæ˜¯setChanged()ï¼Œå¦ä¸€ä¸ªæ˜¯notifyObservers()ã€‚ç¬¬ä¸€æ–¹æ³•setChanged()è¢«è°ƒç”¨ä¹‹åŽä¼šè®¾ç½®ä¸€ä¸ªå†…éƒ¨æ ‡è®°å˜é‡ï¼Œä»£è¡¨è¢«è§‚å¯Ÿè€…å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ã€‚ç¬¬äºŒä¸ªæ˜¯notifyObservers()ï¼Œè¿™ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šè°ƒç”¨æ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å¯¹è±¡çš„update()æ–¹æ³•ï¼Œä½¿è¿™äº›è§‚å¯Ÿè€…å¯¹è±¡å¯ä»¥æ›´æ–°è‡ªå·±ã€‚ Observeræ˜¯ä¸€ä¸ªæŽ¥å£ã€‚å®ƒåªå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•ï¼Œå³update()æ–¹æ³•ï¼Œå½“è¢«è§‚å¯Ÿè€…å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¢«è§‚å¯Ÿè€…å¯¹è±¡çš„notifyObservers()æ–¹æ³•å°±ä¼šè°ƒç”¨è¿™ä¸€æ–¹æ³•ã€‚ ä¸‹é¢æ¼”ç¤ºJavaä¸­Observerå’ŒObservableçš„ç”¨æ³•ã€‚ ä»¥å…¬é¸¡æ‰“é¸£æ¥å»ºæ¨¡ï¼šå¤ªé˜³æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œå…¬é¸¡æ˜¯è§‚å¯Ÿè€…ï¼›å½“å…¬é¸¡è§‚å¯Ÿåˆ°å¤ªé˜³å‡èµ·çš„æ—¶å€™ï¼Œå°±æ‰“é¸£ã€‚ å¤ªé˜³å¤ªé˜³æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œå®ƒç»§æ‰¿äº†Observableã€‚ import java.util.Observable; public class Sun extends Observable { public void rise() { System.out.println(&quot;Sun rise.&quot;); // è®¾ç½®&quot;è¢«è§‚å¯Ÿè€…&quot;çš„çŠ¶æ€æ ‡è®°ï¼Œè¡¨ç¤ºå®ƒå‘ç”Ÿäº†å˜åŒ–ã€‚ this.setChanged(); // é€šçŸ¥&quot;è§‚å¯Ÿè€…&quot;è¯¥å˜åŒ–ã€‚ this.notifyObservers(); } } å…¬é¸¡å…¬é¸¡æ˜¯è§‚å¯Ÿè€…ï¼Œå®ƒå®žçŽ°äº†Observerå¯¹è±¡ã€‚ import java.util.Observer; import java.util.Observable; public class Cock implements Observer { private Sun sun; public Cock(Sun sun) { this.sun = sun; // å°†è§‚å¯Ÿè€…Cockæ³¨å†Œåˆ°&quot;è¢«è§‚å¯Ÿè€…sun&quot;ä¸Šã€‚ sun.addObserver(this); } // &quot;è¢«è§‚å¯Ÿè€…&quot;å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ&quot;è§‚å¯Ÿè€…&quot;å¯¹åº”çš„å“åº”æ–¹æ³•ã€‚ @Override public void update(Observable o, Object arg) { System.out.println(&quot;Cock gogoda,gogoda,gogoda...&quot;); } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºpublic class Client { private static Cock cock; private static Sun sun; public static void main(String[] args) { // æ–°å»º&quot;å¤ªé˜³&quot;(è¢«è§‚å¯Ÿè€…) sun = new Sun(); // æ–°å»º&quot;å…¬é¸¡&quot;(è§‚å¯Ÿè€…) cock = new Cock(sun); // å¤ªé˜³å‡èµ·ã€‚å…¬é¸¡è§‚å¯Ÿåˆ°å¤ªé˜³å‡çº§åŽï¼Œä¼šæ‰“é¸£ï¼ sun.rise(); } } è¿è¡Œç»“æžœï¼š Sun rise. Cock gogoda,gogoda,gogoda...]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è§‚å¯Ÿè€…æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼17ä¹‹ æ¨¡æ¿æ–¹æ³•(Template Method)æ¨¡å¼(è¡Œä¸ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F06%2F01%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F17%E4%B9%8B-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95-Template-Method-%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[æ¨¡æ¿æ¨¡å¼ç®€ä»‹ æ¨¡æ¿æ–¹æ³•(Template Method)æ¨¡å¼æ˜¯ç±»çš„è¡Œä¸ºæ¨¡å¼ã€‚å‡†å¤‡ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå°†éƒ¨åˆ†é€»è¾‘ä»¥å…·ä½“æ–¹æ³•ä»¥åŠå…·ä½“æž„é€ å‡½æ•°çš„å½¢å¼å®žçŽ°ï¼Œç„¶åŽå£°æ˜Žä¸€äº›æŠ½è±¡æ–¹æ³•æ¥è¿«ä½¿å­ç±»å®žçŽ°å‰©ä½™çš„é€»è¾‘ã€‚ä¸åŒçš„å­ç±»å¯ä»¥ä»¥ä¸åŒçš„æ–¹å¼å®žçŽ°è¿™äº›æŠ½è±¡æ–¹æ³•ï¼Œä»Žè€Œå¯¹å‰©ä½™çš„é€»è¾‘æœ‰ä¸åŒçš„å®žçŽ°ã€‚è¿™å°±æ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç”¨æ„ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯æ‰€æœ‰æ¨¡å¼ä¸­æœ€ä¸ºå¸¸è§çš„å‡ ä¸ªæ¨¡å¼ä¹‹ä¸€ï¼Œè€Œä¸”å¾ˆå¯èƒ½æˆ‘ä»¬è‡ªå·±ä½¿ç”¨è¿‡æ¨¡æ¿æ–¹æ³•æ¨¡å¼è€Œæ²¡æœ‰æ„è¯†åˆ°è‡ªå·±å·²ç»ä½¿ç”¨äº†è¿™ä¸ªæ¨¡å¼ã€‚æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯åŸºäºŽç»§æ‰¿çš„ä»£ç å¤ç”¨çš„åŸºæœ¬æŠ€æœ¯ã€‚ Javaçš„é›†åˆå°±æ˜¯ä¸€ä¸ªå…¸åž‹çš„ï¼Œåˆ©ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ä¾‹å­ã€‚Javaé›†åˆä¸­çš„Collectioné›†åˆåŒ…æ‹¬Listå’ŒSetä¸¤å¤§ç»„æˆéƒ¨åˆ†ã€‚Listæ˜¯é˜Ÿåˆ—ï¼Œè€ŒSetæ˜¯æ²¡æœ‰é‡å¤å…ƒç´ çš„é›†åˆã€‚å®ƒä»¬å…±åŒçš„æŽ¥å£éƒ½åœ¨CollectionæŽ¥å£å£°æ˜Žï¼›ä¾‹å¦‚ï¼Œéƒ½åŒ…å«äº†size()ï¼ŒisEmpty()æ–¹æ³•ã€‚è€ŒAbstractCollectionè¿™ä¸ªæŠ½è±¡ç±»åˆ™å®žçŽ°äº†å®ƒä»¬å…±åŒçš„æ–¹æ³•ï¼Œå…¶ä½™æœªå®žçŽ°çš„æ–¹æ³•å®šä¹‰ä¸ºæŠ½è±¡æ–¹æ³•ã€‚Listå’ŒSetçš„å®žä¾‹ç±»ï¼Œå°±æ˜¯é€šè¿‡ç»§æ‰¿AbstractCollection(æˆ–å®ƒçš„å­ç±»)ï¼ŒçœåŽ»äº†è®¸å¤šé‡å¤æ€§ç¼–ç çš„å·¥ä½œï¼ æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„UMLç±»å›¾ï¼š è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªè§’è‰²ï¼šæŠ½è±¡æ¨¡æ¿(Abstract Template)ï¼Œå…·ä½“æ¨¡æ¿(Concrete Template)ã€‚ æŠ½è±¡æ¨¡æ¿æœ‰å¦‚ä¸‹è´£ä»»ï¼šâ€¢ å®šä¹‰äº†ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ“ä½œï¼Œä»¥ä¾¿è®©å­ç±»å®žçŽ°ã€‚è¿™äº›æŠ½è±¡æ“ä½œå«åšåŸºæœ¬æ“ä½œï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚â€¢ å®šä¹‰å¹¶å®žçŽ°äº†ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ã€‚è¿™ä¸ªæ¨¡æ¿æ–¹æ³•ä¸€èˆ¬æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ƒç»™å‡ºäº†ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„éª¨æž¶ï¼Œè€Œé€»è¾‘çš„ç»„æˆæ­¥éª¤åœ¨ç›¸åº”çš„æŠ½è±¡æ“ä½œä¸­ï¼ŒæŽ¨è¿Ÿåˆ°å­ç±»å®žçŽ°ã€‚é¡¶çº§é€»è¾‘ä¹Ÿæœ‰å¯èƒ½è°ƒç”¨ä¸€äº›å…·ä½“æ–¹æ³•ã€‚ å…·ä½“æ¨¡æ¿æœ‰å¦‚ä¸‹è´£ä»»ï¼šâ€¢ å®žçŽ°çˆ¶ç±»æ‰€å®šä¹‰çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚â€¢ æ¯ä¸€ä¸ªæŠ½è±¡æ¨¡æ¿è§’è‰²éƒ½å¯ä»¥æœ‰ä»»æ„å¤šä¸ªå…·ä½“æ¨¡æ¿è§’è‰²ä¸Žä¹‹å¯¹åº”ï¼Œè€Œæ¯ä¸€ä¸ªå…·ä½“æ¨¡æ¿è§’è‰²éƒ½å¯ä»¥ç»™å‡ºè¿™äº›æŠ½è±¡æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯é¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ï¼‰çš„ä¸åŒå®žçŽ°ï¼Œä»Žè€Œä½¿å¾—é¡¶çº§é€»è¾‘çš„å®žçŽ°å„ä¸ç›¸åŒã€‚ ç¤ºæ„ä»£ç  abstract public class AbstractClass { // æ¨¡æ¿æ–¹æ³• public void templateMethod(){ hookMethod(); //è°ƒç”¨åŸºæœ¬æ–¹æ³•(ç”±å­ç±»å®žçŽ°) abstractMethod(); //è°ƒç”¨åŸºæœ¬æ–¹æ³•(ç”±å­ç±»å®žçŽ°) concreteMethod(); //è°ƒç”¨åŸºæœ¬æ–¹æ³•(å·²ç»å®žçŽ°) } // åŸºæœ¬æ–¹æ³•çš„å£°æ˜Žï¼ˆç”±å­ç±»å®žçŽ°ï¼Œä½†æŠ½è±¡æ¨¡æ¿ç»™å‡ºäº†é»˜è®¤å®žçŽ°ï¼‰ public void hookMethod() {} // åŸºæœ¬æ–¹æ³•çš„å£°æ˜Žï¼ˆç”±å­ç±»å®žçŽ°ï¼‰ public abstract void abstractMethod(); // åŸºæœ¬æ–¹æ³•ï¼ˆå·²ç»å®žçŽ°ï¼‰ public final void concreteMethod(){ // do something } } public class ConcreteClass extends AbstractClass { // åŸºæœ¬æ–¹æ³•çš„å®žçŽ° @Override public void hookMethod() { // do something } // åŸºæœ¬æ–¹æ³•çš„å®žçŽ° @Override public void abstractMethod() { // do something } } æŠ½è±¡æ¨¡æ¿è§’è‰²AbstractTemplateæä¾›äº†ä¸¤ä¸ªå…·ä½“æ–¹æ³•templateMethod()å’ŒconcreteMethod()ï¼›å£°æ˜Žäº†2ä¸ªæŠ½è±¡æ–¹æ³•hookMethod()å’ŒabstractMethod()ã€‚ å…·ä½“æ¨¡æ¿è§’è‰²ConcreteTemplateå®žçŽ°äº†çˆ¶ç±»å£°æ˜Žçš„åŸºæœ¬æ–¹æ³•hookMethod()å’ŒabstractMethod()ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³• æ¨¡æ¿æ–¹æ³•ä¸­çš„æ–¹æ³•å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ¨¡æ¿æ–¹æ³• å’Œ åŸºæœ¬æ–¹æ³•ã€‚ æ¨¡æ¿æ–¹æ³• ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ˜¯å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­çš„ï¼ŒæŠŠåŸºæœ¬æ“ä½œæ–¹æ³•ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ€»ç®—æ³•æˆ–ä¸€ä¸ªæ€»è¡Œä¸ºçš„æ–¹æ³•ã€‚ä¸€ä¸ªæŠ½è±¡ç±»å¯ä»¥æœ‰ä»»æ„å¤šä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œè€Œä¸é™äºŽä¸€ä¸ªã€‚æ¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•éƒ½å¯ä»¥è°ƒç”¨ä»»æ„å¤šä¸ªå…·ä½“æ–¹æ³•ã€‚ åŸºæœ¬æ–¹æ³• åŸºæœ¬æ–¹æ³•åˆå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼šæŠ½è±¡æ–¹æ³•(Abstract Method)ã€å…·ä½“æ–¹æ³•(Concrete Method)å’Œé’©å­æ–¹æ³•(Hook Method)ã€‚â€¢ æŠ½è±¡æ–¹æ³•: ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜Žï¼Œç”±å…·ä½“å­ç±»å®žçŽ°ã€‚åœ¨Javaè¯­è¨€é‡ŒæŠ½è±¡æ–¹æ³•ä»¥abstractå…³é”®å­—æ ‡ç¤ºã€‚â€¢ å…·ä½“æ–¹æ³•: ä¸€ä¸ªå…·ä½“æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜Žå¹¶å®žçŽ°ï¼Œè€Œå­ç±»å¹¶ä¸å®žçŽ°æˆ–ç½®æ¢ã€‚â€¢ é’©å­æ–¹æ³•: ä¸€ä¸ªé’©å­æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜Žå¹¶å®žçŽ°ï¼Œè€Œå­ç±»ä¼šåŠ ä»¥æ‰©å±•ã€‚é€šå¸¸æŠ½è±¡ç±»ç»™å‡ºçš„å®žçŽ°æ˜¯ä¸€ä¸ªç©ºå®žçŽ°ï¼Œä½œä¸ºæ–¹æ³•çš„é»˜è®¤å®žçŽ°ã€‚ åœ¨å‰é¢çš„UMLç¤ºä¾‹ä¸­ï¼ŒAbstractClassæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå¸¦æœ‰ä¸‰ä¸ªæ–¹æ³•ã€‚å…¶ä¸­abstractMethod()æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜Žä¸ºæŠ½è±¡æ–¹æ³•ï¼Œå¹¶ç”±å­ç±»å®žçŽ°ï¼›hookMethod()æ˜¯ä¸€ä¸ªé’©å­æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜Žå¹¶æä¾›é»˜è®¤å®žçŽ°ï¼Œå¹¶ä¸”ç”±å­ç±»ç½®æ¢æŽ‰ã€‚concreteMethod()æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜Žå¹¶å®žçŽ°ã€‚ æç¤ºï¼šé’©å­æ–¹æ³•çš„åå­—åº”å½“ä»¥doå¼€å§‹ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç¤ºä¾‹ è€ƒè™‘ä¸€ä¸ªè®¡ç®—å­˜æ¬¾åˆ©æ¯çš„ä¾‹å­ã€‚å‡è®¾ç³»ç»Ÿéœ€è¦æ”¯æŒä¸¤ç§å­˜æ¬¾è´¦å·ï¼Œå³è´§å¸å¸‚åœº(Money Market)è´¦å·å’Œå®šæœŸå­˜æ¬¾(Certificate of Deposite)è´¦å·ã€‚è¿™ä¸¤ç§è´¦å·çš„å­˜æ¬¾åˆ©æ¯æ˜¯ä¸åŒçš„ï¼Œå› æ­¤ï¼Œåœ¨è®¡ç®—ä¸€ä¸ªå­˜æˆ·çš„å­˜æ¬¾åˆ©æ¯é¢æ—¶ï¼Œå¿…é¡»åŒºåˆ†ä¸¤ç§ä¸åŒçš„è´¦å·ç±»åž‹ã€‚ è¿™ä¸ªç³»ç»Ÿçš„æ€»è¡Œä¸ºåº”å½“æ˜¯è®¡ç®—å‡ºåˆ©æ¯ï¼Œè¿™ä¹Ÿå°±å†³å®šäº†ä½œä¸ºä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é¡¶çº§é€»è¾‘åº”å½“æ˜¯åˆ©æ¯è®¡ç®—ã€‚ç”±äºŽåˆ©æ¯è®¡ç®—æ¶‰åŠåˆ°ä¸¤ä¸ªæ­¥éª¤ï¼šä¸€ä¸ªåŸºæœ¬æ–¹æ³•ç»™å‡ºè´¦å·ç§ç±»ï¼Œå¦ä¸€ä¸ªåŸºæœ¬æ–¹æ³•ç»™å‡ºåˆ©æ¯ç™¾åˆ†æ¯”ã€‚è¿™ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•æž„æˆå…·ä½“é€»è¾‘ï¼Œå› ä¸ºè´¦å·çš„ç±»åž‹ä¸åŒï¼Œæ‰€ä»¥å…·ä½“é€»è¾‘ä¼šæœ‰æ‰€ä¸åŒã€‚ æ˜¾ç„¶ï¼Œç³»ç»Ÿéœ€è¦ä¸€ä¸ªæŠ½è±¡è§’è‰²ç»™å‡ºé¡¶çº§è¡Œä¸ºçš„å®žçŽ°ï¼Œè€Œå°†ä¸¤ä¸ªä½œä¸ºç»†èŠ‚æ­¥éª¤çš„åŸºæœ¬æ–¹æ³•ç•™ç»™å…·ä½“å­ç±»å®žçŽ°ã€‚ç”±äºŽéœ€è¦è€ƒè™‘çš„è´¦å·æœ‰ä¸¤ç§ï¼šä¸€æ˜¯è´§å¸å¸‚åœºè´¦å·ï¼ŒäºŒæ˜¯å®šæœŸå­˜æ¬¾è´¦å·ã€‚ç³»ç»Ÿçš„UMLç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æŠ½è±¡æ¨¡æ¿ç±»abstract public class Account { protected String accountNumber; public Account() { accountNumber = null; } public Account(String accountNumber) { this.accountNumber = accountNumber; } // æ¨¡æ¿æ–¹æ³•ï¼Œè®¡ç®—åˆ©æ¯æ•°é¢ public final double calculateInterest(){ double interestRate = doCalculateInterestRate(); String accountType = doCalculateAccountType(); double amount = calculateAmount(accountType, accountNumber); return amount * interestRate; } // åŸºæœ¬æ–¹æ³•ç•™ç»™å­ç±»å®žçŽ° protected abstract String doCalculateAccountType(); // åŸºæœ¬æ–¹æ³•ç•™ç»™å­ç±»å®žçŽ° protected abstract double doCalculateInterestRate(); // åŸºæœ¬æ–¹æ³•ï¼Œå·²ç»å®žçŽ° private double calculateAmount(String accountType, String accountNumber){ // retrive amount from database return 7243.00D; } } å…·ä½“æ¨¡æ¿ç±»MoneyMarketAccount public class MoneyMarketAccount extends Account { @Override protected String doCalculateAccountType() { return &quot;Money Market&quot;; } @Override protected double doCalculateInterestRate() { return 0.045D; } } CDAccount public class CDAccount extends Account { @Override protected String doCalculateAccountType() { return &quot;Certificate of Deposite&quot;; } @Override protected double doCalculateInterestRate() { return 0.065D; } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºpublic class Client { private static Account acct = null; public static void main(String[] args) { acct = new MoneyMarketAccount(); System.out.println(&quot;Interest from Money Market account: &quot; + acct.calculateInterest()); acct = new CDAccount(); System.out.println(&quot;Interest from CD account: &quot; + acct.calculateInterest()); } } è¿è¡Œç»“æžœï¼š Interest from Money Market account: 325.935 Interest from CD account: 470.795 ç»“æžœè¯´æ˜Žï¼šAccountæ˜¯æŠ½è±¡æ¨¡æ¿ç±»ï¼ŒcalculateInterest()æ˜¯æ¨¡æ¿æ–¹æ³•ã€‚ä¸ç®¡æ˜¯â€è´§å¸å¸‚åœºå¸å·â€æˆ–è€…â€å®šæœŸå­˜æ¬¾â€ï¼Œå®ƒä»¬çš„åˆ©æ¯è®¡ç®—æ–¹å¼éƒ½æ˜¯é€šè¿‡æŠ½è±¡æ¨¡æ¿ç±»çš„calculateInterest()æ¥è®¡ç®—çš„ï¼›åªä¸è¿‡æ¶‰åŠåˆ°çš„æœ¬é‡‘å’Œåˆ©çŽ‡ä¸åŒè€Œå·²ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼16ä¹‹ ç­–ç•¥(Strategy)æ¨¡å¼(è¡Œä¸ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F29%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F16%E4%B9%8B-%E7%AD%96%E7%95%A5-Strategy-%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ç­–ç•¥æ¨¡å¼ç®€ä»‹ç­–ç•¥(Strategy)æ¨¡å¼å±žäºŽå¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ã€‚å…¶ç”¨æ„æ˜¯é’ˆå¯¹ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…åˆ°å…·æœ‰å…±åŒæŽ¥å£çš„ç‹¬ç«‹çš„ç±»ä¸­ï¼Œä»Žè€Œä½¿å¾—å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ä»¥åœ¨ä¸å½±å“åˆ°å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹å‘ç”Ÿå˜åŒ–ã€‚ UMLç±»å›¾ è¿™ä¸ªæ¨¡å¼æ¶‰åŠåˆ°ä¸‰ä¸ªè§’è‰²ï¼šçŽ¯å¢ƒ(Context)ï¼ŒæŠ½è±¡ç­–ç•¥(Strategy)ï¼Œå…·ä½“ç­–ç•¥(ConcreteStrategy)ã€‚ è§’è‰² è¯´æ˜Ž çŽ¯å¢ƒ æŒæœ‰ä¸€ä¸ªStrategyçš„å¼•ç”¨ã€‚ æŠ½è±¡ç­–ç•¥ è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œé€šå¸¸ç”±ä¸€ä¸ªæŽ¥å£æˆ–æŠ½è±¡ç±»å®žçŽ°ã€‚æ­¤è§’è‰²ç»™å‡ºæ‰€æœ‰çš„å…·ä½“ç­–ç•¥ç±»æ‰€éœ€çš„æŽ¥å£ã€‚ å…·ä½“ç­–ç•¥ åŒ…è£…äº†ç›¸å…³çš„ç®—æ³•æˆ–è¡Œä¸ºã€‚ ç¤ºæ„ä»£ç  public class Context { // ç­–ç•¥å¯¹è±¡ private Strategy strategy; // æž„é€ å‡½æ•° public Context(Strategy strategy){ this.strategy = strategy; } // ç­–ç•¥æ–¹æ³• public void contextInterface(){ strategy.strategyInterface(); } } abstract public class Strategy { // ç­–ç•¥æ–¹æ³• public abstract void strategyInterface(); } public class ConcreteStrategy extends Strategy { @Override public void strategyInterface() { // write your algorithm code here } } ç­–ç•¥æ¨¡å¼ç¤ºä¾‹å‡è®¾çŽ°åœ¨è¦è®¾è®¡ä¸€ä¸ªè´©å–å„ç±»ä¹¦ç±çš„ç”µå­å•†åŠ¡çš„è´­ç‰©è½¦ç³»ç»Ÿã€‚ä¸‹é¢æ˜¯å›¾ä¹¦çš„ä¸‰ç§æŠ˜æ‰£ç®—æ³•ã€‚ ç®—æ³•ä¸€ï¼šå¯¹å›¾ä¹¦æ²¡æœ‰æŠ˜æ‰£ã€‚ç®—æ³•äºŒï¼šå¯¹å›¾ä¹¦æä¾›ä¸€ä¸ªå›ºå®šå€¼ä¸º5å…ƒçš„æŠ˜æ‰£ã€‚ç®—æ³•ä¸‰ï¼šå¯¹å›¾ä¹¦æä¾›ä¸€ä¸ªå…«æŠ˜çš„æŠ˜æ‰£ã€‚ ä½¿ç”¨ç­–ç•¥æ¨¡å¼æè¿°çš„è¯ï¼Œè¿™äº›ä¸åŒçš„ç®—æ³•éƒ½æ˜¯ä¸åŒçš„å…·ä½“ç­–ç•¥è§’è‰²ï¼šç”¨ä¸€ä¸ªNoDiscountStrategyå¯¹è±¡æè¿°â€ç®—æ³•ä¸€â€ï¼›ç”¨ä¸€ä¸ªFlatRateStrategyå¯¹è±¡æè¿°â€ç®—æ³•äºŒâ€ï¼›ç”¨ä¸€ä¸ªPercentageStrageå¯¹è±¡æè¿°â€ç®—æ³•ä¸‰â€ã€‚ æŠ½è±¡ç­–ç•¥abstract public class DiscountStrategy { // ä»·æ ¼ protected int price = 0; // ç­–ç•¥ protected int copies = 0; public abstract int calculateDiscount(); public DiscountStrategy(int price, int copies) { this.price = price; this.copies = copies; } } å…·ä½“ç­–ç•¥ç®—æ³•ä¸€(æ— æŠ˜æ‰£) public class NoDiscountStrategy extends DiscountStrategy { public NoDiscountStrategy(int price, int copies) { super(price, copies); } public int calculateDiscount() { return copies*price; } } ç®—æ³•äºŒ(ä¼˜æƒ 5å…ƒ) public class FlatRateStrategy extends DiscountStrategy { private int discard = 5; public FlatRateStrategy(int price, int copies) { super(price, copies); } public void setDiscard() { this.discard = discard; } public int getDiscard() { return discard; } public int calculateDiscount() { return copies*(price - discard); } } ç®—æ³•ä¸‰(æ‰“8æŠ˜) public class PercentageStrategy extends DiscountStrategy { // æŠ˜æ‰£æ¯”ä¾‹ private float percent = 0.8f; public PercentageStrategy(int price, int copies) { super(price, copies); } public void setPercent() { this.percent = percent; } public float getPercent() { return percent; } public int calculateDiscount() { return (int)(copies*price*percent); } } å®¢æˆ·ç«¯public class Client { public static void main(String[] args) { // ç¬¬ä¸€ç§ç­–ç•¥ DiscountStrategy strategy = new NoDiscountStrategy(60, 5); System.out.println(&quot;total(60,5)=&quot;+strategy.calculateDiscount()); strategy = new FlatRateStrategy(80, 5); System.out.println(&quot;total(80,5)=&quot;+strategy.calculateDiscount()); strategy = new PercentageStrategy(100, 3); System.out.println(&quot;total(100,4)=&quot;+strategy.calculateDiscount()); } } è¿è¡Œç»“æžœï¼š total(60,5)=300 total(80,5)=375 total(100,4)=240]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ç­–ç•¥æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼15ä¹‹ ä¸å˜(Immutable)æ¨¡å¼(è¡Œä¸ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F28%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F15%E4%B9%8B-%E4%B8%8D%E5%8F%98-Immutable-%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ä¸å˜æ¨¡å¼ç®€ä»‹ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€åœ¨å¯¹è±¡è¢«åˆ›å»ºä¹‹åŽå°±ä¸å†å˜åŒ–ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ä¸å˜(Immutable)æ¨¡å¼ã€‚ ä¸å˜æ¨¡å¼çš„ç»“æž„ ä¸å˜æ¨¡å¼å¯å¢žå¼ºå¯¹è±¡çš„å¼ºå£®åž‹(robustness)ã€‚ä¸å˜æ¨¡å¼å…è®¸å¤šä¸ªå¯¹è±¡å…±äº«æŸä¸€ä¸ªå¯¹è±¡ï¼Œé™ä½Žäº†å¯¹è¯¥å¯¹è±¡è¿›è¡Œå¹¶å‘è®¿é—®æ—¶çš„åŒæ­¥åŒ–å¼€é”€ã€‚å¦‚æžœéœ€è¦ä¿®æ”¹ä¸€ä¸ªä¸å˜å¯¹è±¡çš„çŠ¶æ€ï¼Œé‚£ä¹ˆå°±éœ€è¦å»ºç«‹ä¸€ä¸ªæ–°çš„åŒç±»åž‹å¯¹è±¡ï¼Œå¹¶åœ¨åˆ›å»ºæ—¶å°†è¿™ä¸ªæ–°çš„çŠ¶æ€å­˜å‚¨åœ¨æ–°å¯¹è±¡é‡Œã€‚ ä¸å˜æ¨¡å¼åªæ¶‰åŠåˆ°ä¸€ä¸ªç±»ã€‚ä¸€ä¸ªç±»çš„å†…éƒ¨çŠ¶æ€åˆ›å»ºåŽï¼Œåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸéƒ½ä¸ä¼šå‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™æ ·çš„ç±»ç§°ä½œä¸å˜ç±»ã€‚è¿™ç§ä½¿ç”¨ä¸å˜ç±»çš„åšæ³•å«åšä¸å˜æ¨¡å¼ã€‚ä¸å˜æ¨¡å¼æœ‰ä¸¤ç§å½¢å¼ï¼šä¸€ç§æ˜¯å¼±ä¸å˜æ¨¡å¼ï¼Œå¦ä¸€ç§æ˜¯å¼ºä¸å˜æ¨¡å¼ã€‚ å¼±ä¸å˜æ¨¡å¼ ä¸€ä¸ªç±»çš„å®žä¾‹çš„çŠ¶æ€æ˜¯ä¸å¯æ”¹å˜çš„ï¼›ä½†æ˜¯è¿™ä¸ªç±»çš„å­ç±»çš„å®žä¾‹å…·æœ‰å¯èƒ½ä¼šå˜åŒ–çš„çŠ¶æ€ã€‚è¿™æ ·çš„ç±»ç¬¦åˆå¼±ä¸å˜æ¨¡å¼çš„å®šä¹‰ã€‚è¦å®žçŽ°å¼±ä¸å˜æ¨¡å¼ï¼Œä¸€ä¸ªç±»å¿…é¡»æ»¡è¶³ä¸‹é¢æ¡ä»¶ï¼š (01) æ‰€è€ƒè™‘çš„å¯¹è±¡æ²¡æœ‰ä»»ä½•æ–¹æ³•ä¼šä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€ï¼›è¿™æ ·ä¸€æ¥ï¼Œå½“å¯¹è±¡çš„æž„é€ å‡½æ•°å°†å¯¹è±¡çš„çŠ¶æ€åˆå§‹åŒ–ä¹‹åŽï¼Œå¯¹è±¡çš„çŠ¶æ€ä¾¿ä¸å†æ”¹å˜ã€‚(02) æ‰€æœ‰å±žæ€§éƒ½åº”å½“æ˜¯ç§æœ‰çš„ã€‚ä¸è¦å£°æ˜Žä»»ä½•çš„å…¬å¼€çš„å±žæ€§ï¼Œä»¥é˜²å®¢æˆ·ç«¯å¯¹è±¡ç›´æŽ¥ä¿®æ”¹ä»»ä½•çš„å†…éƒ¨çŠ¶æ€ã€‚(03) è¿™ä¸ªå¯¹è±¡æ‰€å¼•ç”¨åˆ°çš„å…¶ä»–å¯¹è±¡å¦‚ä½•æ˜¯å¯å˜å¯¹è±¡çš„è¯ï¼Œå¿…é¡»è®¾æ³•é™åˆ¶å¤–ç•Œå¯¹è¿™äº›å¯å˜å¯¹è±¡çš„è®¿é—®ï¼Œä»¥é˜²æ­¢å¤–ç•Œä¿®æ”¹è¿™äº›å¯¹è±¡ã€‚å¦‚ä½•å¯èƒ½ï¼Œåº”å½“å°½é‡åœ¨ä¸å˜å¯¹è±¡å†…éƒ¨åˆå§‹åŒ–è¿™äº›è¢«å¼•ç”¨çš„å¯¹è±¡ï¼Œè€Œä¸è¦åœ¨å®¢æˆ·ç«¯åˆå§‹åŒ–ï¼Œç„¶åŽå†ä¼ å…¥åˆ°ä¸å˜å¯¹è±¡å†…éƒ¨æ¥ã€‚å¦‚æžœæŸä¸ªå¯å˜å¯¹è±¡å¿…é¡»åœ¨å®¢æˆ·ç«¯åˆå§‹åŒ–ï¼Œç„¶åŽå†ä¼ å…¥åˆ°ä¸å˜å¯¹è±¡é‡Œçš„è¯ï¼Œå°±åº”å½“è€ƒè™‘åœ¨ä¸å˜å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªå¯å˜å¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œè€Œä¸è¦ä½¿ç”¨åŽŸæ¥çš„æ‹·è´ã€‚ å¼±ä¸å˜æ¨¡å¼çš„ç¼ºç‚¹æ˜¯ï¼šç¬¬ä¸€, ä¸€ä¸ªå¼±ä¸å˜å¯¹è±¡çš„å­å¯¹è±¡å¯ä»¥æ˜¯å¯å˜å¯¹è±¡ï¼›æ¢è¨€ä¹‹ï¼Œä¸€ä¸ªå¼±ä¸å˜å¯¹è±¡çš„å­å¯¹è±¡å¯èƒ½æ˜¯å¯å˜çš„ã€‚ç¬¬äºŒ, è¿™ä¸ªå¯å˜çš„å­å¯¹è±¡å¯èƒ½å¯ä»¥ä¿®æ”¹çˆ¶å¯¹è±¡çš„çŠ¶æ€ï¼Œä»Žè€Œå¯èƒ½ä¼šå…è®¸å¤–ç•Œä¿®æ”¹çˆ¶å¯¹è±¡çš„çŠ¶æ€ã€‚ å¼ºä¸å˜æ¨¡å¼ ä¸€ä¸ªç±»çš„å®žä¾‹ä¸ä¼šæ”¹å˜ï¼ŒåŒæ—¶å®ƒçš„å­ç±»çš„å®žä¾‹ä¹Ÿå…·æœ‰ä¸å¯å˜åŒ–çš„çŠ¶æ€ã€‚è¿™æ ·çš„ç±»ç¬¦åˆå¼ºä¸å˜æ¨¡å¼ã€‚è¦å®žçŽ°å¼ºä¸å˜æ¨¡å¼ï¼Œä¸€ä¸ªç±»å¿…é¡»é¦–å…ˆæ»¡è¶³å¼±ä¸å˜æ¨¡å¼æ‰€è¦æ±‚çš„æ‰€æœ‰æ¡ä»¶ï¼Œå¹¶ä¸”è¿˜æœ‰æ»¡è¶³ä¸‹é¢æ¡ä»¶ä¹‹ä¸€ï¼š(01) æ‰€è€ƒè™‘çš„ç±»æ‰€æœ‰çš„æ–¹æ³•éƒ½åº”å½“æ˜¯finalï¼Œè¿™æ ·è¿™ä¸ªç±»çš„å­ç±»ä¸èƒ½å¤Ÿç½®æ¢æŽ‰æ­¤ç±»çš„æ–¹æ³•ã€‚(02) è¿™ä¸ªç±»æœ¬èº«å°±æ˜¯finalçš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±ä¸å¯èƒ½ä¼šæœ‰å­ç±»ï¼Œä»Žè€Œä¹Ÿå°±ä¸å¯èƒ½æœ‰è¢«å­ç±»ä¿®æ”¹çš„é—®é¢˜ã€‚ ä¸å˜æ¨¡å¼ç¤ºä¾‹é€šè¿‡ä»¥ä¸‹å‡ ä¸ªç¤ºä¾‹æ¥çœ‹çœ‹â€å¼±ä¸å˜æ¨¡å¼â€å’Œâ€å¼ºä¸å˜æ¨¡å¼â€ã€‚ å¯å˜æ¨¡å¼class Person { private String name; private int age; public Person(String name, int age) { this.name = name; this.age = age; } public void setName(String name) { this.name = name; } public String getName() { return name; } public void setAge(int age) { this.age = age; } public int getAge() { return age; } public String toString() { return &quot;name:&quot;+name+&quot;, age:&quot;+age; } } // Complexä¸æ˜¯&quot;å¼±ä¸å˜ç±»&quot;ã€‚ // å› ä¸ºå®ƒåŒ…å«äº†å¯å˜ç±»å¯¹è±¡personï¼Œå¹¶ä¸”personæ˜¯åœ¨å¤–éƒ¨åˆå§‹åŒ–çš„ã€‚ class Complex { private Person person; private int id; public Complex (Person person, int id) { this.person = person; this.id = id; } public int getId() { return id; } public Person getPerson() { return person; } public String toString() { return &quot;id:&quot;+id+&quot;, person(&quot;+person+&quot;)&quot;; } } public class MutableDemo { public static void main(String[] args) { // æ–°å»ºComplexå¯¹è±¡ï¼Œåœ¨&quot;å¤–éƒ¨(å³ï¼ŒéžComplexå†…éƒ¨)&quot;åˆå§‹åŒ–personã€‚ Person person = new Person(&quot;å¼ ä¸‰&quot;, 18); Complex com = new Complex(person, 1); System.out.println(com); // ä¿®æ”¹personçš„åå­—ä¸º&quot;æŽå››&quot;ï¼Œå¹´é¾„ä¸º20 person.setName(&quot;æŽå››&quot;); person.setAge(20); System.out.println(com); } } è¿è¡Œç»“æžœï¼š id:1, person(name:å¼ ä¸‰, age:18) id:1, person(name:æŽå››, age:20) ç»“æžœè¯´æ˜Žï¼šMutableDemoä¸­çš„Complexç±»æ»¡è¶³â€å¼±ä¸å˜æ¨¡å¼â€çš„å‰2ä¸ªæ¡ä»¶ï¼š(01) Complexä¸­æ²¡æœ‰æ–¹æ³•å¯ä»¥ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€ã€‚ComplexåŒ…å«äº†personå’Œidä¸¤ä¸ªå±žæ€§å€¼ï¼Œä½†æ˜¯æ²¡æœ‰æ–¹æ³•ä¿®æ”¹è¿™ä¸¤ä¸ªæ ‘å½¢ã€‚(02) Complexä¸­çš„personå’Œidå±žæ€§éƒ½æ˜¯ç§æœ‰çš„ã€‚ ä½†æ˜¯ï¼ŒComplexä¸æ»¡è¶³â€è‹¥ä¸å˜æ¨¡å¼â€çš„ç¬¬3ä¸ªæ¡ä»¶ã€‚Complexå¼•ç”¨äº†â€å¯å˜ç±»å¯¹è±¡personâ€ï¼Œpersonæ˜¯Personç±»çš„å¯¹è±¡ï¼Œè€ŒPersonæ˜¯ä¸€ä¸ªå¯å˜ç±»ï¼ æ‰€ä»¥ï¼Œåœ¨MutableDemoä¸­ï¼Œæˆ‘ä»¬åˆå§‹åŒ–äº†Complexçš„personå€¼ä¸º(â€œå¼ ä¸‰â€,18)ä¹‹åŽï¼›åœ¨åŽé¢ä¿®æ”¹äº†personçš„åå­—ä¸ºâ€æŽå››â€,å¹´é¾„ä¸º18ã€‚Complexä¸­çš„personçš„å€¼ä¹Ÿä¼šç›¸åº”çš„æ”¹å˜ï¼æ‰€ä»¥ï¼ŒComplexæ˜¯â€å¯å˜ç±»â€ã€‚ è‹¥æƒ³å°†Complexä¿®æ”¹ä¸ºâ€ä¸å˜ç±»â€ï¼Œéœ€è¦å°†Complexä¿®æ”¹çš„æ»¡è¶³â€è‹¥ä¸å˜æ¨¡å¼â€çš„ç¬¬3ä¸ªæ¡ä»¶ã€‚æ–¹æ³•æ˜¯ï¼Œåœ¨Complexä¸­åˆå§‹åŒ–personçš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ªpersonçš„æ‹·è´å³å¯ã€‚è¯¦ç»†ä»£ç è¯·çœ‹â€2. å¼±ä¸å˜æ¨¡å¼â€ã€‚ å¼±ä¸å˜æ¨¡å¼class Person { private String name; private int age; public Person(String name, int age) { this.name = name; this.age = age; } public void setName(String name) { this.name = name; } public String getName() { return name; } public void setAge(int age) { this.age = age; } public int getAge() { return age; } public String toString() { return &quot;name:&quot;+name+&quot;, age:&quot;+age; } } // Complexæ˜¯&quot;å¼±ä¸å˜ç±»&quot;ã€‚ // å®ƒè™½ç„¶åŒ…å«äº†å¯å˜çš„å¤–éƒ¨å¯¹è±¡personï¼Œä½†æ˜¯Complexå†…éƒ¨çš„personæ˜¯ä¸ä¼šæ”¹å˜çš„ã€‚å› ä¸ºå®ƒä¿å­˜çš„æ˜¯personçš„æ‹·è´ã€‚ class Complex { private Person person; private int id; public Complex (Person person, int id) { // æ–°å»ºä¸€ä¸ªpersonçš„æ‹·è´ã€‚ this.person = new Person(person.getName(), person.getAge()); this.id = id; } public int getId() { return id; } public Person getPerson() { return person; } public String toString() { return &quot;id:&quot;+id+&quot;, person(&quot;+person+&quot;)&quot;; } } public class WeakImmutable { public static void main(String[] args) { // æ–°å»ºComplexå¯¹è±¡ã€‚ // idæ˜¯1, personçš„åå­—æ˜¯&quot;å¼ ä¸‰&quot;ï¼Œå¹´é¾„æ˜¯18 Person person = new Person(&quot;å¼ ä¸‰&quot;, 18); Complex com = new Complex(person, 1); System.out.println(com); // ä¿®æ”¹personçš„åå­—ä¸º&quot;æŽå››&quot;ï¼Œå¹´é¾„ä¸º20 person.setName(&quot;æŽå››&quot;); person.setAge(20); System.out.println(com); } } è¿è¡Œç»“æžœï¼š id:1, person(name:å¼ ä¸‰, age:18) id:1, person(name:å¼ ä¸‰, age:18) ç»“æžœè¯´æ˜Žï¼šWeakImmutableç›¸æ¯”MutableDemoï¼Œåªå¯¹Complexçš„æž„é€ å‡½æ•°è¿›è¡Œäº†ä¿®æ”¹ã€‚ComplexåŒæ—¶æ»¡è¶³â€å¼±ä¸å˜æ¨¡å¼â€çš„3ä¸ªæ¡ä»¶ï¼Œå› æ­¤ï¼Œå®ƒå°±æ˜¯ä¸ªä¸å˜æ¨¡å¼ã€‚ å¼ºä¸å˜æ¨¡å¼class Person { private String name; private int age; public Person(String name, int age) { this.name = name; this.age = age; } public void setName(String name) { this.name = name; } public String getName() { return name; } public void setAge(int age) { this.age = age; } public int getAge() { return age; } public String toString() { return &quot;name:&quot;+name+&quot;, age:&quot;+age; } } // Complexæ˜¯&quot;å¼ºä¸å˜ç±»&quot;ã€‚ final class Complex { private final Person person; private final int id; public Complex (Person person, int id) { // æ–°å»ºä¸€ä¸ªpersonçš„æ‹·è´ã€‚ this.person = new Person(person.getName(), person.getAge()); this.id = id; } public final int getId() { return id; } public final Person getPerson() { return person; } public String toString() { return &quot;id:&quot;+id+&quot;, person(&quot;+person+&quot;)&quot;; } } public class StrongImmutable { public static void main(String[] args) { // æ–°å»ºComplexå¯¹è±¡ã€‚ // idæ˜¯1, personçš„åå­—æ˜¯&quot;å¼ ä¸‰&quot;ï¼Œå¹´é¾„æ˜¯18 Person person = new Person(&quot;å¼ ä¸‰&quot;, 18); Complex com = new Complex(person, 1); System.out.println(com); // ä¿®æ”¹personçš„åå­—ä¸º&quot;æŽå››&quot;ï¼Œå¹´é¾„ä¸º20 person.setName(&quot;æŽå››&quot;); person.setAge(20); System.out.println(com); } } è¿è¡Œç»“æžœï¼š id:1, person(name:å¼ ä¸‰, age:18) id:1, person(name:å¼ ä¸‰, age:18) ç»“æžœè¯´æ˜Žï¼šStrongImmutableä¸­çš„Complexæ»¡è¶³â€å¼ºä¸å˜æ¨¡å¼â€çš„è¦æ±‚ã€‚StrongImmutableç›¸æ¯”WeakImmutableï¼Œè¿›è¡Œäº†ä¸¤ä¸ªä¿®æ”¹ï¼šç¬¬ä¸€ï¼Œå°†Complexä¸­çš„å±žæ€§å’Œæ–¹æ³•éƒ½ä¿®æ”¹ä¸ºfinalç±»åž‹ã€‚ç¬¬äºŒï¼Œå°†Complexç±»æœ¬èº«ä¿®æ”¹ä¸ºfinalç±»åž‹ã€‚ ä¸å˜æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ä¸å˜æ¨¡å¼æœ‰å¾ˆæ˜Žæ˜¾çš„ä¼˜ç‚¹ï¼š(1) å› ä¸ºä¸èƒ½ä¿®æ”¹ä¸€ä¸ªä¸å˜å¯¹è±¡çš„çŠ¶æ€ï¼Œæ‰€ä»¥å¯ä»¥é¿å…ç”±æ­¤å¼•èµ·çš„ä¸å¿…è¦çš„ç¨‹åºé”™è¯¯ï¼›æ¢è¨€ä¹‹ï¼Œä¸€ä¸ªä¸å˜çš„å¯¹è±¡è¦æ¯”å¯å˜çš„å¯¹è±¡æ›´åŠ å®¹æ˜“ç»´æŠ¤ã€‚(2) å› ä¸ºæ²¡æœ‰ä»»ä½•ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿä¿®æ”¹ä¸å˜å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä¸€ä¸ªä¸å˜å¯¹è±¡è‡ªåŠ¨å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ ·å°±å¯ä»¥çœæŽ‰å¤„ç†åŒæ­¥åŒ–çš„å¼€é”€ã€‚ä¸€ä¸ªä¸å˜å¯¹è±¡å¯ä»¥è‡ªç”±åœ°è¢«ä¸åŒçš„å®¢æˆ·ç«¯å…±äº«ã€‚ ä¸å˜æ¨¡å¼çš„ç¼ºç‚¹ï¼šä¸å˜æ¨¡å¼å”¯ä¸€çš„ç¼ºç‚¹æ˜¯ï¼šä¸€æ—¦éœ€è¦ä¿®æ”¹ä¸€ä¸ªä¸å˜å¯¹è±¡çš„çŠ¶æ€ï¼Œå°±åªå¥½åˆ›å»ºä¸€ä¸ªæ–°çš„åŒç±»å¯¹è±¡ã€‚åœ¨éœ€è¦é¢‘ç¹ä¿®æ”¹ä¸å˜å¯¹è±¡çš„çŽ¯å¢ƒé‡Œï¼Œä¼šæœ‰å¤§é‡çš„ä¸å˜å¯¹è±¡ä½œä¸ºä¸­é—´ç»“æžœè¢«åˆ›å»ºå‡ºæ¥ï¼Œå†è¢«JAVAåžƒåœ¾æ”¶é›†å™¨æ”¶é›†èµ°ã€‚è¿™æ˜¯ä¸€ç§èµ„æºä¸Šçš„æµªè´¹ã€‚ åœ¨è®¾è®¡ä»»ä½•ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œåº”å½“æ…Žé‡è€ƒè™‘å…¶çŠ¶æ€æ˜¯å¦æœ‰éœ€è¦å˜åŒ–çš„å¯èƒ½æ€§ã€‚é™¤éžå…¶çŠ¶æ€æœ‰å˜åŒ–çš„å¿…è¦ï¼Œä¸ç„¶åº”å½“å°†å®ƒè®¾è®¡æˆä¸å˜ç±»ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ä¸å˜æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼14ä¹‹ æ¡¥æ¢(Bridge)æ¨¡å¼(ç»“æž„æ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F27%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F14%E4%B9%8B-%E6%A1%A5%E6%A2%81-Bridge-%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[æ¡¥æ¢æ¨¡å¼ç®€ä»‹ æ¡¥æ¢æ¨¡å¼(Bridge)ï¼Œåˆç§°ä¸ºæŸ„ä½“(Handle and Body)æ¨¡å¼æˆ–æŽ¥å£(Interface)æ¨¡å¼ã€‚å®ƒå±žäºŽå¯¹è±¡çš„ç»“æž„æ¨¡å¼ï¼Œå…¶ç”¨æ„æ˜¯â€œå°†æŠ½è±¡åŒ–(Abstraction)ä¸Žå®žçŽ°åŒ–(Implementation)è„±è€¦ï¼Œä½¿å¾—äºŒè€…å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–â€ã€‚ è¿™å¥è¯æœ‰ä¸‰ä¸ªå…³é”®è¯ï¼šâ€œæŠ½è±¡åŒ–â€ã€â€å®žçŽ°åŒ–â€å’Œâ€è„±è€¦â€ã€‚ â€¢ æŠ½è±¡åŒ– å­˜åœ¨äºŽå¤šä¸ªå®žä½“ä¸­çš„å…±åŒçš„æ¦‚å¿µè”ç³»ï¼Œå°±æ˜¯æŠ½è±¡è¯ã€‚ä¾‹å¦‚ï¼Œè‹¹æžœã€è‘¡è„ã€è‰èŽ“ï¼Œå®ƒä»¬çš„å…±åŒç‰¹å¾å°±æ˜¯æ°´æžœï¼Œå› æ­¤ï¼Œæ°´æžœæ˜¯å®ƒä»¬çš„æŠ½è±¡åŒ–å­˜åœ¨ï¼›åœ†å½¢ã€æ­£æ–¹å½¢ã€ä¸‰è§’å½¢ï¼Œå®ƒä»¬çš„å…±åŒç‰¹å¾å°±æ˜¯å½¢çŠ¶ï¼Œå› æ­¤ï¼Œå½¢çŠ¶å°±æ˜¯å®ƒä»¬çš„æŠ½è±¡è¯ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ç»„å¯¹è±¡å¦‚æžœå…·æœ‰ç›¸åŒçš„ç‰¹å¾ï¼Œé‚£ä¹ˆå®ƒä»¬å°±å¯ä»¥é€šè¿‡ä¸€ä¸ªå…±åŒçš„ç±»æ¥æè¿°ã€‚å¦‚æžœä¸€äº›ç±»å…·æœ‰ç›¸åŒçš„ç‰¹å¾ï¼Œå¾€å¾€å¯ä»¥é€šè¿‡ä¸€ä¸ªå…±åŒçš„æŠ½è±¡ç±»æ¥æè¿°ã€‚ â€¢ å®žçŽ°åŒ– æŠ½è±¡åŒ–ç»™å‡ºçš„å…·ä½“å®žçŽ°ï¼Œå°±æ˜¯å®žçŽ°åŒ–ã€‚ ä¸€ä¸ªç±»çš„å®žä¾‹å°±æ˜¯è¿™ä¸ªç±»çš„å®žä¾‹åŒ–ï¼Œä¸€ä¸ªå…·ä½“å­ç±»æ˜¯å®ƒçš„æŠ½è±¡è¶…ç±»çš„å®žä¾‹åŒ–ã€‚ â€¢ è„±è€¦ æ‰€è°“è€¦åˆï¼Œå°±æ˜¯ä¸¤ä¸ªå®žä½“çš„è¡Œä¸ºçš„æŸç§å¼ºå…³è”ã€‚è€Œå°†å®ƒä»¬çš„å¼ºå…³è”åŽ»æŽ‰ï¼Œå°±æ˜¯è€¦åˆçš„è§£è„±ï¼Œæˆ–ç§°è„±è€¦ã€‚åœ¨è¿™é‡Œï¼Œè„±è€¦æ˜¯æŒ‡å°†æŠ½è±¡åŒ–å’Œå®žçŽ°åŒ–ä¹‹é—´çš„è€¦åˆè§£è„±å¼€ï¼Œæˆ–è€…è¯´æ˜¯å°†å®ƒä»¬ä¹‹é—´çš„å¼ºå…³è”æ”¹æ¢æˆå¼±å…³è”ã€‚ æ‰€è°“å¼ºå…³è”ï¼Œå°±æ˜¯åœ¨ç¼–è¯‘æ—¶æœŸå·²ç»ç¡®å®šçš„ï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶æœŸåŠ¨æ€æ”¹å˜çš„å…³è”ï¼›æ‰€è°“å¼±å…³è”ï¼Œå°±æ˜¯å¯ä»¥åŠ¨æ€åœ°ç¡®å®šå¹¶ä¸”å¯ä»¥åœ¨è¿è¡Œæ—¶æœŸåŠ¨æ€åœ°æ”¹å˜çš„å…³è”ã€‚æ˜¾ç„¶ï¼Œåœ¨Javaè¯­è¨€ä¸­ï¼Œç»§æ‰¿å…³ç³»æ˜¯å¼ºå…³è”ï¼Œè€Œèšåˆå…³ç³»æ˜¯å¼±å…³è”ã€‚ å°†ä¸¤ä¸ªè§’è‰²ä¹‹é—´çš„ç»§æ‰¿å…³ç³»æ”¹ä¸ºèšåˆå…³ç³»ï¼Œå°±æ˜¯å°†å®ƒä»¬ä¹‹é—´çš„å¼ºå…³è”æ”¹æ¢æˆä¸ºå¼±å…³è”ã€‚å› æ­¤ï¼Œæ¡¥æ¢æ¨¡å¼ä¸­çš„æ‰€è°“è„±è€¦ï¼Œå°±æ˜¯æŒ‡åœ¨ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿçš„æŠ½è±¡åŒ–å’Œå®žçŽ°åŒ–ä¹‹é—´ä½¿ç”¨èšåˆå…³ç³»è€Œä¸æ˜¯ç»§æ‰¿å…³ç³»ï¼Œä»Žè€Œä½¿ä¸¤è€…å¯ä»¥ç›¸å¯¹ç‹¬ç«‹åœ°å˜åŒ–ã€‚è¿™å°±æ˜¯æ¡¥æ¢æ¨¡å¼çš„ç”¨æ„ã€‚ æ¡¥æ¢æ¨¡å¼çš„UMLç±»å›¾ ä»Žä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¡¥æŽ¥æ¨¡å¼å«æœ‰ä¸¤ä¸ªç­‰çº§ç»“æž„ï¼š(01) ç”±æŠ½è±¡åŒ–è§’è‰²å’Œä¿®æ­£æŠ½è±¡åŒ–è§’è‰²ç»„æˆçš„æŠ½è±¡åŒ–ç­‰çº§ç»“æž„ã€‚(02) ç”±å®žçŽ°åŒ–è§’è‰²å’Œä¸¤ä¸ªå…·ä½“å®žçŽ°åŒ–è§’è‰²æ‰€ç»„æˆçš„å®žçŽ°åŒ–ç­‰çº§ç»“æž„ã€‚ æ¡¥æ¢æ¨¡å¼åŒ…å«å››ç§è§’è‰²ï¼š æŠ½è±¡åŒ–(Abstraction)ï¼Œä¿®æ­£æŠ½è±¡åŒ–(RefinedAbstraction)ï¼Œå®žçŽ°åŒ–(Implementor)ï¼Œå…·ä½“å®žçŽ°åŒ–(ConcreteImplementor)ã€‚â€¢ æŠ½è±¡åŒ–: æŠ½è±¡åŒ–ç»™å‡ºçš„å®šä¹‰ï¼Œå¹¶ä¿å­˜ä¸€ä¸ªå¯¹å®žçŽ°åŒ–å¯¹è±¡çš„å¼•ç”¨ã€‚â€¢ ä¿®æ­£æŠ½è±¡åŒ–: æ‰©å±•æŠ½è±¡åŒ–è§’è‰²ï¼Œæ”¹å˜å’Œä¿®æ­£çˆ¶ç±»å¯¹æŠ½è±¡åŒ–çš„å®šä¹‰ã€‚â€¢ å®žçŽ°åŒ–: è¿™ä¸ªè§’è‰²ç»™å‡ºå®žçŽ°åŒ–è§’è‰²çš„æŽ¥å£ï¼Œä½†ä¸ç»™å‡ºå…·ä½“çš„å®žçŽ°ã€‚å¿…é¡»æŒ‡å‡ºçš„æ˜¯ï¼Œè¿™ä¸ªæŽ¥å£ä¸ä¸€å®šå’ŒæŠ½è±¡åŒ–è§’è‰²çš„æŽ¥å£å®šä¹‰ç›¸åŒï¼Œå®žé™…ä¸Šï¼Œè¿™ä¸¤ä¸ªæŽ¥å£å¯ä»¥éžå¸¸ä¸ä¸€æ ·ã€‚å®žçŽ°åŒ–è§’è‰²åº”å½“åªç»™å‡ºåº•å±‚æ“ä½œï¼Œè€ŒæŠ½è±¡åŒ–è§’è‰²åº”å½“åªç»™å‡ºåŸºäºŽåº•å±‚æ“ä½œçš„æ›´é«˜ä¸€å±‚çš„æ“ä½œã€‚â€¢ å…·ä½“å®žçŽ°åŒ–: è¿™ä¸ªè§’è‰²ç»™å‡ºå®žçŽ°åŒ–è§’è‰²æŽ¥å£çš„å…·ä½“å®žçŽ°ã€‚ å¯¹è±¡æ˜¯å¯¹è¡Œä¸ºçš„å°è£…ï¼Œè€Œè¡Œä¸ºæ˜¯ç”±æ–¹æ³•å®žçŽ°çš„ã€‚åœ¨è¿™ä¸ªç¤ºæ„æ€§ç³»ç»Ÿé‡Œï¼ŒæŠ½è±¡åŒ–ç­‰çº§ç»“æž„ä¸­çš„ç±»å°è£…äº†operation()æ–¹æ³•ï¼›è€Œå®žçŽ°åŒ–ç­‰çº§ç»“æž„ä¸­çš„ç±»å°è£…çš„æ˜¯operationImpl()æ–¹æ³•ã€‚å½“ç„¶ï¼Œåœ¨å®žé™…çš„ç³»ç»Ÿä¸­å¾€å¾€ä¼šæœ‰å¤šäºŽä¸€ä¸ªçš„æ–¹æ³•ã€‚ æŠ½è±¡åŒ–ç­‰çº§ç»“æž„ä¸­çš„æ–¹æ³•é€šè¿‡å‘å¯¹åº”çš„å®žçŽ°åŒ–å¯¹è±¡çš„å§”æ´¾å®žçŽ°è‡ªå·±çš„åŠŸèƒ½ï¼Œè¿™æ„å‘³ç€æŠ½è±¡åŒ–è§’è‰²å¯ä»¥é€šè¿‡å‘ä¸åŒçš„å®žçŽ°åŒ–å¯¹è±¡å§”æ´¾ï¼Œæ¥è¾¾åˆ°åŠ¨æ€åœ°è½¬æ¢è‡ªå·±çš„åŠŸèƒ½çš„ç›®çš„ã€‚ ç¤ºæ„ä»£ç æŠ½è±¡åŒ– public abstract class Abstraction { protected Implementor impl; public Abstraction(Implementor impl){ this.impl = impl; } // å•†ä¸šæ–¹æ³• public void operation(){ impl.operationImpl(); } } ä¿®æ­£æŠ½è±¡åŒ–è§’è‰² public class RefinedAbstraction extends Abstraction { public RefinedAbstraction(Implementor impl) { super(impl); } } å®žçŽ°åŒ–è§’è‰² public abstract class Implementor { // æ–¹æ³•çš„å®žçŽ°åŒ–å£°æ˜Ž public abstract void operationImpl(); } å…·ä½“å®žçŽ°åŒ–è§’è‰² public class ConcreteImplementorA extends Implementor { // æ–¹æ³•çš„å®žçŽ°åŒ–å®žçŽ° @Override public void operationImpl() { // something you want to do } } public class ConcreteImplementorB extends Implementor { // æ–¹æ³•çš„å®žçŽ°åŒ–å®žçŽ° @Override public void operationImpl() { // something you want to do } } æ¡¥æ¢æ¨¡å¼ç¤ºä¾‹ é—®é¢˜ ç©ºä¸­å·´å£«(Airbus)ã€æ³¢éŸ³(Boeing)å’Œéº¦é“(MD)éƒ½æ˜¯é£žæœºåˆ¶é€ å•†ï¼Œå®ƒä»¬éƒ½ç”Ÿæˆè½½å®¢é£žæœº(PassengerPlane)å’Œè½½è´§é£žæœº(CargoPlane)ã€‚çŽ°åœ¨éœ€è¦è®¾è®¡ä¸€ä¸ªç³»ç»Ÿï¼Œæè¿°è¿™äº›é£žæœºåˆ¶é€ å•†ä»¥åŠå®ƒä»¬æ‰€åˆ¶é€ çš„é£žæœºç§ç±»ã€‚ è®¾è®¡æ–¹æ¡ˆä¸€(ä¸ä½¿ç”¨æ¡¥æ¢æ¨¡å¼) ç³»ç»Ÿæ˜¯å…³äºŽé£žæœºçš„ï¼Œå› æ­¤å¯ä»¥è®¾è®¡ä¸€ä¸ªæ€»çš„é£žæœºæŽ¥å£ï¼Œå«åšAirplaneã€‚å…¶å®ƒæ‰€æœ‰çš„é£žæœºéƒ½æ˜¯è¿™ä¸ªæ€»æŽ¥å£çš„å­—æŽ¥å£æˆ–è€…å…·ä½“å®žçŽ°ã€‚ ä¸‹é¢æ˜¯è¿™ä¸ªæ–¹æ¡ˆçš„è®¾è®¡å›¾ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å¤ªé«˜æ˜Žçš„è®¾è®¡ï¼Œå¯¼è‡´äº†ç†ä¸æ¸…çš„å…³ç³»ã€‚ åœ¨è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆé‡Œé¢ï¼Œå‡ºçŽ°äº†ä¸¤ä¸ªå­æŽ¥å£ï¼Œåˆ†åˆ«ä»£è¡¨å®¢æˆ·å’Œè´§æœºã€‚æ‰€æœ‰çš„å…·ä½“é£žæœºåˆè¦ç»§æ‰¿è‡ªAirbusï¼ŒBoeingå’ŒMDç­‰è¶…ç±»ã€‚è¿™æ ·ä¸€ç±»ï¼Œæ¯ä¸ªå…·ä½“é£žæœºéƒ½å¸¦æœ‰ä¸¤ä¸ªè¶…ç±»ï¼šé£žæœºåˆ¶é€ å•†ç±»åž‹ï¼Œå®¢ã€è´§æœºç±»åž‹ã€‚ è®¾è®¡æ–¹æ¡ˆäºŒ(ä½¿ç”¨æ¡¥æ¢æ¨¡å¼) ä½¿ç”¨æ¡¥æ¢æ¨¡å¼çš„å…³é”®åœ¨äºŽå‡†ç¡®çš„æ‰¾å‡ºè¿™ä¸ªç³»ç»Ÿçš„æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“åŒ–è§’è‰²ã€‚ä»Žç³»ç»Ÿæ‰€é¢å¯¹çš„é—®é¢˜ä¸éš¾çœ‹å‡ºï¼Œä»£è¡¨é£žæœºçš„æŠ½è±¡åŒ–æ˜¯å®ƒçš„ç±»åž‹ï¼Œä¹Ÿå°±æ˜¯â€å®¢æˆ·â€æˆ–è€…â€è´§æœºâ€ï¼›è€Œä»£è¡¨é£žæœºçš„å®žçŽ°åŒ–çš„åˆ™æ˜¯é£žæœºçš„åˆ¶é€ å•†ã€‚ ä½¿ç”¨æ¡¥æ¢æ¨¡å¼ï¼Œå¯¹åº”çš„UMLç±»å›¾å¦‚ä¸‹ï¼š æŠ½è±¡åŒ–ç±»abstract public class Airplane { // é£žæœºåˆ¶é€ å•† protected AirplaneMaker maker; // æŒ‡å®šé£žæœºåˆ¶é€ å•† public Airplane(AirplaneMaker maker) { this.maker = maker; } public void fly() { // è°ƒç”¨AirplaneMakerçš„produce()æ–¹æ³• maker.produce(); } } ä¿®æ­£æŠ½è±¡åŒ–PassengerPlaneä»£ç  public class PassengerPlane extends Airplane { public PassengerPlane(AirplaneMaker maker) { super(maker); } public void fly() { super.fly(); System.out.println(&quot;PassengerPlane fly.&quot;); } } CargoPlaneä»£ç  public class CargoPlane extends Airplane { public CargoPlane(AirplaneMaker maker) { super(maker); } public void fly() { super.fly(); System.out.println(&quot;CargoPlane fly.&quot;); } } å®žçŽ°åŒ–AirplaneMakerä»£ç  abstract public class AirplaneMaker { // ç”Ÿäº§é£žæœº public abstract void produce() ; } å…·ä½“å®žçŽ°åŒ–Airbusä»£ç  public class Airbus extends AirplaneMaker { public void produce() { System.out.println(&quot;Airbus produced.&quot;); } } Boeingä»£ç  public class Boeing extends AirplaneMaker { public void produce() { System.out.println(&quot;Boeing produced.&quot;); } } MDä»£ç  public class MD extends AirplaneMaker { public void produce() { System.out.println(&quot;MD produced.&quot;); } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºpublic class Client { public static void main(String[] args) { // &quot;é£žæœºåˆ¶é€ å•†&quot;ä¸ºAirbus AirplaneMaker maker = new Airbus(); // &quot;é£žæœºç±»åž‹&quot;ä¸ºPassengerPlane Airplane plane = new PassengerPlane(maker); // é£žæœºé£žè¡Œ plane.fly(); // &quot;é£žæœºåˆ¶é€ å•†&quot;ä¸ºMD maker = new MD(); // &quot;é£žæœºç±»åž‹&quot;ä¸ºCargoPlane plane = new CargoPlane(maker); // é£žæœºé£žè¡Œ plane.fly(); } } è¿è¡Œç»“æžœï¼š Airbus produced. PassengerPlane fly. MD produced. CargoPlane fly.]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>æ¡¥æ¢æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼13ä¹‹ é—¨é¢(Facade)æ¨¡å¼(ç»“æž„æ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F26%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F13%E4%B9%8B-%E9%97%A8%E9%9D%A2-Facade-%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[é—¨é¢æ¨¡å¼ç®€ä»‹é—¨é¢æ¨¡å¼æ˜¯å¯¹è±¡çš„ç»“æž„æ¨¡å¼ï¼Œå¤–éƒ¨ä¸Žä¸€ä¸ªå­ç³»ç»Ÿçš„é€šä¿¡å¿…é¡»é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„é—¨é¢å¯¹è±¡è¿›è¡Œã€‚é—¨é¢æ¨¡å¼æä¾›ä¸€ä¸ªé«˜å±‚æ¬¡çš„æŽ¥å£ï¼Œä½¿å¾—å­ç³»ç»Ÿæ›´æ˜“äºŽä½¿ç”¨ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œç—…äººåŽ»åŒ»é™¢çœ‹ç—…ï¼Œå¦‚æžœæŠŠåŒ»é™¢ä½œä¸ºä¸€ä¸ªå­ç³»ç»Ÿï¼ŒæŒ‰ç…§éƒ¨é—¨èŒèƒ½ï¼Œè¿™ä¸ªç³»ç»Ÿå¯ä»¥åˆ’åˆ†ä¸ºæŒ‚å·ã€é—¨è¯Šã€åˆ’ä»·ã€åŒ–éªŒã€æ”¶è´¹ã€å–è¯ç­‰ã€‚çœ‹ç—…çš„ç—…äººè¦ä¸Žè¿™äº›éƒ¨é—¨æ‰“äº¤é“ï¼Œå°±å¦‚åŒä¸€ä¸ªå­ç³»ç»Ÿçš„å®¢æˆ·ç«¯ä¸Žä¸€ä¸ªå­ç³»ç»Ÿçš„å„ä¸ªç±»æ‰“äº¤é“ä¸€æ ·ï¼Œä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼šé¦–å…ˆç—…äººå¿…é¡»å…ˆæŒ‚å·ï¼Œç„¶åŽé—¨è¯Šï¼›å¦‚æžœåŒ»ç”Ÿè¦æ±‚åŒ–éªŒï¼Œç—…äººå¿…é¡»é¦–å…ˆåˆ’ä»·ï¼Œç„¶åŽç¼´è´¹ï¼Œæ‰å¯ä»¥åˆ°åŒ–éªŒéƒ¨é—¨åšåŒ–éªŒï¼›åŒ–éªŒåŽå†å›žåˆ°é—¨è¯Šå®¤ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è€Œå¦‚æžœå¼•â€è¿›é—¨é¢æ¨¡å¼â€ï¼Œåœ¨åŒ»é™¢ä¸­å¢žåŠ ä¸€ä¸ªæŽ¥å¾…å‘˜ã€‚ç”±æŽ¥å¾…å‘˜è´Ÿè´£ä»£ä¸ºæŒ‚å·ã€åˆ’ä»·ã€ç¼´è´¹ã€å–è¯ç­‰ï¼Œç—…äººåªæŽ¥è§¦æŽ¥å¾…å‘˜ï¼Œç”±æŽ¥å¾…å‘˜ä¸Žå„ä¸ªéƒ¨é—¨æ‰“äº¤é“ã€‚è¿™æ ·ï¼Œå¯¹ç—…äººæ¥è¯´ï¼Œå°±ä¼šç®€å•å¾ˆå¤šã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸‹é¢çœ‹çœ‹é—¨é¢æ¨¡å¼çš„UMLç±»å›¾ï¼š é—¨é¢æ¨¡å¼åŒ…æ‹¬2ä¸ªè§’è‰²ï¼šé—¨é¢(Facade)ï¼Œå­ç³»ç»Ÿ(SubSystem)ã€‚ è§’è‰² è¯´æ˜Ž é—¨ é¢ å®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨è¿™ä¸ªè§’è‰²çš„æ–¹æ³•ã€‚æ­¤è§’è‰²çŸ¥æ™“ç›¸å…³çš„ï¼ˆä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼‰å­ç³»ç»Ÿçš„åŠŸèƒ½å’Œè´£ä»»ã€‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œæœ¬è§’è‰²ä¼šå°†æ‰€æœ‰ä»Žå®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚å§”æ´¾åˆ°ç›¸åº”çš„å­ç³»ç»ŸåŽ»ã€‚ å­ç³»ç»Ÿ å¯ä»¥åŒæ—¶æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­ç³»ç»Ÿã€‚æ¯ä¸ªå­ç³»ç»Ÿéƒ½ä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç±»ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»çš„é›†åˆã€‚æ¯ä¸ªå­ç³»ç»Ÿéƒ½å¯ä»¥è¢«å®¢æˆ·ç«¯ç›´æŽ¥è°ƒç”¨ï¼Œæˆ–è€…è¢«é—¨é¢è§’è‰²è°ƒç”¨ã€‚å­ç³»ç»Ÿå¹¶ä¸çŸ¥é“é—¨é¢çš„å­˜åœ¨ï¼Œå¯¹äºŽå­ç³»ç»Ÿè€Œè¨€ï¼Œé—¨é¢ä»…ä»…æ˜¯å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯è€Œå·²ã€‚ é—¨é¢æ¨¡å¼ç¤ºä¾‹ä¸€ä¸ªä¿å®‰ç³»ç»Ÿç”±ä¸¤ä¸ªå½•åƒæœºã€ä¸‰ä¸ªç”µç¯ã€ä¸€ä¸ªé¥æŽ§å™¨å’Œä¸€ä¸ªè­¦æŠ¥å™¨ç»„æˆã€‚ä¿å®‰ç³»ç»Ÿçš„æ“ä½œäººå‘˜åœ¨æ—©ä¸Šä¸Šç­çš„æ—¶å€™ï¼Œå°†è¿™äº›ä»ªå™¨æ‰“å¼€ï¼›æ™šä¸Šä¸‹ç­ä¹‹åŽï¼Œä¼šå°†è¿™äº›ä»ªå™¨å…³é—­ã€‚ æˆ‘ä»¬å…ˆæ¼”ç¤ºåœ¨ä¸ä½¿ç”¨â€é—¨é¢æ¨¡å¼â€çš„æƒ…å†µä¸‹ï¼Œå®žçŽ°è¯¥ç³»ç»Ÿã€‚ç„¶åŽï¼Œé€šè¿‡â€é—¨é¢æ¨¡å¼â€å®žçŽ°è¯¥ç³»ç»Ÿã€‚ æœªä½¿ç”¨â€é—¨é¢æ¨¡å¼â€UMLç±»å›¾å¦‚ä¸‹ï¼š ä»Žå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå®¢æˆ·ç«¯Clientå¯¹è±¡éœ€è¦å¼•ç”¨åˆ°å½•åƒæœº(Camera)ã€ç”µç¯(Light)ã€æ„Ÿåº”å™¨(Sensor)å’ŒæŠ¥è­¦å™¨(Alarm)æ‰€æœ‰çš„å¯¹è±¡ã€‚ å®¢æˆ·ç«¯(Client)æºç  public class Client { private static Camera camera1, camera2; private static Light light1, light2, light3; private static Sensor sensor; private static Alarm alarm; public static void main(String[] args) { camera1 = new Camera(); camera2 = new Camera(); light1 = new Light(); light2 = new Light(); light3 = new Light(); sensor = new Sensor(); alarm = new Alarm(); camera1.turnOn(); camera2.turnOn(); light1.turnOn(); light2.turnOn(); light3.turnOn(); sensor.activate(); alarm.activate(); } } å½•åƒæœº(Camera)æºç  public class Camera { // æ‰“å¼€å½•åƒæœº public void turnOn() { System.out.println(&quot;Turning on the camera.&quot;); } // å…³é—­å½•åƒæœº public void turnOff() { System.out.println(&quot;Turning off the camera.&quot;); } // è½¬åŠ¨å½•åƒæœº public void rotate(int degrees) { System.out.println(&quot;Rotating the camera by &quot;+degrees+&quot; degrees.&quot;); } } ç”µç¯(Light)æºç  public class Light { // æ‰“å¼€ç¯ public void turnOn() { System.out.println(&quot;Turning on the light.&quot;); } // å…³é—­ç¯ public void turnOff() { System.out.println(&quot;Turning off the light.&quot;); } // æ¢ç¯æ³¡ public void changeBulb() { System.out.println(&quot;Cotating the light-bulb.&quot;); } } æ„Ÿåº”å™¨(Sensor)æºç  public class Sensor { // å¯åŠ¨æ„Ÿåº”å™¨ public void activate() { System.out.println(&quot;Activating on the sensor.&quot;); } // å…³é—­æ„Ÿåº”å™¨ public void deactivate() { System.out.println(&quot;Deactivating the sensor.&quot;); } // è§¦å‘æ„Ÿåº”å™¨ public void trigger() { System.out.println(&quot;The sensor has been triggered.&quot;); } } æŠ¥è­¦å™¨(Alarm)æºç  public class Alarm { // å¯åŠ¨è­¦æŠ¥å™¨ public void activate() { System.out.println(&quot;Activating on the alarm.&quot;); } // å…³é—­è­¦æŠ¥å™¨ public void deactivate() { System.out.println(&quot;Deactivating the alarm.&quot;); } // æ‹‰å“è­¦æŠ¥å™¨ public void ring() { System.out.println(&quot;Ringing the alarm&quot;); } // åœæŽ‰è­¦æŠ¥å™¨ public void stopRing() { System.out.println(&quot;Stop the alarm&quot;); } } è¿è¡Œç»“æžœï¼š Turning on the camera. Turning on the camera. Turning on the light. Turning on the light. Turning on the light. Activating on the sensor. Activating on the alarm. ä½¿ç”¨â€é—¨é¢æ¨¡å¼â€UMLç±»å›¾å¦‚ä¸‹ï¼š å¯ä»¥çœ‹å‡ºï¼šé—¨é¢SecurityFadeæ‰¿æ‹…äº†ä¸Žä¿å®‰ç³»ç»Ÿå†…éƒ¨å„ä¸ªå¯¹è±¡æ‰“äº¤é“çš„ä»»åŠ¡ï¼Œè€Œå®¢æˆ·å¯¹è±¡åªéœ€è¦ä¸Žé—¨é¢å¯¹è±¡æ‰“äº¤é“å³å¯ã€‚SecurityFadeæ˜¯å®¢æˆ·ç«¯ä¸Žä¿å®‰ç³»ç»Ÿä¹‹é—´çš„ä¸€ä¸ªé—¨æˆ·ï¼Œå®ƒä½¿å¾—å®¢æˆ·ç«¯ä¸Žå­ç³»ç»Ÿä¹‹é—´çš„å…³ç³»å˜å¾—ç®€å•å’Œæ˜“äºŽç®¡ç†ã€‚ å®¢æˆ·ç«¯(Client)æºç  public class Client { private static SecurityFacade security; public static void main(String[] args) { security = new SecurityFacade(); security.activate(); } } é—¨é¢(SecurityFade)æºç  public class SecurityFacade { private Camera camera1, camera2; private Light light1, light2, light3; private Sensor sensor; private Alarm alarm; public SecurityFacade() { camera1 = new Camera(); camera2 = new Camera(); light1 = new Light(); light2 = new Light(); light3 = new Light(); sensor = new Sensor(); alarm = new Alarm(); } public void activate() { camera1.turnOn(); camera2.turnOn(); light1.turnOn(); light2.turnOn(); light3.turnOn(); sensor.activate(); alarm.activate(); } public void deactivate() { camera1.turnOff(); camera2.turnOff(); light1.turnOff(); light2.turnOff(); light3.turnOff(); sensor.deactivate(); alarm.deactivate(); } } å½•åƒæœº(Camera)æºç  public class Camera { // æ‰“å¼€å½•åƒæœº public void turnOn() { System.out.println(&quot;Turning on the camera.&quot;); } // å…³é—­å½•åƒæœº public void turnOff() { System.out.println(&quot;Turning off the camera.&quot;); } // è½¬åŠ¨å½•åƒæœº public void rotate(int degrees) { System.out.println(&quot;Rotating the camera by &quot;+degrees+&quot; degrees.&quot;); } } ç”µç¯(Light)æºç  public class Light { // æ‰“å¼€ç¯ public void turnOn() { System.out.println(&quot;Turning on the light.&quot;); } // å…³é—­ç¯ public void turnOff() { System.out.println(&quot;Turning off the light.&quot;); } // æ¢ç¯æ³¡ public void changeBulb() { System.out.println(&quot;Cotating the light-bulb.&quot;); } } æ„Ÿåº”å™¨(Sensor)æºç  public class Sensor { // å¯åŠ¨æ„Ÿåº”å™¨ public void activate() { System.out.println(&quot;Activating on the sensor.&quot;); } // å…³é—­æ„Ÿåº”å™¨ public void deactivate() { System.out.println(&quot;Deactivating the sensor.&quot;); } // è§¦å‘æ„Ÿåº”å™¨ public void trigger() { System.out.println(&quot;The sensor has been triggered.&quot;); } } æŠ¥è­¦å™¨(Alarm)æºç  public class Alarm { // å¯åŠ¨è­¦æŠ¥å™¨ public void activate() { System.out.println(&quot;Activating on the alarm.&quot;); } // å…³é—­è­¦æŠ¥å™¨ public void deactivate() { System.out.println(&quot;Deactivating the alarm.&quot;); } // æ‹‰å“è­¦æŠ¥å™¨ public void ring() { System.out.println(&quot;Ringing the alarm&quot;); } // åœæŽ‰è­¦æŠ¥å™¨ public void stopRing() { System.out.println(&quot;Stop the alarm&quot;); } } è¿è¡Œç»“æžœï¼š Turning on the camera. Turning on the camera. Turning on the light. Turning on the light. Turning on the light. Activating on the sensor. Activating on the alarm.]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>é—¨é¢æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼12ä¹‹ äº«å…ƒ(Flyweight)æ¨¡å¼(ç»“æž„æ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F25%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F12%E4%B9%8B-%E4%BA%AB%E5%85%83-Flyweight-%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[äº«å…ƒæ¨¡å¼ç®€ä»‹äº«å…ƒæ¨¡å¼(Flyweight)æ˜¯å¯¹è±¡çš„ç»“æž„æ¨¡å¼ï¼Œå®ƒä»¥å…±äº«çš„æ–¹å¼é«˜æ•ˆåœ°æ”¯æŒå¤§é‡çš„ç»†ç²’åº¦å¯¹è±¡ã€‚ å®ƒçš„å¥½å¤„æ˜¯ï¼Œé€šè¿‡å…±äº«æ¥é¿å…å¤§é‡æ‹¥æœ‰ç›¸åŒå†…å®¹å¯¹è±¡çš„å¼€é”€ã€‚ äº«å…ƒæ¨¡å¼ä¸­çš„å¯¹è±¡ç§°ä¸ºäº«å…ƒå¯¹è±¡ï¼Œäº«å…ƒå¯¹è±¡åˆ†ä¸ºå†…è•´çŠ¶æ€å’Œå¤–è•´çŠ¶æ€ã€‚å†…è•´å¯¹è±¡å’Œå¤–è•´å¯¹è±¡æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼šå†…è•´çŠ¶æ€æ˜¯å­˜å‚¨åœ¨äº«å…ƒå¯¹è±¡å†…éƒ¨ï¼Œå¹¶ä¸”ä¸ä¼šéšçŽ¯å¢ƒæ”¹å˜è€Œæœ‰æ‰€ä¸åŒçš„ï¼›å†…è•´çŠ¶æ€æ˜¯å¯ä»¥å…±äº«ã€‚å¤–è•´çŠ¶æ€æ˜¯éšçŽ¯å¢ƒæ”¹å˜è€Œæ”¹å˜ï¼Œä¸å¯ä»¥å…±äº«çš„çŠ¶æ€ï¼›äº«å…ƒå¯¹è±¡çš„å¤–è•´çŠ¶æ€å¿…é¡»ç”±å®¢æˆ·ç«¯ä¿å­˜ï¼Œå¹¶åœ¨äº«å…ƒå¯¹è±¡è¢«åˆ›å»ºä¹‹åŽï¼Œåœ¨éœ€è¦ä½¿ç”¨çš„æ—¶å€™å†ä¼ å…¥åˆ°äº«å…ƒå¯¹è±¡å†…éƒ¨ã€‚ ä¸€ä¸ªæ¯”è¾ƒå…¸åž‹çš„äº«å…ƒæ¨¡å¼ç¤ºä¾‹å°±æ˜¯ï¼šâ€Javaä¸­çš„Stringå¯¹è±¡â€ã€‚ ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªStringå¸¸é‡aå’Œbï¼Œå®ƒä»¬çš„å€¼ä¸ºâ€helloâ€ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š String a=&quot;hello&quot;; String b=&quot;hello&quot;; å®žé™…ä¸Šï¼Œaå’Œbéƒ½æ˜¯å­˜åœ¨å¸¸é‡æ± ä¸­ã€‚ç”±äºŽaå’Œbçš„å€¼éƒ½æ˜¯â€helloâ€ï¼Œå®ƒä»¬å®žé™…ä¸Šæ˜¯å¸¸é‡æ± çš„åŒä¸€ä¸ªå¯¹è±¡ï¼ å¸¸é‡æ± (constant pool)æŒ‡çš„æ˜¯åœ¨ç¼–è¯‘æœŸå°±è¢«ç¡®å®šï¼Œå¹¶è¢«ä¿å­˜åœ¨å·²ç¼–è¯‘çš„.classæ–‡ä»¶ä¸­çš„ä¸€äº›æ•°æ®ã€‚å®ƒåŒ…æ‹¬äº†å…³äºŽç±»ã€æ–¹æ³•ã€æŽ¥å£ç­‰ä¸­çš„å¸¸é‡ï¼Œä¹ŸåŒ…æ‹¬å­—ç¬¦ä¸²å¸¸é‡ã€‚ Stringç¤ºä¾‹1public class String1 { public static void main(String[] args) { String a = &quot;hello&quot;; String b = &quot;hello&quot;; String c = &quot;he&quot;+&quot;llo&quot;; System.out.println(a==b); System.out.println(a==c); } } è¿è¡Œç»“æžœï¼š true true ç»“æžœè¯´æ˜Žï¼š(01) aå’Œbä¸­çš„â€helloâ€éƒ½æ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œå®ƒä»¬å­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ï¼Œåœ¨ç¼–è¯‘æœŸå°±è¢«ç¡®å®šäº†ï¼Œæ‰€ä»¥a==bä¸ºtrueã€‚(02) â€œheâ€å’Œâ€lloâ€ä¹Ÿéƒ½æ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸²ç”±å¤šä¸ªå­—ç¬¦ä¸²å¸¸é‡è¿žæŽ¥è€Œæˆæ—¶ï¼Œå®ƒè‡ªå·±è‚¯å®šä¹Ÿæ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œæ‰€ä»¥cä¹ŸåŒæ ·åœ¨ç¼–è¯‘æœŸå°±è¢«è§£æžä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œæ‰€ä»¥cä¹Ÿæ˜¯å¸¸é‡æ± ä¸­â€helloâ€çš„ä¸€ä¸ªå¼•ç”¨ã€‚ Stringç¤ºä¾‹2public class String2 { public static void main(String[] args) { String a = &quot;hello&quot;; String b = new String(&quot;hello&quot;); String c = &quot;he&quot;+new String(&quot;llo&quot;); System.out.println(a==b); System.out.println(a==c); System.out.println(b==c); } } è¿è¡Œç»“æžœï¼š false false false ç»“æžœè¯´æ˜Žï¼šaè¿˜æ˜¯å¸¸é‡æ± ä¸­â€helloâ€å­—ç¬¦ä¸²å¸¸é‡ï¼›è€Œbåˆ™æ— æ³•åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œå®ƒæ˜¯è¿è¡Œæ—¶åˆ›å»ºâ€helloâ€å¯¹è±¡çš„å¼•ç”¨ï¼›è€Œcå› ä¸ºæœ‰åŽåŠéƒ¨åˆ†new String(â€œlloâ€)ï¼Œæ‰€ä»¥cä¹Ÿæ— æ³•åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œå› æ­¤ï¼Œcä¹Ÿæ˜¯ä¸€ä¸ªæ–°åˆ›å»ºçš„â€helloâ€å¯¹è±¡çš„åº”ç”¨ã€‚ ç»§ç»­å›žåˆ°äº«å…ƒæ¨¡å¼ã€‚å®ƒåˆ†ä¸ºâ€å•çº¯äº«å…ƒæ¨¡å¼â€œ å’Œ â€œå¤åˆäº«å…ƒæ¨¡å¼â€œã€‚ å•çº¯äº«å…ƒæ¨¡å¼åœ¨å•çº¯çš„äº«å…ƒæ¨¡å¼ä¸­ï¼Œæ‰€æœ‰çš„äº«å…ƒå¯¹è±¡éƒ½æ˜¯å¯ä»¥å…±äº«çš„ã€‚å®ƒçš„UMLç±»å›¾å¦‚ä¸‹ï¼š å•çº¯äº«å…ƒæ¨¡å¼æ¶‰åŠåˆ°çš„è§’è‰²ï¼šæŠ½è±¡äº«å…ƒ(Flyweight)ï¼Œå…·ä½“äº«å…ƒ(ConcreteFlyweight)ï¼Œäº«å…ƒå·¥åŽ‚(FlyweightFactory)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡äº«å…ƒ è¯¥è§’è‰²æ˜¯æ‰€æœ‰çš„å…·ä½“äº«å…ƒç±»çš„è¶…ç±»ï¼Œå®ƒç»™å‡ºäº†å…·ä½“äº«å…ƒç±»éœ€è¦å®žçŽ°çš„å…¬å…±æŽ¥å£ã€‚ å…·ä½“äº«å…ƒ å®žçŽ°æŠ½è±¡äº«å…ƒè§’è‰²æ‰€è§„å®šå‡ºçš„æŽ¥å£ã€‚ äº«å…ƒå·¥åŽ‚ æœ¬è§’è‰²è´Ÿè´£åˆ›å»ºå’Œç®¡ç†äº«å…ƒè§’è‰²ã€‚æœ¬è§’è‰²å¿…é¡»ä¿è¯äº«å…ƒå¯¹è±¡å¯ä»¥è¢«ç³»ç»Ÿé€‚å½“åœ°å…±äº«ã€‚å½“ä¸€ä¸ªå®¢æˆ·ç«¯å¯¹è±¡è°ƒç”¨ä¸€ä¸ªäº«å…ƒå¯¹è±¡çš„æ—¶å€™ï¼Œäº«å…ƒå·¥åŽ‚è§’è‰²ä¼šæ£€æŸ¥ç³»ç»Ÿä¸­æ˜¯å¦å·²ç»æœ‰ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„äº«å…ƒå¯¹è±¡ã€‚å¦‚æžœå·²ç»æœ‰äº†ï¼Œäº«å…ƒå·¥åŽ‚è§’è‰²å°±åº”å½“æä¾›è¿™ä¸ªå·²æœ‰çš„äº«å…ƒå¯¹è±¡ï¼›å¦‚æžœç³»ç»Ÿä¸­æ²¡æœ‰ä¸€ä¸ªé€‚å½“çš„äº«å…ƒå¯¹è±¡çš„è¯ï¼Œäº«å…ƒå·¥åŽ‚è§’è‰²å°±åº”å½“åˆ›å»ºä¸€ä¸ªåˆé€‚çš„äº«å…ƒå¯¹è±¡ã€‚ æŠ½è±¡äº«å…ƒabstract public class Flyweight { // ç¤ºæ„æ€§æ–¹æ³•ï¼Œå‚æ•°stateæ˜¯å¤–è•´çŠ¶æ€ã€‚ public abstract void operation(String state); } å…·ä½“äº«å…ƒpublic class ConcreteFlyweight extends Flyweight { private Character intrinsicState = null; // å†…è•´çŠ¶æ€ä½œä¸ºå‚æ•°ä¼ å…¥ public ConcreteFlyweight(Character state) { this.intrinsicState = state; } // å¤–è•´çŠ¶æ€ä½œä¸ºå‚é‡ä¼ å…¥æ–¹æ³•ä¸­ï¼Œæ”¹å˜æ–¹æ³•çš„è¡Œä¸ºã€‚ public void operation(String state) { System.out.println(&quot;\tIntrisic State=&quot; + intrinsicState + &quot;, Extriinsic State=&quot;+state); } } äº«å…ƒå·¥åŽ‚import java.util.Map; import java.util.HashMap; import java.util.Iterator; public class FlyweightFactory { private HashMap flies = new HashMap(); public Flyweight factory(Character state) { if (flies.containsKey(state)) { System.out.println(state+&quot; exists.&quot;); return (Flyweight)flies.get(state); } else { System.out.println(state+&quot; not exists!&quot;); Flyweight fly = new ConcreteFlyweight(state); flies.put(state, fly); return fly; } } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºpublic class Client { public static void main(String[] args) { FlyweightFactory factory = new FlyweightFactory(); Flyweight fly = factory.factory(new Character(&apos;a&apos;)); fly.operation(&quot;First Call&quot;); fly = factory.factory(new Character(&apos;b&apos;)); fly.operation(&quot;Second Call&quot;); fly = factory.factory(new Character(&apos;a&apos;)); fly.operation(&quot;Third Call&quot;); } } è¿è¡Œç»“æžœï¼š a not exists! Intrisic State=a, Extriinsic State=First Call b not exists! Intrisic State=b, Extriinsic State=Second Call a exists. Intrisic State=a, Extriinsic State=Third Call ç»“æžœè¯´æ˜Žï¼š æŠ½è±¡äº«å…ƒç±»Flyweightæä¾›äº†operation()å…¬å…±æŽ¥å£ã€‚å…·ä½“äº«å…ƒç±»ConcreteFlyweightå®žçŽ°äº†æŠ½è±¡äº«å…ƒæ‰€ç»™å®šçš„æŽ¥å£ã€‚äº«å…ƒå·¥åŽ‚ç±»FlyweightFactoryè´Ÿè´£åˆ›å»ºå’Œç®¡ç†äº«å…ƒè§’è‰²ã€‚å®¢æˆ·ç«¯ä¸èƒ½ç›´æŽ¥å°†å…·ä½“äº«å…ƒç±»å®žä¾‹åŒ–ï¼Œè€Œå¿…é¡»é€šè¿‡è°ƒç”¨å·¥åŽ‚å¯¹è±¡çš„factory()æ¥èŽ·å–äº«å…ƒå¯¹è±¡ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶å®¢æˆ·ç«¯ç”³è¯·äº†ä¸‰ä¸ªäº«å…ƒå¯¹è±¡ï¼Œä½†æ˜¯å®žé™…åˆ›å»ºçš„äº«å…ƒå¯¹è±¡åªæœ‰ä¸¤ä¸ªï¼Œè¿™å°±æ˜¯å…±äº«çš„å«ä¹‰ã€‚ å¤åˆäº«å…ƒæ¨¡å¼åœ¨å•çº¯äº«å…ƒæ¨¡å¼ä¸­ï¼Œæ‰€æœ‰çš„äº«å…ƒå¯¹è±¡éƒ½æ˜¯å•çº¯äº«å…ƒå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´éƒ½æ˜¯å¯ä»¥ç›´æŽ¥å…±äº«çš„ã€‚è€Œè¿˜æœ‰ä¸€ç§è¾ƒä¸ºå¤æ‚çš„æƒ…å†µï¼Œå°†ä¸€äº›å•çº¯äº«å…ƒä½¿ç”¨åˆæˆæ¨¡å¼åŠ ä»¥å¤åˆï¼Œå½¢æˆå¤åˆäº«å…ƒå¯¹è±¡ã€‚è¿™æ ·çš„å¤åˆäº«å…ƒå¯¹è±¡æœ¬èº«ä¸èƒ½å…±äº«ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥åˆ†è§£æˆå•çº¯äº«å…ƒå¯¹è±¡ï¼Œè€ŒåŽè€…åˆ™å¯ä»¥å…±äº«ã€‚ å¤åˆäº«å…ƒæ¨¡å¼çš„UMLç±»å›¾å¦‚ä¸‹ï¼š å¤åˆäº«å…ƒè§’è‰²æ‰€æ¶‰åŠåˆ°çš„è§’è‰²å¦‚ä¸‹ï¼šæŠ½è±¡äº«å…ƒ(Flyweight)ï¼Œå…·ä½“äº«å…ƒ(ConcreteFlyweight)ï¼Œå¤åˆäº«å…ƒ(ConcreteCompositeFlyweight)ï¼Œäº«å…ƒå·¥åŽ‚(FlyweightFactory)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡äº«å…ƒ è¯¥è§’è‰²æ˜¯æ‰€æœ‰çš„å…·ä½“äº«å…ƒç±»çš„è¶…ç±»ï¼Œå®ƒç»™å‡ºäº†å…·ä½“äº«å…ƒç±»éœ€è¦å®žçŽ°çš„å…¬å…±æŽ¥å£ã€‚ å…·ä½“äº«å…ƒ å®žçŽ°æŠ½è±¡äº«å…ƒè§’è‰²æ‰€è§„å®šå‡ºçš„æŽ¥å£ã€‚ å¤åˆäº«å…ƒ å¤åˆäº«å…ƒè§’è‰²æ‰€ä»£è¡¨çš„å¯¹è±¡æ˜¯ä¸å¯ä»¥å…±äº«çš„ï¼Œä½†æ˜¯ä¸€ä¸ªå¤åˆäº«å…ƒå¯¹è±¡å¯ä»¥åˆ†è§£æˆä¸ºå¤šä¸ªæœ¬èº«æ˜¯å•çº¯äº«å…ƒå¯¹è±¡çš„ç»„åˆã€‚å¤åˆäº«å…ƒè§’è‰²åˆç§°ä½œä¸å¯å…±äº«çš„äº«å…ƒå¯¹è±¡ã€‚ äº«å…ƒå·¥åŽ‚ æœ¬è§’è‰²è´Ÿè´£åˆ›å»ºå’Œç®¡ç†äº«å…ƒè§’è‰²ã€‚ æŠ½è±¡äº«å…ƒæŠ½è±¡äº«å…ƒç±»æ˜¯Flyweightï¼Œå®ƒå®šä¹‰äº†operation()å…¬å…±æŽ¥å£ï¼Œoperation()æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªå¤–è•´çŠ¶æ€ä½œä¸ºå‚é‡ã€‚ abstract public class Flyweight { // ç¤ºæ„æ€§æ–¹æ³•ï¼Œå‚æ•°stateæ˜¯å¤–è•´çŠ¶æ€ public abstract void operation(String state); } å…·ä½“äº«å…ƒå…·ä½“äº«å…ƒç±»æ˜¯ConcreteFlyweightã€‚å®ƒä¸»è¦è´£ä»»æœ‰ä¸¤ä¸ªï¼š(01) å®žçŽ°æŠ½è±¡äº«å…ƒæ‰€å®šä¹‰çš„æŽ¥å£operation()ã€‚(02) ä¸ºå†…æ¶µçŠ¶æ€æä¾›å­˜å‚¨ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ConcreteFlyweightä¸­çš„intrinsicStateæ ‘å½¢ã€‚ public class ConcreteFlyweight extends Flyweight { private Character intrinsicState = null; // æž„é€ å‡½æ•°ï¼Œå†…è•´çŠ¶æ€ä½œä¸ºå‚æ•°ä¼ å…¥ public ConcreteFlyweight(Character state){ this.intrinsicState = state; } // å¤–è•´çŠ¶æ€ä½œä¸ºå‚æ•°ä¼ å…¥æ–¹æ³•ä¸­ï¼Œæ”¹å˜æ–¹æ³•çš„è¡Œä¸ºï¼Œ @Override public void operation(String state) { System.out.println(&quot;\tIntrisic State=&quot; + intrinsicState + &quot;, Extriinsic State=&quot;+state); } } å¤åˆäº«å…ƒå¤åˆäº«å…ƒç±»æ˜¯ConcreteCompositeFlyweightã€‚ å¤åˆäº«å…ƒæ˜¯ç”±â€å•çº¯äº«å…ƒâ€å¯¹è±¡é€šè¿‡å¤åˆè€Œæˆï¼Œå› æ­¤ï¼Œå®ƒæä¾›äº†add()è¿™æ ·çš„èšé›†ç®¡ç†æ–¹æ³•ã€‚ç”±äºŽä¸€ä¸ªå¤åˆäº«å…ƒå¯¹è±¡å…·æœ‰ä¸åŒçš„èšé›†å…ƒç´ ï¼Œè¿™äº›èšé›†å…ƒç´ åœ¨å¤åˆäº«å…ƒå¯¹è±¡è¢«åˆ›å»ºä¹‹åŽåŠ å…¥ï¼Œè¿™æœ¬èº«å°±æ„å‘³ç€å¤åˆäº«å…ƒå¯¹è±¡çš„çŠ¶æ€æ˜¯ä¼šæ”¹å˜çš„ï¼Œå› æ­¤å¤åˆäº«å…ƒå¯¹è±¡æ˜¯ä¸èƒ½å…±äº«çš„ã€‚ æ­¤å¤–ï¼Œå¤åˆäº«å…ƒè§’è‰²å®žçŽ°äº†æŠ½è±¡äº«å…ƒè§’è‰²æ‰€è§„å®šçš„æŽ¥å£ï¼Œä¹Ÿå°±æ˜¯operation()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä»£è¡¨å¤åˆäº«å…ƒå¯¹è±¡çš„å¤–è•´çŠ¶æ€ã€‚ä¸€ä¸ªå¤åˆäº«å…ƒå¯¹è±¡çš„æ‰€æœ‰å•çº¯äº«å…ƒå¯¹è±¡å…ƒç´ çš„å¤–è•´çŠ¶æ€éƒ½æ˜¯ä¸Žå¤åˆäº«å…ƒå¯¹è±¡çš„å¤–è•´çŠ¶æ€ç›¸ç­‰çš„ï¼›è€Œä¸€ä¸ªå¤åˆäº«å…ƒå¯¹è±¡æ‰€å«æœ‰çš„å•çº¯äº«å…ƒå¯¹è±¡çš„å†…è•´çŠ¶æ€ä¸€èˆ¬æ˜¯ä¸ç›¸ç­‰çš„ï¼Œä¸ç„¶å°±æ²¡æœ‰ä½¿ç”¨ä»·å€¼äº†ã€‚ import java.util.Map; import java.util.HashMap; import java.util.Iterator; // å¤åˆäº«å…ƒï¼šå®ƒç”±è‹¥å¹²ä¸ª&quot;å•çº¯äº«å…ƒå¯¹è±¡&quot;ç»„æˆã€‚ public class ConcreteCompositeFlyweight extends Flyweight { private HashMap flies = new HashMap(); private Flyweight flyweight; // å¢žåŠ ä¸€ä¸ªæ–°çš„å•çº¯äº«å…ƒå¯¹è±¡åˆ°å¤åˆäº«å…ƒä¸­ public void add(Character key , Flyweight fly) { flies.put(key,fly); } // å¤–è•´çŠ¶æ€ä½œä¸ºå‚æ•°ä¼ å…¥åˆ°æ–¹æ³•ä¸­ @Override public void operation(String state) { Flyweight fly = null; for (Iterator it = flies.entrySet().iterator(); it.hasNext(); ) { Map.Entry e = (Map.Entry) it.next(); fly = (Flyweight) e.getValue(); fly.operation(state); } } } äº«å…ƒå·¥åŽ‚äº«å…ƒå·¥åŽ‚æ˜¯FlyweightFactoryç±»ã€‚ äº«å…ƒå·¥åŽ‚æä¾›ä¸¤ç§ä¸åŒçš„â€è¿”å›žæŠ½è±¡äº«å…ƒâ€çš„æ–¹æ³•ï¼Œä¸€ç§ç”¨äºŽæä¾›å•çº¯äº«å…ƒå¯¹è±¡ï¼Œå¦ä¸€ç§ç”¨äºŽæä¾›å¤åˆäº«å…ƒå¯¹è±¡ã€‚ å½“éœ€è¦å•çº¯äº«å…ƒçš„æ—¶å€™ï¼Œå°±è°ƒç”¨factory()ï¼Œå¹¶ä¼ å…¥Characterç±»åž‹çš„å‚æ•°ã€‚å½“éœ€è¦å¤åˆäº«å…ƒçš„æ—¶å€™ï¼Œå°±è°ƒç”¨factory()ï¼Œå¹¶ä¼ å…¥Stringç±»åž‹çš„å‚æ•°ã€‚ import java.util.Map; import java.util.HashMap; import java.util.Iterator; public class FlyweightFactory { private HashMap flies = new HashMap(); // åˆ›å»º&quot;å¤åˆäº«å…ƒ&quot;çš„å·¥åŽ‚æ–¹æ³• public Flyweight factory(String compositeState){ ConcreteCompositeFlyweight compositeFly = new ConcreteCompositeFlyweight(); int length = compositeState.length(); Character state = null; for (int i=0; i&lt;length; i++) { state = new Character(compositeState.charAt(i)); System.out.println(&quot;factory(&quot;+state+&quot;)&quot;); // é€šè¿‡ this.factory(state)åˆ›å»º&quot;å•çº¯äº«å…ƒ&quot;ï¼Œ // ç„¶åŽ å°†&quot;å•çº¯äº«å…ƒ&quot;æ·»åŠ åˆ°&quot;å¤åˆäº«å…ƒ&quot;ä¸­ã€‚ compositeFly.add(state, this.factory(state)); } return compositeFly; } // åˆ›å»º&quot;å•çº¯äº«å…ƒ&quot;çš„å·¥åŽ‚æ–¹æ³• public Flyweight factory(Character state){ if (flies.containsKey(state)) { return (Flyweight)flies.get(state); } else { Flyweight fly = new ConcreteFlyweight(state); flies.put(state, fly); return fly; } } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºå®¢æˆ·ç«¯æ˜¯Clientã€‚ public class Client { public static void main(String[] args) { FlyweightFactory factory = new FlyweightFactory(); String str = &quot;abcda&quot;; Flyweight com1 = factory.factory(str); Flyweight com2 = factory.factory(str); com1.operation(&quot;Composite Call&quot;); com2.operation(&quot;Composite Call&quot;); System.out.println(&quot;com1==com2:&quot;+(com1==com2)); Character c = &apos;1&apos;; Flyweight pure1 = factory.factory(c); Flyweight pure2 = factory.factory(c); pure1.operation(&quot;pure Call&quot;); pure2.operation(&quot;pure Call&quot;); System.out.println(&quot;pure1==pure2:&quot;+(pure1==pure2)); } } è¿è¡Œç»“æžœï¼š factory(a) factory(b) factory(c) factory(d) factory(a) factory(a) factory(b) factory(c) factory(d) factory(a) Intrisic State=d, Extriinsic State=Composite Call Intrisic State=b, Extriinsic State=Composite Call Intrisic State=c, Extriinsic State=Composite Call Intrisic State=a, Extriinsic State=Composite Call Intrisic State=d, Extriinsic State=Composite Call Intrisic State=b, Extriinsic State=Composite Call Intrisic State=c, Extriinsic State=Composite Call Intrisic State=a, Extriinsic State=Composite Call com1==com2:false Intrisic State=1, Extriinsic State=pure Call Intrisic State=1, Extriinsic State=pure Call ç»“æžœè¯´æ˜Žï¼šClientä¸­åˆ›å»ºä¸¤ä¸ªå¤åˆäº«å…ƒcom1å’Œcom2ï¼Œå®ƒä»¬çš„å†…å®¹éƒ½æ˜¯â€abcdaâ€ã€‚ä½†æ˜¯com1==com2:falseè¡¨æ˜Žï¼šå¤åˆäº«å…ƒæ˜¯ä¸èƒ½å¤Ÿå…±äº«çš„ã€‚Clientä¸­åˆ›å»ºä¸¤ä¸ªå•çº¯äº«å…ƒpure1å’Œpure2ï¼Œå®ƒä»¬çš„å†…å®¹éƒ½æ˜¯â€™1â€™ã€‚pure1==pure2:trueè¡¨æ˜Žï¼šå•çº¯äº«å…ƒæ˜¯å¯ä»¥å…±äº«çš„ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>äº«å…ƒæ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼11ä¹‹ ä»£ç†(Proxy)æ¨¡å¼(ç»“æž„æ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F24%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F11%E4%B9%8B-%E4%BB%A3%E7%90%86-Proxy-%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ä»£ç†æ¨¡å¼ç®€ä»‹ä»£ç†(Proxy)æ¨¡å¼æ˜¯å¯¹è±¡çš„ç»“æž„æ¨¡å¼ã€‚ä»£ç†æ¨¡å¼ç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æŽ§åˆ¶å¯¹åŽŸå¯¹è±¡çš„å¼•ç”¨ã€‚ ä¸€ä¸ªæ¯”è¾ƒå…¸åž‹çš„ä¾‹å­å°±æ˜¯â€Windowsçš„å¿«æ·æ–¹å¼â€ã€‚Windowså¿«æ·æ–¹å¼ï¼Œå¯ä»¥ä½¿ä»»ä½•å¯¹è±¡åŒæ—¶å‡ºçŽ°åœ¨å¤šä¸ªåœ°æ–¹è€Œä¸å¿…ä¿®æ”¹åŽŸå¯¹è±¡ã€‚å¯¹å¿«æ·æ–¹å¼çš„è°ƒç”¨å®Œå…¨ä¸Žå¯¹åŽŸå¯¹è±¡çš„è°ƒç”¨ä¸€æ ·ï¼Œæ¢è¨€ä¹‹ï¼Œå¿«æ·æ–¹å¼å¯¹å®¢æˆ·ç«¯æ˜¯å®Œå…¨é€æ˜Žçš„ã€‚ ä»£ç†æ¨¡å¼çš„ç±»å›¾å¦‚ä¸‹ï¼š ä»£ç†æ¨¡å¼ä¸­å…±åŒ…å«äº†ä¸‰ä¸ªè§’è‰²: æŠ½è±¡ä¸»ä½“(Subject)ï¼Œä»£ç†ä¸»é¢˜(ProxySubject)ï¼ŒçœŸå®žä¸»é¢˜(RealSubject)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡ä¸»é¢˜è§’è‰² å£°æ˜Žäº†çœŸå®žä¸»é¢˜å’Œä»£ç†ä¸»é¢˜çš„å…±åŒæŽ¥å£ï¼Œè¿™æ ·ä¸€æ¥åœ¨ä»»ä½•å¯ä»¥ä½¿ç”¨çœŸå®žä¸»é¢˜çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ä»£ç†ä¸»é¢˜ã€‚ ä»£ç†ä¸»é¢˜è§’è‰² ä»£ç†ä¸»é¢˜å†…éƒ¨å«æœ‰çœŸå®žä¸»é¢˜çš„å¼•ç”¨ï¼Œä»Žè€Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™æ“ä½œçœŸå®žä¸»é¢˜ï¼›ä»£ç†ä¸»é¢˜æä¾›ä¸€ä¸ªä¸ŽçœŸå®žä¸»é¢˜ç›¸åŒçš„æŽ¥å£ï¼Œä»¥ä¾¿å¯ä»¥åœ¨ä»»ä½•æ—¶å€™æ›¿ä»£çœŸå®žä¸»é¢˜ã€‚ä»£ç†ä¸»é¢˜é€šå¸¸åœ¨å®¢æˆ·ç«¯è°ƒç”¨ä¼ é€’ç»™çœŸå®žä¸»é¢˜ä¹‹å‰æˆ–ä¹‹åŽï¼Œæ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œè€Œä¸æ˜¯å•çº¯åœ°å°†è°ƒç”¨ä¼ é€’ç»™çœŸå®žä¸»é¢˜ã€‚ çœŸå®žä¸»é¢˜è§’è‰² å®šä¹‰äº†ä»£ç†ä¸»é¢˜æ‰€ä»£è¡¨çš„çœŸå®žä¸»é¢˜ã€‚ ç¤ºæ„ä»£ç  abstract public class Subject { // å£°æ˜Žä¸€ä¸ªæŠ½è±¡çš„è¯·æ±‚æ–¹æ³• public abstract void request(); } public class RealSubject extends Subject { @Override public void request() { System.out.println(&quot;From real subject&quot;); } } public class ProxySubject extends Subject{ RealSubject realSubject = new RealSubject(); @Override public void request() { preRequest(); realSubject.request(); postRequest(); } // è¯·æ±‚å‰çš„æ“ä½œ private void preRequest() { // something you want to do before requesting } // è¯·æ±‚åŽçš„æ“ä½œ private void postRequest() { // something you want to do after requesting } } è‹¥è¦ä½¿ç”¨ä»£ç†ä¸»é¢˜ï¼Œåˆ™å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç ï¼š Subject subject = new ProxySubject(); subject.request(); ä»Žä¸­å¯ä»¥çœ‹å‡ºä»£ç†æ¨¡å¼æ˜¯æ€Žæ ·å·¥ä½œçš„ã€‚é¦–å…ˆï¼Œä»£ç†æ¨¡å¼å¹¶ä¸æ”¹å˜ä¸»é¢˜çš„æŽ¥å£ï¼Œå› ä¸ºä»£ç†æ¨¡å¼çš„ç”¨æ„æ˜¯ä¸è®©å®¢æˆ·ç«¯æ„Ÿè§‰åˆ°ä»£ç†çš„å­˜åœ¨ï¼›å…¶æ¬¡ï¼Œä»£ç†ä½¿ç”¨å§”æ´¾å°†å®¢æˆ·ç«¯çš„è°ƒç”¨å§”æ´¾ç»™çœŸå®žçš„ä¸»é¢˜å¯¹è±¡ï¼›æ¢è¨€ä¹‹ï¼Œä»£ç†ä¸»é¢˜èµ·åˆ°çš„æ˜¯ä¸€ä¸ªä¼ é€’è¯·æ±‚çš„ä½œç”¨ã€‚æœ€åŽï¼Œä»£ç†ä¸»é¢˜åœ¨ä¼ é€’è¯·æ±‚ä¹‹å‰å’Œä¹‹åŽéƒ½å¯ä»¥æ‰§è¡Œç‰¹å®šçš„æ“ä½œï¼Œè€Œä¸æ˜¯å•çº¯çš„ä¼ é€’è¯·æ±‚ã€‚ å®ƒçš„æ—¶åºå›¾å¦‚ä¸‹ï¼š ä»£ç†æ¨¡å¼ç¤ºä¾‹ä¸‹é¢ï¼Œé€šè¿‡â€é«˜è€åº„æ‚Ÿç©ºé™å…«æˆ’â€çš„ä¾‹å­æ¥å¯¹ä»£ç†æ¨¡å¼è¿›è¡Œè¯´æ˜Žã€‚ æ‚Ÿç©ºå‡æ‰®æˆé«˜å°å§åŽ»è§çŒªå…«æˆ’ã€‚é€šè¿‡ä»£ç†æ¨¡å¼åŽ»åˆ†æžï¼Œâ€é«˜å°å§çš„ç¥žè²Œâ€æ˜¯æŠ½è±¡ä¸»é¢˜ï¼Œé«˜å°å§æœ¬äººæ˜¯çœŸå®žä¸»é¢˜ï¼Œè€Œæ‚Ÿç©ºæ˜¯ä»£ç†ä¸»é¢˜ï¼Œä»–å·§å¦™çš„å®žçŽ°äº†â€é«˜å°å§çš„ç¥žè²Œâ€ï¼›çŒªå…«æˆ’å°±æ˜¯å®¢æˆ·ç«¯ï¼ŒçŒªå…«æˆ’æ ¹æœ¬åˆ†ä¸æ¸…â€æ‚Ÿç©ºå‡æ‰®çš„é«˜å°å§â€å’Œâ€é«˜å°å§æœ¬äººâ€ã€‚ å¯¹åº”çš„ç±»å›¾å¦‚ä¸‹ï¼š ä¸‹é¢æ˜¯å„ä¸ªè§’è‰²å¯¹åº”çš„ç±»ã€‚ æŠ½è±¡ä¸»ä½“æŠ½è±¡ä¸»é¢˜æ˜¯â€é«˜å°å§çš„ç¥žè²Œâ€ï¼Œå®ƒå¯¹åº”çš„ç±»æ˜¯AbstractAppearanceã€‚ abstract public class AbstractAppearance { public abstract void smile(); } çœŸå®žä¸»é¢˜çœŸå®žä¸»é¢˜æ˜¯â€é«˜å°å§æœ¬äººâ€ï¼Œå®ƒå¯¹åº”çš„ç±»æ˜¯MissGaoã€‚ public class MissGao extends AbstractAppearance { @Override public void smile() { System.out.println(&quot;Miss Gao smiles.&quot;); } } ä»£ç†ä¸»é¢˜ä»£ç†ä¸»é¢˜æ˜¯â€æ‚Ÿç©ºâ€ï¼Œå®ƒå¯¹åº”çš„ç±»æ˜¯WuKongã€‚ public class WuKong extends AbstractAppearance { AbstractAppearance missGao = new MissGao(); @Override public void smile() { missGao.smile(); System.out.println(&quot;Actual, it&apos;s wukong smiles.&quot;); } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºå®¢æˆ·ç«¯æ˜¯â€å…«æˆ’â€ï¼Œå®ƒå¯¹åº”çš„ç±»æ˜¯BaJieã€‚ public class BaJie { public static void main(String[] args) { // å…«æˆ’åªè®¤è¯†&quot;é«˜å°å§çš„æ ·è²Œ&quot;ï¼Œè€Œè¯¥&quot;é«˜å°å§çš„æ ·è²Œ&quot;å®žé™…ä¸Šæ˜¯æ‚Ÿç©ºå‡æ‰®çš„ã€‚ AbstractAppearance appearance = new WuKong(); appearance.smile(); } } è¿è¡Œç»“æžœï¼š Miss Gao smiles. Actual, it&apos;s wukong smiles.]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ä»£ç†æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼10ä¹‹ è£…é¥°(Decorator)æ¨¡å¼(ç»“æž„æ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F23%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F10%E4%B9%8B-%E8%A3%85%E9%A5%B0-Decorator-%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[è£…é¥°æ¨¡å¼ç®€ä»‹è£…é¥°(Decorator)æ¨¡å¼åˆååŒ…è£…(Wrapper)æ¨¡å¼ã€‚è£…é¥°æ¨¡å¼ä»¥å¯¹å®¢æˆ·ç«¯é€æ˜Žçš„æ–¹å¼æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œæ˜¯ç»§æ‰¿å…³ç³»çš„ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆã€‚ å®ƒä»¥å¯¹å®¢æˆ·é€æ˜Žçš„æ–¹å¼åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡é™„åŠ ä¸Šæ›´å¤šçš„è´£ä»»ã€‚æ¢è¨€ä¹‹ï¼Œå®¢æˆ·ç«¯å¹¶ä¸ä¼šè§‰å¾—å¯¹è±¡åœ¨è£…é¥°å‰å’Œè£…é¥°åŽæœ‰ä»€ä¹ˆä¸åŒã€‚è£…é¥°æ¨¡å¼å¯ä»¥åœ¨ä¸ä½¿ç”¨åˆ›é€ æ›´å¤šå­ç±»çš„æƒ…å†µä¸‹ï¼Œå°†å¯¹è±¡çš„åŠŸèƒ½åŠ ä»¥æ‰©å±•ã€‚ è£…é¥°æ¨¡å¼çš„ç±»å›¾å¦‚ä¸‹ï¼š è£…é¥°æ¨¡å¼åŒ…å«äº†ä¸‰ä¸ªè§’è‰²: æŠ½è±¡æž„ä»¶(Component)ï¼Œå…·ä½“æž„ä»¶(ConcreteComponent) ï¼Œè£…é¥°(Decorator) å’Œ å…·ä½“è£…é¥°(ConcreteDecorator)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡æž„ä»¶(Component) ç»™å‡ºä¸€ä¸ªæŠ½è±¡æŽ¥å£ï¼Œä»¥è§„èŒƒå‡†å¤‡æŽ¥æ”¶é™„åŠ è´£ä»»çš„å¯¹è±¡ã€‚ å…·ä½“æž„ä»¶(ConcreteComponent) å®šä¹‰ä¸€ä¸ªå°†è¦æŽ¥æ”¶é™„åŠ è´£ä»»çš„ç±»ã€‚ è£…é¥°(Decorator) æŒæœ‰ä¸€ä¸ªæž„ä»¶(Component)å¯¹è±¡çš„å®žä¾‹ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªä¸ŽæŠ½è±¡æž„ä»¶æŽ¥å£ä¸€è‡´çš„æŽ¥å£ã€‚ å…·ä½“è£…é¥°(ConcreteDecorator) è´Ÿè´£ç»™æž„ä»¶å¯¹è±¡â€œè´´ä¸Šâ€é™„åŠ çš„è´£ä»»ã€‚ ç¤ºæ„ä»£ç  public interface Component { // å•†ä¸šæ–¹æ³• public void sampleOperation(); } public class ConcreteComponent implements Component { // æž„é€ å‡½æ•° public ConcreteComponent() { // write your code here } @Override public void sampleOperation() { // å†™ç›¸å…³çš„ä¸šåŠ¡ä»£ç  } } public class Decorator implements Component{ private Component component; // æž„é€ å‡½æ•° public Decorator(Component component){ // write your code here } // æž„é€ å‡½æ•° public Decorator(Component component){ this.component = component; } @Override public void sampleOperation() { // å•†ä¸šæ–¹æ³•ï¼Œå§”æ´¾ç»™æž„ä»¶ component.sampleOperation(); } } public class ConcreteDecorator extends Decorator { @Override public void sampleOperation() { super.sampleOperation(); // write your code here } } éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼š(01) åœ¨è£…é¥°ç±»Decoratorä¸­ï¼Œæœ‰ä¸€ä¸ªç§æœ‰æ ‘å½¢componentï¼Œå…¶æ•°æ®ç»“æž„æ˜¯æž„ä»¶(Component)ã€‚(02) è£…é¥°ç±»Decoratorå®žçŽ°äº†æž„ä»¶(Component)æŽ¥å£ã€‚(03) Decoratorç±»ä¸­ï¼ŒæŽ¥å£çš„æ¯ä¸€ä¸ªå®žçŽ°æ–¹æ³•éƒ½å§”æ´¾ç»™çˆ¶ç±»ï¼Œä½†å¹¶ä¸å•çº¯åœ°å§”æ´¾ï¼Œè€Œæ˜¯æœ‰åŠŸèƒ½çš„å¢žå¼ºã€‚ è£…é¥°æ¨¡å¼ç¤ºä¾‹ä¸‹é¢ï¼Œé€šè¿‡â€é½å¤©å¤§åœ£â€çš„ä¾‹å­æ¥å¯¹è£…é¥°æ¨¡å¼è¿›è¡Œè¯´æ˜Žã€‚ å­™æ‚Ÿç©ºæœ‰ä¸ƒåäºŒèˆ¬å˜åŒ–ï¼Œä»–çš„æ¯ä¸€ç§å˜åŒ–éƒ½ç»™ä»–å¸¦æ¥ä¸€ç§é™„åŠ çš„æœ¬é¢†ã€‚ä»–å˜æˆé±¼å„¿æ—¶ï¼Œå°±å¯ä»¥åˆ°æ°´é‡Œæ¸¸æ³³ï¼›ä»–å˜æˆé¸Ÿå„¿æ—¶ï¼Œå°±å¯ä»¥åœ¨å¤©ä¸Šé£žè¡Œã€‚ åœ¨è£…é¥°æ¨¡å¼ä¸­ï¼ŒComponentçš„è§’è‰²ä¾¿ç”±é¼Žé¼Žå¤§åçš„é½å¤©å¤§åœ£æ‰®æ¼”ï¼›ConcreteComponentçš„è§’è‰²å±žäºŽå¤§åœ£çš„æœ¬å°Šï¼Œå°±æ˜¯çŒ¢ç‹²æœ¬äººï¼›Decoratorçš„è§’è‰²ç”±å¤§åœ£çš„ä¸ƒåäºŒå˜æ‰®æ¼”ã€‚è€ŒConcreteDecoratorçš„è§’è‰²ä¾¿æ˜¯èŠ±ã€é¸Ÿã€é±¼ã€è™«ç­‰ä¸ƒåäºŒèˆ¬å˜åŒ–ã€‚å®ƒçš„ç±»å›¾å¦‚ä¸‹ï¼š ç¤ºä¾‹ä»£ç  æŠ½è±¡æž„ä»¶(Component)æŠ½è±¡æž„ä»¶æ˜¯â€é½å¤©å¤§åœ£â€ï¼Œå®ƒåŒ…è¡Œäº†move()æŽ¥å£ã€‚ abstract public class GreatSage { public abstract void move(); } å…·ä½“æž„ä»¶(ConcreteComponent)å…·ä½“æž„ä»¶å±žäºŽå¤§åœ£çš„æœ¬å°Šï¼Œå°±æ˜¯å­™æ‚Ÿç©ºã€‚ public class Monkey extends GreatSage { @Override public void move() { System.out.println(&quot;Monkey Move&quot;); } } è£…é¥°(Decorator)è£…é¥°ç”±å¤§åœ£çš„ä¸ƒåäºŒå˜æ‰®æ¼”ã€‚ public class Change extends GreatSage { private GreatSage sage; public Change(GreatSage sage){ this.sage = sage; } @Override public void move() { sage.move(); } } å…·ä½“è£…é¥°(ConcreteDecorator)ã€‚èŠ± public class Flower extends Change { public Flower(GreatSage sage) { super(sage); } @Override public void move() { System.out.println(&quot;Flower Move&quot;); } } é¸Ÿ public class Bird extends Change { public Bird(GreatSage sage) { super(sage); } @Override public void move() { System.out.println(&quot;Bird Move&quot;); } } é±¼ public class Fish extends Change { public Fish(GreatSage sage) { super(sage); } @Override public void move() { System.out.println(&quot;Fish Move&quot;); } } è™« public class Insect extends Change { public Insect(GreatSage sage) { super(sage); } @Override public void move() { System.out.println(&quot;Insect Move&quot;); } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºpublic class Client { public static void main(String[] args) { GreatSage sage = new Monkey(); // 1. &quot;é½å¤©å¤§åœ£&quot; sage.move(); // 2. &quot;é½å¤©å¤§åœ£&quot;å˜æˆ&quot;é¸Ÿ&quot;ä¹‹åŽï¼Œå†å˜æˆ&quot;é±¼&quot; GreatSage bird = new Bird(sage); GreatSage fish = new Fish(bird); fish.move(); // 3. &quot;é½å¤©å¤§åœ£&quot;å˜æˆ&quot;æ˜†è™«&quot;ä¹‹åŽï¼Œå†å˜æˆ&quot;èŠ±&quot; GreatSage flower = new Flower(new Insect(sage)); flower.move(); } } è¿è¡Œç»“æžœï¼š Monkey Move Fish Move Flower Move ç»“æžœè¯´æ˜Žï¼šä¸Šé¢çš„ä¾‹å­çš„2ä¸­ï¼Œç³»ç»ŸæŠŠå¤§åœ£ä»Žä¸€åªçŒ¢ç‹²è£…é¥°æˆäº†ä¸€åªé¸Ÿå„¿ï¼ˆæŠŠé¸Ÿå„¿çš„åŠŸèƒ½åŠ åˆ°äº†çŒ¢ç‹²èº«ä¸Šï¼‰ï¼Œç„¶åŽåˆæŠŠé¸Ÿå„¿è£…é¥°æˆäº†ä¸€æ¡é±¼å„¿ï¼ˆæŠŠé±¼å„¿çš„åŠŸèƒ½åŠ åˆ°äº†çŒ¢ç‹²+é¸Ÿå„¿èº«ä¸Šï¼Œå¾—åˆ°äº†çŒ¢ç‹²+é¸Ÿå„¿+é±¼å„¿ï¼‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è£…é¥°æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼09ä¹‹ åˆæˆ(Composite)æ¨¡å¼(ç»“æž„æ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F22%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F09%E4%B9%8B-%E5%90%88%E6%88%90-Composite-%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[åˆæˆæ¨¡å¼ç®€ä»‹åˆæˆæ¨¡å¼å±žäºŽå¯¹è±¡çš„ç»“æž„åž‹æ¨¡å¼ï¼Œæœ‰æ—¶åˆè¢«ç§°ä¸ºâ€éƒ¨åˆ†-æ•´ä½“æ¨¡å¼â€ã€‚åˆæˆæ¨¡å¼å°†å¯¹è±¡ç»„ç»‡åˆ°æ ‘ç»“æž„ä¸­ï¼Œå¯ä»¥ç”¨æ¥æè¿°æ•´ä½“ä¸Žéƒ¨åˆ†çš„å…³ç³»ã€‚ ä¾‹å¦‚ï¼Œæ–‡ä»¶ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªå…¸åž‹çš„åˆæˆæ¨¡å¼ç³»ç»Ÿã€‚åˆæˆæ¨¡å¼çš„æ ‘å½¢å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å®ƒçš„UMLç±»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å®ƒå…±åŒ…æ‹¬3ä¸ªè§’è‰²ï¼šæŠ½è±¡æž„ä»¶(Component)ï¼Œæ ‘å¶æž„ä»¶(Leaf) å’Œ æ ‘æžæž„ä»¶(Composite)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡æž„ä»¶ è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œå®ƒç»™å‚åŠ ç»„åˆçš„å¯¹è±¡è§„å®šä¸€ä¸ªæŽ¥å£ã€‚è¿™ä¸ªè§’è‰²ç»™å‡ºå…±æœ‰çš„æŽ¥å£åŠå…¶é»˜è®¤è¡Œä¸ºã€‚ æ ‘å¶æž„ä»¶ ä»£è¡¨å‚åŠ ç»„åˆçš„æ ‘å¶å¯¹è±¡ã€‚æ ‘å¶å¯¹è±¡æ²¡æœ‰ä¸‹çº§å­å¯¹è±¡ï¼Œå®ƒå®šä¹‰å‡ºå‚åŠ ç»„åˆçš„åŽŸå§‹å¯¹è±¡çš„è¡Œä¸ºã€‚ æ ‘æžæž„ä»¶ ä»£è¡¨å‚åŠ ç»„åˆçš„æœ‰ä¸‹çº§å­å¯¹è±¡çš„å¯¹è±¡ï¼Œå¹¶ç»™å‡ºæ ‘æžæž„ä»¶å¯¹è±¡çš„è¡Œä¸ºã€‚ æ ¹æ®â€å‚åŠ ç»„åˆçš„å¯¹è±¡çš„ç®¡ç†æ–¹å¼â€ï¼Œå¯ä»¥å°†åˆæˆæ¨¡å¼åˆ†ä¸ºä¸¤ç§ä¸åŒçš„å½¢å¼ï¼šå®‰å…¨åˆæˆæ¨¡å¼ å’Œ é€æ˜Žåˆæˆæ¨¡å¼ã€‚â€¢ å®‰å…¨åˆæˆæ¨¡å¼ï¼šæ­¤æ–¹å¼åªå…è®¸â€æ ‘æžæž„ä»¶â€æœ‰å¯¹è±¡çš„ç®¡ç†æ–¹æ³•ã€‚â€¢ é€æ˜Žåˆæˆæ¨¡å¼ï¼šæ­¤æ–¹å¼åªå…è®¸â€æ ‘æžæž„ä»¶â€™å’Œâ€æ ‘å¶æž„ä»¶â€éƒ½æœ‰å¯¹è±¡çš„ç®¡ç†æ–¹æ³•ï¼Œä½†â€æ ‘å¶æž„ä»¶â€ä¸­çš„ç®¡ç†æ–¹æ³•æ— å®žé™…æ„ä¹‰ã€‚ å®‰å…¨åˆæˆæ¨¡å¼å®‰å…¨åˆæˆæ¨¡å¼è¦æ±‚ç®¡ç†èšé›†çš„æ–¹æ³•åªå‡ºçŽ°åœ¨æ ‘æžæž„ä»¶ç±»ä¸­ï¼Œè€Œä¸å‡ºçŽ°åœ¨æ ‘å¶æž„ä»¶ç±»ä¸­ã€‚ å®‰å…¨åˆæˆæ¨¡å¼çš„UMLå›¾å¦‚ä¸‹ï¼š å®ƒå…±åŒ…æ‹¬3ä¸ªè§’è‰²ï¼šæŠ½è±¡æž„ä»¶(Component)ï¼Œæ ‘å¶æž„ä»¶(Leaf) å’Œ æ ‘æžæž„ä»¶(Composite)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡æž„ä»¶ è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œå®ƒç»™å‚åŠ ç»„åˆçš„å¯¹è±¡å®šä¹‰å‡ºå…¬å…±çš„æŽ¥å£åŠå…¶é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥ç”¨æ¥ç®¡ç†æ‰€æœ‰çš„å­å¯¹è±¡ã€‚åˆæˆå¯¹è±¡é€šå¸¸æŠŠå®ƒæ‰€åŒ…å«çš„å­å¯¹è±¡å½“åšç±»åž‹ä¸ºComponentçš„å¯¹è±¡ã€‚åœ¨å®‰å…¨å¼çš„åˆæˆæ¨¡å¼é‡Œï¼Œæž„ä»¶è§’è‰²å¹¶ä¸å®šä¹‰å‡ºç®¡ç†å­å¯¹è±¡çš„æ–¹æ³•ï¼Œè¿™ä¸€å®šä¹‰ç”±æ ‘æžæž„ä»¶å¯¹è±¡ç»™å‡ºã€‚ æ ‘å¶æž„ä»¶ æ ‘å¶å¯¹è±¡æ˜¯æ²¡æœ‰ä¸‹çº§å­å¯¹è±¡çš„å¯¹è±¡ï¼Œå®šä¹‰å‡ºå‚åŠ ç»„åˆçš„åŽŸå§‹å¯¹è±¡çš„è¡Œä¸ºã€‚ æ ‘æžæž„ä»¶ ä»£è¡¨å‚åŠ ç»„åˆçš„æœ‰ä¸‹çº§å­å¯¹è±¡çš„å¯¹è±¡ã€‚æ ‘æžæž„ä»¶ç±»ç»™å‡ºæ‰€æœ‰çš„ç®¡ç†å­å¯¹è±¡çš„æ–¹æ³•ï¼Œå¦‚add()ã€remove()ä»¥åŠgetChild()ã€‚ ç¤ºä¾‹ä»£ç  public interface Component { // è¿”è¿˜è‡ªå·±çš„ç¤ºä¾‹ Composite getComposite(); // æŸä¸ªå•†ä¸šæ–¹æ³• void sampleOperation(); } public class Composite implements Component { private Vector componentVector = new Vector(); public Composite getComposite() { return this; } public void sampleOperation() { Enumeration enum = composites(); while (enum.hasMoreElements()) { ((Composite)enum.nextElement()).sampleOperation(); } } // æ·»åŠ ä¸€ä¸ªå­æž„ä»¶å¯¹è±¡ public void add(Component component) { componentVector.addElement(component); } // åˆ é™¤ä¸€ä¸ªå­æž„ä»¶å¯¹è±¡ public void remove(Component component) { componentVector.removeElement(component); } // èšé›†ç®¡ç†åŠžæ³•ï¼Œè¿”è¿˜èšé›†çš„Enumerationå¯¹è±¡ public Enumeration components() { return componentVector.elements(); } } public class Leaf implements Component { public void sampleOperation() { } public Composite getComposite() { return null; } } ä»Žä¸­å¯ä»¥çœ‹å‡ºï¼Œæ ‘å¶æž„å»º(Leaf)ä¸­æ²¡æœ‰å¯¹èŠ‚ç‚¹çš„ç®¡ç†æ–¹æ³•ï¼Œè€Œåªæœ‰æ ‘æžæž„å»º(Composite)ä¸­æœ‰èŠ‚ç‚¹çš„ç®¡ç†æ–¹æ³•ã€‚ é€æ˜Žåˆæˆæ¨¡å¼ä¸Žå®‰å…¨å¼çš„åˆæˆæ¨¡å¼ä¸åŒçš„æ˜¯ï¼Œé€æ˜Žå¼çš„åˆæˆæ¨¡å¼è¦æ±‚æ‰€æœ‰çš„å…·ä½“æž„ä»¶ç±»ï¼Œä¸è®ºæ ‘æžæž„ä»¶è¿˜æ˜¯æ ‘å¶æž„ä»¶ï¼Œå‡ç¬¦åˆä¸€ä¸ªå›ºå®šæŽ¥å£ã€‚ é€æ˜Žåˆæˆæ¨¡å¼çš„UMLå›¾å¦‚ä¸‹ï¼š å®ƒå…±åŒ…æ‹¬3ä¸ªè§’è‰²ï¼šæŠ½è±¡æž„ä»¶(Component)ï¼Œæ ‘å¶æž„ä»¶(Leaf) å’Œ æ ‘æžæž„ä»¶(Composite)ã€‚ è§’è‰² è¯´æ˜Ž æŠ½è±¡æž„ä»¶ è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œå®ƒç»™å‚åŠ ç»„åˆçš„å¯¹è±¡è§„å®šä¸€ä¸ªæŽ¥å£ï¼Œè§„èŒƒå…±æœ‰çš„æŽ¥å£åŠé»˜è®¤è¡Œä¸ºã€‚è¿™ä¸ªæŽ¥å£å¯ä»¥ç”¨æ¥ç®¡ç†æ‰€æœ‰çš„å­å¯¹è±¡ï¼Œè¦æä¾›ä¸€ä¸ªæŽ¥å£ä»¥è§„èŒƒå–å¾—å’Œç®¡ç†ä¸‹å±‚ç»„ä»¶çš„æŽ¥å£ï¼ŒåŒ…æ‹¬add(), remove()ä»¥åŠgetChild()ä¹‹ç±»çš„æ–¹æ³•ã€‚ æ ‘å¶æž„ä»¶ ä»£è¡¨å‚åŠ ç»„åˆçš„æ ‘å¶å¯¹è±¡ï¼Œå®šä¹‰å‡ºå‚åŠ ç»„åˆçš„åŽŸå§‹å¯¹è±¡çš„è¡Œä¸ºã€‚æ ‘å¶ç±»ä¼šç»™å‡ºadd(), remove()ä»¥åŠgetChild()ä¹‹ç±»çš„ç”¨æ¥ç®¡ç†å­ç±»å¯¹è±¡çš„æ–¹æ³•çš„å¹³åº¸å®žçŽ°ã€‚ æ ‘æžæž„ä»¶ ä»£è¡¨å‚åŠ ç»„åˆçš„æœ‰å­å¯¹è±¡çš„å¯¹è±¡ï¼Œå®šä¹‰å‡ºè¿™æ ·çš„å¯¹è±¡çš„è¡Œä¸ºã€‚ ç¤ºä¾‹ä»£ç  public interface Component { // æŸä¸ªå•†ä¸šæ–¹æ³• void sampleOperation(); // è¿”è¿˜è‡ªå·±çš„ç¤ºä¾‹ Composite getComposite(); // èšé›†ç®¡ç†æ–¹æ³•ï¼Œå¢žåŠ å­æž„ä»¶å¯¹è±¡ void add(Component component); // èšé›†ç®¡ç†æ–¹æ³•ï¼Œåˆ é™¤å­æž„ä»¶å¯¹è±¡ void remove(Component component); // èšé›†ç®¡ç†åŠžæ³•ï¼Œè¿”è¿˜èšé›†çš„Enumerationå¯¹è±¡ Enumeration components(); } public class Composite implements Component { private Vector componentVector = new Vector(); public Composite getComposite() { return this; } public void sampleOperation() { Enumeration enum = composites(); while (enum.hasMoreElements()) { ((Composite)enum.nextElement()).sampleOperation(); } } // æ·»åŠ ä¸€ä¸ªå­æž„ä»¶å¯¹è±¡ public void add(Component component) { componentVector.addElement(component); } // åˆ é™¤ä¸€ä¸ªå­æž„ä»¶å¯¹è±¡ public void remove(Component component) { componentVector.removeElement(component); } // èšé›†ç®¡ç†åŠžæ³•ï¼Œè¿”è¿˜èšé›†çš„Enumerationå¯¹è±¡ public Enumeration components() { return componentVector.elements(); } } public class Leaf implements Component { public void sampleOperation() { } public Composite getComposite() { return null; } // æ·»åŠ ä¸€ä¸ªå­æž„ä»¶å¯¹è±¡ public void add(Component component) { } // åˆ é™¤ä¸€ä¸ªå­æž„ä»¶å¯¹è±¡ public void remove(Component component) { } // èšé›†ç®¡ç†åŠžæ³•ï¼Œè¿”è¿˜èšé›†çš„Enumerationå¯¹è±¡ public Enumeration components() { return null; } } åˆæˆæ¨¡å¼ç¤ºä¾‹ä¸‹é¢ä»¥ä¸€ä¸ªé€»è¾‘æ ‘ä¸ºä¾‹å­ï¼Œæ¼”ç¤ºåˆæˆæ¨¡å¼ã€‚ æŠ½è±¡æž„ä»¶(IFile.java)public interface IFile { //è¿”å›žè‡ªå·±çš„å®žä¾‹ IFile getComposite(); //æŸä¸ªå•†ä¸šæ–¹æ³• void sampleOperation(); //èŽ·å–æ·±åº¦ int getDeep(); //è®¾ç½®æ·±åº¦ void setDeep(int x); } æ ‘æžæž„ä»¶(Folder.java)import java.util.Vector; public class Folder implements IFile { private String name; //æ–‡ä»¶åå­— private int deep; //å±‚çº§æ·±åº¦ï¼Œæ ¹æ·±åº¦ä¸º0 private Vector&lt;IFile&gt; componentVector = new Vector&lt;IFile&gt;(); public Folder(String name) { this.name = name; } //è¿”å›žè‡ªå·±çš„å®žä¾‹ public IFile getComposite() { return this; } //æŸä¸ªå•†ä¸šæ–¹æ³• public void sampleOperation() { System.out.println(&quot;æ‰§è¡Œäº†æŸä¸ªå•†ä¸šæ–¹æ³•ï¼&quot;); } //å¢žåŠ ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ public void add(IFile IFile) { componentVector.addElement(IFile); IFile.setDeep(this.deep + 1); } //åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ public void remove(IFile IFile) { componentVector.removeElement(IFile); } //è¿”å›žç›´æŽ¥å­æ–‡ä»¶ï¼ˆå¤¹ï¼‰é›†åˆ public Vector getAllComponent() { return componentVector; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getDeep() { return deep; } public void setDeep(int deep) { this.deep = deep; } } æ ‘æžæž„ä»¶(File.java)public class File implements IFile { private String name; //æ–‡ä»¶åå­— private int deep; //å±‚çº§æ·±åº¦ public File(String name) { this.name = name; } //è¿”å›žè‡ªå·±çš„å®žä¾‹ public IFile getComposite() { return this; } //æŸä¸ªå•†ä¸šæ–¹æ³• public void sampleOperation() { System.out.println(&quot;æ‰§è¡Œäº†æŸä¸ªå•†ä¸šæ–¹æ³•ï¼&quot;); } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getDeep() { return deep; } public void setDeep(int deep) { this.deep = deep; } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åº(Client.java)import java.util.Iterator; import java.util.Vector; import java.util.Collections; public class Client { private static final String INDENT_CHAR = &quot;\t&quot;; //æ–‡ä»¶å±‚æ¬¡ç¼©è¿›å­—ç¬¦ public static void main(String args[]) { new Client().test(); } /** * å®¢æˆ·ç«¯æµ‹è¯•æ–¹æ³• */ public void test() { //æ ¹ä¸‹æ–‡ä»¶åŠæ–‡ä»¶å¤¹ Folder root = new Folder(&quot;æ ‘æ ¹&quot;); Folder b1_1 = new Folder(&quot;1_æž1&quot;); Folder b1_2 = new Folder(&quot;1_æž2&quot;); Folder b1_3 = new Folder(&quot;1_æž3&quot;); File l1_1 = new File(&quot;1_å¶1&quot;); File l1_2 = new File(&quot;1_å¶2&quot;); File l1_3 = new File(&quot;1_å¶3&quot;); //b1_2ä¸‹çš„æ–‡ä»¶åŠæ–‡ä»¶å¤¹ Folder b2_1 = new Folder(&quot;2_æž1&quot;); Folder b2_2 = new Folder(&quot;2_æž2&quot;); File l2_1 = new File(&quot;2_å¶1&quot;); //ç¼”é€ æ ‘çš„å±‚æ¬¡å…³ç³»ï¼ˆç®€å•æµ‹è¯•ï¼Œæ²¡æœ‰é‡å¤æ·»åŠ çš„æŽ§åˆ¶ï¼‰ root.add(b1_1); root.add(b1_2); root.add(l1_1); root.add(l1_2); b1_2.add(b2_1); b1_2.add(b2_2); b1_2.add(l2_1); root.add(l1_3); root.add(b1_3); //æŽ§åˆ¶å°æ‰“å°æ ‘çš„å±‚æ¬¡ outTree(root); } public void outTree(Folder folder) { System.out.println(folder.getName()); iterateTree(folder); } /** * éåŽ†æ–‡ä»¶å¤¹ï¼Œè¾“å…¥æ–‡ä»¶æ ‘ * * @param folder */ public void iterateTree(Folder folder) { Vector&lt;IFile&gt; clist = folder.getAllComponent(); for (Iterator&lt;IFile&gt; it = clist.iterator(); it.hasNext();) { IFile em = it.next(); if (em instanceof Folder) { Folder cm = (Folder) em; System.out.println(getIndents(em.getDeep()) + cm.getName()); iterateTree(cm); } else { System.out.println(getIndents(em.getDeep()) + ((File) em).getName()); } } } /** * æ–‡ä»¶å±‚æ¬¡ç¼©è¿›å­—ç¬¦ä¸² * * @param x ç¼©è¿›å­—ç¬¦ä¸ªæ•° * @return ç¼©è¿›å­—ç¬¦ä¸² */ public static String getIndents(int x) { StringBuilder sb = new StringBuilder(); for (int i = 0; i &lt; x; i++) { sb.append(INDENT_CHAR); } return sb.toString(); } } è¿è¡Œç»“æžœï¼š æ ‘æ ¹ 1_æž1 1_æž2 2_æž1 2_æž2 2_å¶1 1_å¶1 1_å¶2 1_å¶3 1_æž3]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>åˆæˆæ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼08ä¹‹ é€‚é…å™¨(Adapter)æ¨¡å¼(ç»“æž„æ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F21%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F08%E4%B9%8B-%E9%80%82%E9%85%8D%E5%99%A8-Adapter-%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[åŽŸåž‹æ¨¡å¼ç®€ä»‹åŽŸåž‹æ¨¡å¼æ˜¯â€åˆ›å»ºæ¨¡å¼â€(åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼)ã€‚é€šè¿‡ç»™å‡ºä¸€ä¸ªåŽŸåž‹å¯¹è±¡æ¥æŒ‡æ˜Žæ‰€è¦åˆ›å»ºçš„å¯¹è±¡çš„ç±»åž‹ï¼Œç„¶åŽç”¨å¤åˆ¶è¿™ä¸ªåŽŸåž‹å¯¹è±¡çš„åŠžæ³•åˆ›å»ºå‡ºæ›´å¤šåŒç±»åž‹çš„å¯¹è±¡ã€‚ Javaè¯­è¨€çš„æ”¯æŒæ”¯æŒåˆ›å»ºæ¨¡å¼ã€‚åœ¨Javaä¸­Objectæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ï¼Œè€ŒObjectä¸­æä¾›äº†clone()æ–¹æ³•ã€‚clone()ä¼šé€šè¿‡è°ƒç”¨æœ¬åœ°æ–¹æ³•å®žçŽ°å¯¹è±¡çš„å¤åˆ¶ã€‚å®ƒçš„æºç å¦‚ä¸‹ï¼š protected native Object clone() throws CloneNotSupportedException; clone()å®šä¹‰äº†Objectä¸­ï¼Œå°±ç›¸å½“äºŽJavaä¸­çš„ä»»ä½•ç±»éƒ½ç»§æ‰¿äº†clone()æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¦‚æžœè¦ç±»æ”¯æŒå…‹éš†çš„è¯ï¼Œå¿…é¡»è¦å£°æ˜Žè¯¥ç±»å®žçŽ°äº†CloneableæŽ¥å£ã€‚å¦åˆ™ï¼Œè°ƒç”¨è¯¥ç±»çš„clone()æ–¹æ³•æ—¶ï¼Œä¼šæŠ›å‡ºCloneNotSupportedExceptionå¼‚å¸¸ã€‚ ä½¿ç”¨åœºæ™¯: ç³»ç»Ÿçš„äº§å“æ˜¯åŠ¨æ€åŠ è½½çš„ï¼Œè€Œäº§å“ç±»å…·æœ‰ä¸€å®šçš„ç­‰çº§ç»“æž„ã€‚ ä¾‹å¦‚ï¼Œæ•°æ®åº“ä¸­å­˜å‚¨äº†å¾ˆå¤šæ•°æ®ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦å°†å…¶ä¸­çš„ä¸€äº›æ•°æ®å–å‡ºæ¥å­˜æ”¾åˆ°æ–°çš„è¡¨æ ¼ä¸­ã€‚æˆ–è€…ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹æ¯”ä¸€ä¸ªå¯¹è±¡åœ¨å¤„ç†å‰/åŽçš„å§¿æ€ï¼›åœ¨å¤„ç†ä¹‹å‰ï¼Œå¯ä»¥å…‹éš†è¯¥å¯¹è±¡ï¼Œç„¶åŽå’Œå¤„ç†ä¹‹åŽçš„å¯¹è±¡æ¯”è¾ƒã€‚ åŽŸåž‹æ¨¡å¼æœ‰ä¸¤ç§è¡¨çŽ°å½¢å¼ï¼šç®€å•å½¢å¼ å’Œ ç™»è®°å½¢å¼ã€‚å¦‚æžœéœ€è¦åˆ›å»ºçš„åŽŸåž‹å¯¹è±¡æ•°ç›®å°‘è€Œä¸”æ¯”è¾ƒå›ºå®šçš„åŽï¼Œå°±é‡‡ç”¨â€ç®€å•å½¢å¼â€ï¼›å¦‚æžœè¦åˆ›å»ºçš„åŽŸåž‹å¯¹è±¡æ•°ç›®ä¸ç¡®å®šçš„åŽï¼Œå°±é‡‡ç”¨â€ç™»è®°å½¢å¼â€ã€‚ ç®€å•å½¢å¼çš„åŽŸåž‹æ¨¡å¼ç±»å›¾ å®ƒæ¶‰åŠåˆ°3ä¸ªè§’è‰²ï¼šå®¢æˆ·(Client), æŠ½è±¡åŽŸåž‹(Prototype) å’Œ å…·ä½“åŽŸåž‹(ConcretePrototype)ã€‚ è§’è‰² è¯´æ˜Ž Client å®¢æˆ·ç±»æå‡ºåˆ›å»ºå¯¹è±¡çš„è¯·æ±‚ã€‚ Prototype æŠ½è±¡åŽŸåž‹ç»™å‡ºæ‰€æœ‰çš„å…·ä½“åŽŸåž‹æ‰€éœ€è¦å®žçŽ°çš„å‡½æ•°æŽ¥å£ã€‚ ConcreteType è¢«å¤åˆ¶çš„å¯¹è±¡ï¼Œå®žçŽ°äº†Prototypeä¸­çš„å‡½æ•°æŽ¥å£ã€‚ ä»£ç æ¨¡åž‹ public interface Prototype extends Cloneable { Prototype clone(); } public class ConcretePrototype implements Prototype { public Object clone() { try { return super.clone(); } catch (CloneNotSupportedException e) { return null; } } } public class Client { private Prototype prototype; public void operation(Prototype example) { Prototype p = (Prototype) example.clone(); } } ç™»è®°å½¢å¼çš„åŽŸåž‹æ¨¡å¼UMLç±»å›¾ å®ƒæ¶‰åŠåˆ°4ä¸ªè§’è‰²ï¼šå®¢æˆ·(Client), æŠ½è±¡åŽŸåž‹(Prototype), å…·ä½“åŽŸåž‹(ConcretePrototype) å’Œ PrototypeManager(åŽŸåž‹ç®¡ç†å™¨)ã€‚ è§’è‰² è¯´æ˜Ž Client å®¢æˆ·ç±»æå‡ºåˆ›å»ºå¯¹è±¡çš„è¯·æ±‚ã€‚ Prototype æŠ½è±¡åŽŸåž‹ç»™å‡ºæ‰€æœ‰çš„å…·ä½“åŽŸåž‹æ‰€éœ€è¦å®žçŽ°çš„å‡½æ•°æŽ¥å£ã€‚ ConcreteType è¢«å¤åˆ¶çš„å¯¹è±¡ï¼Œå®žçŽ°äº†Prototypeä¸­çš„å‡½æ•°æŽ¥å£ã€‚ PrototypeManager åˆ›å»ºå…·ä½“åŽŸåž‹ç±»çš„å¯¹è±¡ï¼Œå¹¶è®°å½•æ¯ä¸€ä¸ªè¢«åˆ›å»ºçš„å¯¹è±¡ã€‚ ä»£ç æ¨¡åž‹ public interface Prototype extends Cloneable { Prototype clone(); } public class ConcretePrototype implements Prototype { public synchronized Object clone() { Prototype temp = null; try { temp = (Prototype)super.clone(); return temp; } catch (CloneNotSupportedException e) { return null; } finally { return temp; } } } public class PrototypeManager { private Vector objects = new Vector(); public void add(Prototype object) { objects.add(object); } public Prototype get(int i) { return (Prototype) objects.get(i); } public int getSize() { return objects.size(); } } public class Client { private PrototypeManager mgr; private Prototype prototype; public void registerPrototype() { prototype = new ConcretePrototype(); Prototype copytype = (Prototype)prototype.clone(); mgr.add(copytype); } }]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>åŽŸåž‹æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼07ä¹‹ åŽŸåž‹æ¨¡å¼(åˆ›å»ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F20%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F07%E4%B9%8B-%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[åŽŸåž‹æ¨¡å¼ç®€ä»‹åŽŸåž‹æ¨¡å¼æ˜¯â€åˆ›å»ºæ¨¡å¼â€(åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼)ã€‚é€šè¿‡ç»™å‡ºä¸€ä¸ªåŽŸåž‹å¯¹è±¡æ¥æŒ‡æ˜Žæ‰€è¦åˆ›å»ºçš„å¯¹è±¡çš„ç±»åž‹ï¼Œç„¶åŽç”¨å¤åˆ¶è¿™ä¸ªåŽŸåž‹å¯¹è±¡çš„åŠžæ³•åˆ›å»ºå‡ºæ›´å¤šåŒç±»åž‹çš„å¯¹è±¡ã€‚ Javaè¯­è¨€çš„æ”¯æŒæ”¯æŒåˆ›å»ºæ¨¡å¼ã€‚åœ¨Javaä¸­Objectæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ï¼Œè€ŒObjectä¸­æä¾›äº†clone()æ–¹æ³•ã€‚clone()ä¼šé€šè¿‡è°ƒç”¨æœ¬åœ°æ–¹æ³•å®žçŽ°å¯¹è±¡çš„å¤åˆ¶ã€‚å®ƒçš„æºç å¦‚ä¸‹ï¼š protected native Object clone() throws CloneNotSupportedException; clone()å®šä¹‰äº†Objectä¸­ï¼Œå°±ç›¸å½“äºŽJavaä¸­çš„ä»»ä½•ç±»éƒ½ç»§æ‰¿äº†clone()æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¦‚æžœè¦ç±»æ”¯æŒå…‹éš†çš„è¯ï¼Œå¿…é¡»è¦å£°æ˜Žè¯¥ç±»å®žçŽ°äº†CloneableæŽ¥å£ã€‚å¦åˆ™ï¼Œè°ƒç”¨è¯¥ç±»çš„clone()æ–¹æ³•æ—¶ï¼Œä¼šæŠ›å‡ºCloneNotSupportedExceptionå¼‚å¸¸ã€‚ ä½¿ç”¨åœºæ™¯: ç³»ç»Ÿçš„äº§å“æ˜¯åŠ¨æ€åŠ è½½çš„ï¼Œè€Œäº§å“ç±»å…·æœ‰ä¸€å®šçš„ç­‰çº§ç»“æž„ã€‚ ä¾‹å¦‚ï¼Œæ•°æ®åº“ä¸­å­˜å‚¨äº†å¾ˆå¤šæ•°æ®ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦å°†å…¶ä¸­çš„ä¸€äº›æ•°æ®å–å‡ºæ¥å­˜æ”¾åˆ°æ–°çš„è¡¨æ ¼ä¸­ã€‚æˆ–è€…ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹æ¯”ä¸€ä¸ªå¯¹è±¡åœ¨å¤„ç†å‰/åŽçš„å§¿æ€ï¼›åœ¨å¤„ç†ä¹‹å‰ï¼Œå¯ä»¥å…‹éš†è¯¥å¯¹è±¡ï¼Œç„¶åŽå’Œå¤„ç†ä¹‹åŽçš„å¯¹è±¡æ¯”è¾ƒã€‚ åŽŸåž‹æ¨¡å¼æœ‰ä¸¤ç§è¡¨çŽ°å½¢å¼ï¼šç®€å•å½¢å¼ å’Œ ç™»è®°å½¢å¼ã€‚å¦‚æžœéœ€è¦åˆ›å»ºçš„åŽŸåž‹å¯¹è±¡æ•°ç›®å°‘è€Œä¸”æ¯”è¾ƒå›ºå®šçš„åŽï¼Œå°±é‡‡ç”¨â€ç®€å•å½¢å¼â€ï¼›å¦‚æžœè¦åˆ›å»ºçš„åŽŸåž‹å¯¹è±¡æ•°ç›®ä¸ç¡®å®šçš„åŽï¼Œå°±é‡‡ç”¨â€ç™»è®°å½¢å¼â€ã€‚ ç®€å•å½¢å¼çš„åŽŸåž‹æ¨¡å¼ç±»å›¾ å®ƒæ¶‰åŠåˆ°3ä¸ªè§’è‰²ï¼šå®¢æˆ·(Client), æŠ½è±¡åŽŸåž‹(Prototype) å’Œ å…·ä½“åŽŸåž‹(ConcretePrototype)ã€‚ è§’è‰² è¯´æ˜Ž Client å®¢æˆ·ç±»æå‡ºåˆ›å»ºå¯¹è±¡çš„è¯·æ±‚ã€‚ Prototype æŠ½è±¡åŽŸåž‹ç»™å‡ºæ‰€æœ‰çš„å…·ä½“åŽŸåž‹æ‰€éœ€è¦å®žçŽ°çš„å‡½æ•°æŽ¥å£ã€‚ ConcreteType è¢«å¤åˆ¶çš„å¯¹è±¡ï¼Œå®žçŽ°äº†Prototypeä¸­çš„å‡½æ•°æŽ¥å£ã€‚ ä»£ç æ¨¡åž‹ public interface Prototype extends Cloneable { Prototype clone(); } public class ConcretePrototype implements Prototype { public Object clone() { try { return super.clone(); } catch (CloneNotSupportedException e) { return null; } } } public class Client { private Prototype prototype; public void operation(Prototype example) { Prototype p = (Prototype) example.clone(); } } ç™»è®°å½¢å¼çš„åŽŸåž‹æ¨¡å¼UMLç±»å›¾ å®ƒæ¶‰åŠåˆ°4ä¸ªè§’è‰²ï¼šå®¢æˆ·(Client), æŠ½è±¡åŽŸåž‹(Prototype), å…·ä½“åŽŸåž‹(ConcretePrototype) å’Œ PrototypeManager(åŽŸåž‹ç®¡ç†å™¨)ã€‚ è§’è‰² è¯´æ˜Ž Client å®¢æˆ·ç±»æå‡ºåˆ›å»ºå¯¹è±¡çš„è¯·æ±‚ã€‚ Prototype æŠ½è±¡åŽŸåž‹ç»™å‡ºæ‰€æœ‰çš„å…·ä½“åŽŸåž‹æ‰€éœ€è¦å®žçŽ°çš„å‡½æ•°æŽ¥å£ã€‚ ConcreteType è¢«å¤åˆ¶çš„å¯¹è±¡ï¼Œå®žçŽ°äº†Prototypeä¸­çš„å‡½æ•°æŽ¥å£ã€‚ PrototypeManager åˆ›å»ºå…·ä½“åŽŸåž‹ç±»çš„å¯¹è±¡ï¼Œå¹¶è®°å½•æ¯ä¸€ä¸ªè¢«åˆ›å»ºçš„å¯¹è±¡ã€‚ ä»£ç æ¨¡åž‹ public interface Prototype extends Cloneable { Prototype clone(); } public class ConcretePrototype implements Prototype { public synchronized Object clone() { Prototype temp = null; try { temp = (Prototype)super.clone(); return temp; } catch (CloneNotSupportedException e) { return null; } finally { return temp; } } } public class PrototypeManager { private Vector objects = new Vector(); public void add(Prototype object) { objects.add(object); } public Prototype get(int i) { return (Prototype) objects.get(i); } public int getSize() { return objects.size(); } } public class Client { private PrototypeManager mgr; private Prototype prototype; public void registerPrototype() { prototype = new ConcretePrototype(); Prototype copytype = (Prototype)prototype.clone(); mgr.add(copytype); } }]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>åŽŸåž‹æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼06ä¹‹ å»ºé€ æ¨¡å¼(åˆ›å»ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F19%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F06%E4%B9%8B-%E5%BB%BA%E9%80%A0%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å»ºé€ æ¨¡å¼ç®€ä»‹å»ºé€ æ¨¡å¼æ˜¯â€åˆ›å»ºæ¨¡å¼â€(åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼)ã€‚å½“æˆ‘ä»¬è¦åˆ›å»ºçš„å¯¹è±¡æ¯”è¾ƒå¤æ‚çš„æ—¶å€™ï¼Œå¯ä»¥å°†å¯¹è±¡çš„â€åˆ›å»ºâ€å’Œâ€è¡¨ç¤ºâ€åˆ†å‰²å¼€æ¥ï¼›ä»Žè€Œå¯ä»¥ä½¿ä¸€ä¸ªæž„é€ è¿‡ç¨‹åˆ›å»ºå…·æœ‰ä¸åŒè¡¨ç¤ºçš„äº§å“ã€‚è¿™ç§å‚è§å¯¹è±¡çš„æ–¹å¼å°±æ˜¯å»ºé€ æ¨¡å¼ã€‚ å»ºé€ æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯ (01), å¯¹è±¡åŒ…å«å¤æ‚çš„å†…éƒ¨ç»“æž„ã€‚æ¯ä¸ªå†…éƒ¨æˆåˆ†æœ¬èº«å¯ä»¥æ˜¯å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä»…ä»…æ˜¯ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªç»„æˆæˆåˆ†ã€‚&nbsp;&nbsp;&nbsp;&nbsp; ä¾‹å¦‚ï¼Œä¸€ä¸ªç”µå­é‚®ä»¶ç”±å‘ä»¶äººåœ°å€ã€æ”¶ä»¶äººåœ°å€ã€ä¸»é¢˜ã€å†…å®¹ã€é™„ä»¶ç­‰å†…å®¹ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™äº›ç»„æˆéƒ¨åˆ†ç»„åˆæˆä¸€ä»½é‚®ä»¶ï¼Œç„¶åŽå‘é€å‡ºåŽ»ã€‚ (02), å¯¹è±¡çš„å„ä¸ªå±žæ€§ç›¸äº’ä¾èµ–ã€‚&nbsp;&nbsp;&nbsp;&nbsp; ä¾‹å¦‚ï¼ŒæŸå¯¹è±¡åŒ…å«è®¸å¤šæ€§è´¨ï¼Œè€Œè¿™äº›æ€§è´¨å¿…é¡»æŒ‰ç…§æŸä¸ªé¡ºåºèµ‹å€¼æ‰æœ‰æ„ä¹‰ã€‚ (03), å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¼šä½¿ç”¨åˆ°ç³»ç»Ÿä¸­çš„å…¶ä»–å¯¹è±¡ï¼Œè€Œè¿™äº›å¯¹è±¡åœ¨äº§å“å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ä¸­ä¸æ˜“å¾—åˆ°ã€‚ ä¸‹é¢çœ‹çœ‹å®ƒçš„ç»“æž„å›¾ï¼š å»ºé€ æ¨¡å¼åŒ…æ‹¬4ä¸ªç»„æˆéƒ¨åˆ†ï¼šå¯¼æ¼”è€…(Director), æŠ½è±¡å»ºé€ è€…(Builder), å…·ä½“å»ºé€ è€…(ConcreteBuilder) å’Œ äº§å“(Product)ã€‚ ç»„æˆéƒ¨åˆ† è¯´æ˜Ž Director å®ƒä¼šè°ƒç”¨å…·ä½“åˆ›å»ºè€…æ¥åˆ›é€ ä¸€ä¸ªäº§å“å¯¹è±¡ã€‚ Builder å®ƒä¼šç»™å‡ºâ€åˆ›å»ºä¸€ä¸ªäº§å“å¯¹è±¡çš„å„ä¸ªç»„æˆæˆåˆ†â€çš„æŠ½è±¡æŽ¥å£ã€‚ ConcreteBuilder å®žçŽ°â€æŠ½è±¡å»ºé€ è€…â€ç»™å‡ºçš„æŠ½è±¡æŽ¥å£ã€‚ Product è¦è¢«åˆ›å»ºçš„äº§å“å¯¹è±¡ã€‚ å»ºé€ æ¨¡å¼ä»£ç æ¨¡åž‹public class Director { private Builder builder; // æž„é€ äº§å“ public void construct() { builder = new ConcreteBuilder(); builder.buildPart1(); builder.buildPart2(); } } abstract public class Builder { // æž„é€ &quot;äº§å“çš„Part1&quot;çš„æŽ¥å£ public abstract void buildPart1(); // æž„é€ &quot;äº§å“çš„Part2&quot;çš„æŽ¥å£ public abstract void buildPart2(); // è¿”å›žäº§å“ public abstract Product retrieveResult(); } public class ConcreteBuilder { private Product product = new Product(); public void buildPart1() { // å‚è§äº§å“çš„Part1 } public void buildPart2() { // å‚è§äº§å“çš„Part2 } public Product retrieveResult() { return product; } } public class Product { // äº§å“ç»„æˆéƒ¨åˆ†... } å»ºé€ æ¨¡å¼ç¤ºä¾‹å‡è®¾ç”±ä¸€ä¸ªç”µå­æ‚å¿—ç³»ç»Ÿï¼Œå®šæœŸçš„å‘ç”¨æˆ·çš„å‘é€ç”µå­é‚®ç®±ã€‚å‘é€çš„ç”µå­é‚®ä»¶æ¨¡æ¿ç”±ä¸¤ç§ï¼šæ¬¢è¿Žå’Œæ¬¢é€ã€‚é‚®ä»¶åŒ…æ‹¬â€å‘é€è€…åœ°å€â€ï¼Œâ€æŽ¥æ”¶è€…åœ°å€â€ï¼Œâ€œä¸»é¢˜â€ï¼Œâ€œå†…å®¹â€ï¼Œâ€œå‘é€æ—¥æœŸâ€ç­‰å†…å®¹ï¼›å…¶ä¸­ï¼Œâ€œå‘é€è€…åœ°å€â€å’Œâ€œæŽ¥æ”¶è€…åœ°å€â€æ˜¯å¿…å¡«çš„ã€‚ ä¸‹é¢é€šè¿‡å»ºé€ æ¨¡å¼å®žçŽ°è¯¥ç³»ç»Ÿï¼Œå¯¹åº”çš„UMLå›¾å¦‚ä¸‹ï¼š å»ºé€ æ¨¡å¼åŒ…æ‹¬4ä¸ªç»„æˆéƒ¨åˆ†ï¼šâ€å¯¼æ¼”è€…â€, â€œæŠ½è±¡å»ºé€ è€…â€, â€œå…·ä½“å»ºé€ è€…â€å’Œâ€äº§å“â€è¿™4ä¸ªè§’è‰²åˆ†åˆ«å¦‚ä¸‹ï¼š â€œå¯¼æ¼”è€…â€å¯¼æ¼”è€…æ˜¯Directorã€‚Directorä¼šæ ¹æ®Builderå¯¹è±¡ï¼Œæž„é€ å‡ºé‚®ä»¶ã€‚ Directorçš„æºç  public class Director { private Builder builder; public Director(Builder builder) { this.builder = builder; } public void construct(String from, String to) { builder.buildFrom(from); builder.buildTo(to); builder.buildSubject(); builder.buildBody(); builder.buildSendDate(); builder.send(); } } â€œæŠ½è±¡å»ºé€ è€…â€æŠ½è±¡å»ºé€ è€…æ˜¯Builderã€‚Builderæ˜¯æŠ½è±¡ç±»ï¼Œå®ƒåŒ…å«å…·ä½“çš„é‚®ä»¶å¯¹è±¡msgï¼Œmsgæ˜¯åœ¨Builderçš„å­ç±»ä¸­æ ¹æ®æ‰€è¦åˆ›å»ºçš„æ¶ˆæ¯æ¥åˆå§‹åŒ–çš„ã€‚æ­¤å¤–ï¼ŒBuilderæä¾›äº†æž„é€ é‚®ä»¶çš„å‡½æ•°æŽ¥å£ã€‚ Builderçš„æºç  import java.util.Date; abstract public class Builder { protected AutoMessage msg; public Builder() { } public abstract void buildBody() ; public abstract void buildSubject() ; public void buildFrom(String from) { msg.setFrom(from); } public void buildTo(String to) { msg.setTo(to); } public void buildSendDate() { msg.setSendDate(new Date()); } public void send() { msg.send(); } } â€œå…·ä½“å»ºé€ è€…â€å…·ä½“å»ºé€ è€…æ˜¯WelcomeBuilderå’ŒGoodbyeBuilderã€‚WelcomeBuilderæ˜¯æ¬¢è¿Žæ¶ˆæ¯ï¼ŒGoodbyeBuilderæ˜¯æ¬¢é€æ¶ˆæ¯ã€‚ WelcomeBuilderçš„æºç  public class WelcomeBuilder extends Builder { public WelcomeBuilder() { System.out.println(&quot;create WelcomeBuilder&quot;); this.msg = new WelcomeMessage(); } public void buildBody() { msg.setBody(&quot;Welcome body!&quot;); } public void buildSubject() { msg.setSubject(&quot;Welcome subject!&quot;); } } GoodbyeBuilderçš„æºç  public class GoodbyeBuilder extends Builder { public GoodbyeBuilder() { System.out.println(&quot;create GoodbyeBuilder&quot;); msg = new GoodbyeMessage(); } public void buildBody() { msg.setBody(&quot;Goodbye body!&quot;); } public void buildSubject() { msg.setSubject(&quot;Goodbye subject!&quot;); } } â€œäº§å“â€äº§å“æ˜¯AutoMessageã€‚AutoMessageæ˜¯æŠ½è±¡å‡ºæ¥çš„äº§å“ç±»ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªå­ç±»WelcomeBuilderå’ŒGoodbyeMessageã€‚ AutoMessageçš„æºç  import java.util.Date; abstract public class AutoMessage { protected String from; protected String to; protected String subject; protected String body; protected Date sendDate; public void setFrom(String from) { this.from = from; } public String getFrom() { return from; } public void setTo(String to) { this.to = to; } public String getTo() { return to; } public void setSubject(String subject) { this.subject = subject; } public String getSubject() { return subject; } public void setBody(String body) { this.body = body; } public String getBody() { return body; } public void setSendDate(Date sendDate) { this.sendDate = sendDate; } public Date getSendDate() { return sendDate; } public void send() { System.out.println(&quot;send MSG[Subject: \&quot;&quot;+subject+&quot;\&quot;, Body: \&quot;&quot;+body+&quot;\&quot;] from \&quot;&quot;+from+&quot;\&quot; to \&quot;&quot;+to+&quot;\&quot; @date:\&quot;&quot;+sendDate+&quot;\&quot;&quot;); } } WelcomeMessageçš„æºç  public class WelcomeMessage extends AutoMessage { public WelcomeMessage() { System.out.println(&quot;Create WelcomeMessage&quot;); } public void sayWelcome() { System.out.println(&quot;Welcome.&quot;); } } GoodbyeMessageçš„æºç  public class GoodbyeMessage extends AutoMessage { public GoodbyeMessage() { System.out.println(&quot;Create GoodbyeMessage&quot;); } public void sayGoodbye() { System.out.println(&quot;Goodbye.&quot;); } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºå®¢æˆ·ç«¯æ˜¯â€Clientâ€ã€‚ Clientçš„æºç  public class Client { private static Director dw, dg; private static Builder bw, bg; public static void main(String[] args) { bw = new WelcomeBuilder(); dw = new Director(bw); dw.construct(&quot;skywang12345@gmail.com&quot;, &quot;java_patterns@gmail.com&quot;); bg = new GoodbyeBuilder(); dg = new Director(bg); dg.construct(&quot;skywang54321@gmail.com&quot;, &quot;java_patterns@gmail.com&quot;); } } è¿è¡Œç»“æžœï¼š create WelcomeBuilder Create WelcomeMessage send MSG[Subject: &quot;Welcome subject!&quot;, Body: &quot;Welcome body!&quot;] from &quot;skywang12345@gmail.com&quot; to &quot;java_patterns@gmail.com&quot; @date:&quot;Sun Jan 19 10:48:02 CST 2014&quot; create GoodbyeBuilder Create GoodbyeMessage send MSG[Subject: &quot;Goodbye subject!&quot;, Body: &quot;Goodbye body!&quot;] from &quot;skywang54321@gmail.com&quot; to &quot;java_patterns@gmail.com&quot; @date:&quot;Sun Jan 19 10:48:02 CST 2014&quot;]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>å»ºé€ æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼05ä¹‹ å¤šä¾‹æ¨¡å¼(åˆ›å»ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F18%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F05%E4%B9%8B-%E5%A4%9A%E4%BE%8B%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¤šä¾‹æ¨¡å¼ç®€ä»‹å¤šä¾‹æ¨¡å¼(Multiton)ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªç±»ç”±å¤šä¸ªç›¸åŒå®žä¾‹ï¼Œè€Œä¸”è¯¥å®žä¾‹éƒ½æ˜¯è¯¥ç±»æœ¬èº«ã€‚è¿™ä¸ªç±»å«åšå¤šä¾‹ç±»ã€‚ å¤šä¾‹æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯ï¼š (01), å¤šä¾‹ç±»å¯ä»¥ç”±å¤šä¸ªå®žä¾‹ã€‚ (02), å¤šä¾‹ç±»å¿…é¡»è‡ªå·±åˆ›å»ºã€ç®¡ç†è‡ªå·±çš„å®žä¾‹ï¼Œå¹¶å‘å¤–ç•Œæä¾›è‡ªå·±çš„å®žä¾‹ã€‚ å¤šä¾‹æ¨¡å¼çš„ç»“æž„å›¾å¦‚ä¸‹ï¼š å¤šä¾‹æ¨¡å¼ä»£ç æ¨¡åž‹public class /images/mediaMultiton { public static final Multiton INSTANCE_01 = new Multiton(&quot;instance_01&quot;); public static final Multiton INSTANCE_02 = new Multiton(&quot;instance_02&quot;); private Multiton(String name) {} } å¤šä¾‹æ¨¡å¼ç¤ºä¾‹ç¤ºä¾‹ä»£ç ï¼š // å¤šä¾‹ç±»ã€‚ // åŒ…æ‹¬CHINA, ENGLAND å’Œ FRANCE è¿™3ä¸ªå®žä¾‹ã€‚ class Country { public static final Country CHINA = new Country(&quot;chinae&quot;); public static final Country ENGLAND = new Country(&quot;england&quot;); public static final Country FRANCE = new Country(&quot;france&quot;); private String name; private Country(String name) { this.name = name; } public String getName() { return name; } } public class MultitonTest { public static void main(String[] args) { Country c1 = Country.CHINA; Country c2 = Country.ENGLAND; Country c3 = Country.FRANCE; System.out.println(&quot;c1 is: &quot;+c1.getName()); System.out.println(&quot;c2 is: &quot;+c2.getName()); System.out.println(&quot;c3 is: &quot;+c3.getName()); } } è¿è¡Œç»“æžœï¼š c1 is: chinae c2 is: england c3 is: france]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>å¤šä¾‹æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼04ä¹‹ å•ä¾‹æ¨¡å¼(åˆ›å»ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F17%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F04%E4%B9%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å•ä¾‹æ¨¡å¼ç®€ä»‹å•ä¾‹æ¨¡å¼(Simple Factory)ï¼Œç¡®ä¿ç±»åªæœ‰ä¸€ä¸ªå®žä¾‹ï¼Œè€Œä¸”ç±»è‡ªå·±å®žä¾‹åŒ–è¯¥å®žä¾‹å¹¶å‘å®¢æˆ·ç«¯æä¾›è¯¥å®žä¾‹ã€‚å®ƒå±žäºŽâ€åˆ›å»ºæ¨¡å¼â€(åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼)ã€‚ å•ä¾‹æ¨¡å¼å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š(01), ç±»åªèƒ½æœ‰ä¸€ä¸ªå®žä¾‹ã€‚(02), ç±»è‡ªè¡Œåˆ›å»ºå®žä¾‹ã€‚(03), å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®žä¾‹ã€‚ å®ƒçš„ç»“æž„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å•ä¾‹æ¨¡å¼ä»£ç æ¨¡åž‹å•ä¾‹æ¨¡å¼åŒ…æ‹¬ï¼šé¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ å’Œ æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ å®ƒä»¬çš„ç›¸åŒç‚¹ï¼šå®ƒä»¬çš„å•ä¾‹ç±»ä¸­ï¼Œæž„é€ å‡½æ•°éƒ½æ˜¯ç§æœ‰çš„ï¼è¿™æ ·ï¼Œå°±é¿å…äº†å¤–ç•Œåˆ©ç”¨æž„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼Œè€Œåªèƒ½é€šè¿‡æŒ‡å®šçš„å‡½æ•°æ¥èŽ·å–å¯¹è±¡ã€‚æ­¤å¤–ï¼Œç”±äºŽæž„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ï¼Œæ­¤ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼ å®ƒä»¬çš„ä¸åŒç‚¹ï¼šé¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ï¼Œæ˜¯åœ¨ç±»è¢«åŠ è½½æ—¶ï¼Œå°±åˆ›å»ºäº†ç±»çš„å¯¹è±¡ã€‚è€Œåœ¨æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ä¸­ï¼Œåœ¨ç±»è¢«ç¬¬ä¸€æ¬¡å¼•ç”¨æ—¶ï¼Œæ‰å°†è‡ªå·±å®žä¾‹åŒ–ã€‚ é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„ä»£ç æ¨¡åž‹public class EagerSingleton { private static final EagerSingleton mInstance = new EagerSingleton(); private EagerSingleton() {} public static EagerSingleton getInstance() { return mInstance; } } åœ¨é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ä¸­ï¼Œåœ¨ç±»è¢«åŠ è½½æ—¶ï¼Œé™æ€å˜é‡mInstanceå°±ä¼šè¢«åˆå§‹åŒ–ã€‚è¿™æ—¶å€™ï¼Œå•ä¾‹ç±»çš„å”¯ä¸€å®žä¾‹å°±è¢«åˆ›å»ºå‡ºæ¥äº†ã€‚ æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼çš„ä»£ç æ¨¡åž‹public class LazySingleton { private static LazySingleton mInstance = null; private LazySingleton() {} synchronized public static LazySingleton getInstance() { if (mInstance==null) { mInstance = new LazySingleton(); } return mInstance; } } åœ¨æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ä¸­ï¼Œåœ¨ç±»è¢«åŠ è½½æ—¶ï¼Œé™æ€å˜é‡mInstanceå¹¶ä¸ä¼šè¢«åˆå§‹åŒ–ï¼›è€Œåªæœ‰å½“getInstance()ç¬¬1æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒmInstanceæ‰è¢«åˆå§‹åŒ–ã€‚ å•ä¾‹æ¨¡å¼ç¤ºä¾‹ç¤ºä¾‹ä»£ç ï¼š class EagerSingleton { private static final EagerSingleton mInstance = new EagerSingleton(); private EagerSingleton() {} public static EagerSingleton getInstance() { return mInstance; } public void doSomething() { System.out.println(Thread.currentThread().getName()+&quot; do something&quot;); } } public class SingletonTest { public static void main(String[] args) { // å¯åŠ¨5ä¸ªçº¿ç¨‹ã€‚å®ƒä»¬ä¼šåˆ†åˆ«èŽ·å–EagerSingletonå®žä¾‹ï¼Œå¹¶è°ƒç”¨å®ƒçš„doSomething()æ–¹æ³•ã€‚ for (int i=0; i&lt;5; i++) { new Thread( new Runnable() { @Override public void run() { EagerSingleton es = EagerSingleton.getInstance(); es.doSomething(); } }).start(); } } } è¿è¡Œç»“æžœï¼š Thread-3 do something Thread-4 do something Thread-2 do something Thread-1 do something Thread-0 do something]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>å•ä¾‹æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼03ä¹‹ æŠ½è±¡å·¥åŽ‚æ¨¡å¼(åˆ›å»ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F16%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F03%E4%B9%8B-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[æŠ½è±¡å·¥åŽ‚æ¨¡å¼ç®€ä»‹æŠ½è±¡å·¥åŽ‚æ¨¡å¼(Abstract Factory)ï¼Œå®ƒæ˜¯æ‰€æœ‰å½¢æ€çš„å·¥åŽ‚æ¨¡å¼ä¸­æœ€ä¸ºæŠ½è±¡ï¼Œä¹Ÿæ˜¯æœ€å…·æœ‰ä¸€èˆ¬æ€§çš„å½¢æ€ã€‚å®ƒå±žäºŽâ€åˆ›å»ºæ¨¡å¼â€(åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼)ã€‚å®ƒçš„ç»“æž„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š æŠ½è±¡å·¥åŽ‚æ¨¡å¼çš„ç»“æž„å…±åŒ…æ‹¬4ä¸ªç»„æˆéƒ¨åˆ†ï¼šæŠ½è±¡å·¥åŽ‚(Factory)ï¼Œå…·ä½“å·¥åŽ‚(ConcreteFactory), æŠ½è±¡äº§å“(Product)ï¼Œå…·ä½“äº§å“(ConcreteProduct)ã€‚ ç»„æˆéƒ¨åˆ† è¯´æ˜Ž Factory å®ƒæä¾›äº†â€åˆ›å»ºäº§å“â€çš„å‡½æ•°æŽ¥å£ï¼Œè¯¥å‡½æ•°æŽ¥å£ç”±å…·ä½“å·¥åŽ‚ConcreteFactoryæ¥å®žçŽ°ã€‚Factoryå¯ä»¥æ˜¯æŽ¥å£æˆ–è€…æŠ½è±¡ç±»ã€‚ ConcreteFactory å®ƒå®žçŽ°äº†Factoryçš„å‡½æ•°æŽ¥å£ã€‚ Product å®ƒæ˜¯æŠ½è±¡äº§å“ï¼Œæ˜¯(è®¸å¤š)ä¸åŒäº§å“æŠ½è±¡å‡ºæ¥çš„ã€‚åœ¨æŠ½è±¡å·¥åŽ‚æ¨¡å¼ä¸­ï¼ŒæŠ½è±¡äº§å“ä¸æ­¢ä¸€ä¸ªã€‚ ConcreteProduct å®ƒæ˜¯å…·ä½“äº§å“ã€‚ConcreteFactoryä¸­â€åˆ›å»ºäº§å“â€çš„å‡½æ•°å®žçŽ°ä¸­ï¼Œå®žé™…ä¸Šæ˜¯è¿”å›žçš„ConcreteProductå®žä¾‹ã€‚ æŠ½è±¡å·¥åŽ‚æ¨¡å¼ä¸Žå·¥åŽ‚æ–¹æ³•æ¨¡å¼çš„åŒºåˆ«: åœ¨å·¥åŽ‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œâ€æŠ½è±¡äº§å“â€åªæœ‰ä¸€ä¸ªï¼Œè€Œåœ¨æŠ½è±¡å·¥åŽ‚æ¨¡å¼ä¸­ï¼Œâ€æŠ½è±¡äº§å“â€æœ‰å¾ˆå¤šä¸ªï¼åœ¨å·¥åŽ‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œæ˜¯ç”±â€å…·ä½“å·¥åŽ‚â€å†³å®šè¿”å›žå“ªä¸€ç±»äº§å“ï¼›ç„¶åŽï¼ŒæŠ½è±¡å·¥åŽ‚ä¸­ï¼Œæ˜¯ç”±â€å®¢æˆ·ç«¯â€å†³å®šè¿”å›žå“ªä¸€ç±»äº§å“ã€‚ æŠ½è±¡å·¥åŽ‚æ¨¡å¼ä»£ç æ¨¡åž‹ä»£ç  public interface Factory { public ProductA newProductA(); public ProductB newProductB(); } public class ConcreteFactory1 implements Factory { public ProductA newProductA() { return new ConcreteProductA1(); } public ProductB newProductB(); return new ConcreteProductB1(); } } public class ConcreteFactory2 implements Factory { public ProductA newProductA2() { return new ConcreteProduct1(); } public ProductB newProductB2(); return new ConcreteProduct1(); } } public interface ProductA { } public class ProductA1 implements ProductA { } public class ProductA2 implements ProductA { } public interface ProductB { } public class ProductB1 implements ProductB { } public class ProductB2 implements ProductB { } æ¨¡åž‹çš„ç±»å›¾ æŠ½è±¡å·¥åŽ‚æ¨¡å¼ç¤ºä¾‹å‡è®¾ï¼Œæˆ‘ä»¬è¦å®žçŽ°ä¸€ä¸ªå·¥åŽ‚ç®¡ç†ç³»ç»Ÿï¼Œè®°å½•ä¸‰æ˜Ÿå’Œè‹¹æžœè¿™ä¸¤å®¶å·¥åŽ‚(Factory)ç”Ÿäº§çš„æ‰‹æœº(Phone)å’Œç”µè„‘(Computer)ä¿¡æ¯ã€‚ å·²çŸ¥ï¼Œä¸‰æ˜Ÿå’Œè‹¹æžœéƒ½ç”±è‡ªå·±çš„å·¥åŽ‚ï¼Œåˆ†åˆ«æ˜¯â€ä¸‰æ˜Ÿå·¥åŽ‚(SumFactory)â€å’Œâ€è‹¹æžœå·¥åŽ‚(AppleFactory)â€ã€‚ä¸‰æ˜Ÿå·¥åŽ‚ç”Ÿäº§â€ä¸‰æ˜Ÿæ‰‹æœº(SumPhone)â€å’Œâ€ä¸‰æ˜Ÿç”µè„‘(SumComputer)â€ï¼Œè‹¹æžœå·¥åŽ‚ç”Ÿäº§â€è‹¹æžœæ‰‹æœº(ApplePhone)â€å’Œâ€è‹¹æžœç”µè„‘(AppleComputer)â€ã€‚ æˆ‘ä»¬ç”¨æŠ½è±¡å·¥åŽ‚æ¨¡å¼å®žçŽ°è¯¥ç³»ç»Ÿï¼Œå®ƒçš„è®¾è®¡å›¾å¦‚ä¸‹ï¼š åœ¨è¯¥ç³»ç»Ÿä¸­ï¼Œâ€æŠ½è±¡å·¥åŽ‚â€ï¼Œâ€å…·ä½“å·¥åŽ‚â€, æŠ½è±¡äº§å“â€å’Œâ€å…·ä½“äº§å“â€è¿™4ä¸ªè§’è‰²åˆ†åˆ«å¦‚ä¸‹ï¼š æŠ½è±¡å·¥åŽ‚â€œæŠ½è±¡å·¥åŽ‚â€æ˜¯Factoryï¼ŒFactoryä¸­å®šä¹‰äº†â€ç”Ÿäº§æ‰‹æœºâ€ä»¥åŠâ€ç”Ÿäº§ç”µè„‘â€çš„æ–¹æ³•ã€‚ Factoryçš„æºç  public interface Factory { // ç”Ÿäº§æ‰‹æœº public Phone createPhone() ; // ç”Ÿäº§ç”µè„‘ public Computer createComputer() ; } å…·ä½“å·¥åŽ‚â€œå…·ä½“å·¥åŽ‚â€æ˜¯SumFactoryå’ŒAppleFactoryã€‚SumFactoryèƒ½è¿”å›žçš„â€ä¸‰æ˜Ÿæ‰‹æœº(SumPhone)â€å’Œâ€œä¸‰æ˜Ÿç”µè„‘SumComputerâ€å¯¹è±¡ã€‚AppleFactoryèƒ½è¿”å›žçš„â€è‹¹æžœæ‰‹æœº(ApplePhone)â€å’Œâ€œè‹¹æžœç”µè„‘AppleComputerâ€å¯¹è±¡ã€‚ SumFactoryçš„æºç  public class SumFactory implements Factory{ // ç”Ÿäº§ä¸‰æ˜Ÿæ‰‹æœº public Phone createPhone() { return new SumPhone(); } // ç”Ÿäº§ä¸‰æ˜Ÿç”µè„‘ public Computer createComputer() { return new SumComputer(); } } AppleFactoryçš„æºç  public class AppleFactory implements Factory{ // ç”Ÿäº§è‹¹æžœæ‰‹æœº public Phone createPhone() { return new ApplePhone(); } // ç”Ÿäº§è‹¹æžœç”µè„‘ public Computer createComputer() { return new AppleComputer(); } } æŠ½è±¡äº§å“â€œæŠ½è±¡äº§å“â€æ˜¯â€æ‰‹æœº(Phone)â€å’Œâ€ç”µè„‘(Computer)â€ã€‚æ‰‹æœºåŒ…æ‹¬â€activate()æ–¹æ³•â€ï¼Œè€Œç”µè„‘åˆ™åŒ…æ‹¬â€getOSName()æ–¹æ³•â€ã€‚ Phoneçš„æºç  abstract public class Phone { // æ¿€æ´»æ‰‹æœº abstract public void activate(); } Computerçš„æºç  abstract public class Computer { // èŽ·å–æ“ä½œç³»ç»Ÿåè¯ abstract public String getOSName(); } å…·ä½“äº§å“â€œå…·ä½“äº§å“â€æ˜¯â€ä¸‰æ˜Ÿæ‰‹æœº(SumPhone)â€ï¼Œâ€ä¸‰æ˜Ÿç”µè„‘(SumComputer)â€ï¼›ä»¥åŠ â€œè‹¹æžœæ‰‹æœº(ApplePhone)â€å’Œâ€è‹¹æžœç”µè„‘(AppleComputer)â€ã€‚ SumPhoneæºç  public class SumPhone extends Phone{ // æ¿€æ´»æ‰‹æœº public void activate() { System.out.println(&quot;activate SumPhone&quot;); } } SumComputeræºç  public class SumComputer extends Computer{ // èŽ·å–æ“ä½œç³»ç»Ÿåè¯ public String getOSName() { return &quot;Windows&quot;; } } ApplePhoneæºç  public class ApplePhone extends Phone{ // æ¿€æ´»æ‰‹æœº public void activate() { System.out.println(&quot;activate ApplePhone&quot;); } } AppleComputeræºç  public class AppleComputer extends Computer{ // èŽ·å–æ“ä½œç³»ç»Ÿåè¯ public String getOSName() { return &quot;Mac&quot;; } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºå®¢æˆ·ç«¯æ˜¯â€Clientâ€ã€‚ Clientçš„æºç  public class Client { public static void main(String[] args) { // åˆ›å»º&quot;Factory&quot;å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯&quot;AppleFactory&quot;çš„å®žä¾‹ Factory appleFac = new AppleFactory(); // æ ¹æ®å·¥åŽ‚å®žä¾‹ï¼Œåˆ›å»ºå¯¹åº”çš„æ‰‹æœºå’Œç”µè„‘ Phone applePhone = appleFac.createPhone(); Computer appleComputer = appleFac.createComputer(); // æ¿€æ´»&quot;æ‰‹æœº&quot; applePhone.activate(); // èŽ·å–&quot;ç”µè„‘æ“ä½œç³»ç»Ÿåè¯&quot; String appleOS =appleComputer.getOSName(); System.out.println(&quot;appleOS is: &quot;+appleOS); // åˆ›å»º&quot;Factory&quot;å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯&quot;SumFactory&quot;çš„å®žä¾‹ Factory sumFac = new SumFactory(); // æ ¹æ®å·¥åŽ‚å®žä¾‹ï¼Œåˆ›å»ºå¯¹åº”çš„æ‰‹æœºå’Œç”µè„‘ Phone sumPhone = sumFac.createPhone(); Computer sumComputer = sumFac.createComputer(); // æ¿€æ´»&quot;æ‰‹æœº&quot; sumPhone.activate(); // èŽ·å–&quot;ç”µè„‘æ“ä½œç³»ç»Ÿåè¯&quot; String sumOS = sumComputer.getOSName(); System.out.println(&quot;sumOS is: &quot;+sumOS); } } è¿è¡Œç»“æžœï¼š activate ApplePhone appleOS is: Mac activate SumPhone sumOS is: Windows]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>æŠ½è±¡å·¥åŽ‚</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼02ä¹‹ å·¥åŽ‚æ–¹æ³•æ¨¡å¼(åˆ›å»ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F15%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F02%E4%B9%8B-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å·¥åŽ‚æ–¹æ³•æ¨¡å¼ç®€ä»‹å·¥åŽ‚æ–¹æ³•æ¨¡å¼(Factory Method)ï¼Œåˆè¢«ç§°ä¸ºâ€è™šæž„é€ å­æ¨¡å¼â€æˆ–â€å¤šæ€æ€§å·¥åŽ‚æ¨¡å¼â€ã€‚å®ƒå±žäºŽâ€åˆ›å»ºæ¨¡å¼â€(åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼)ã€‚ å®ƒçš„ç”¨æ„æ˜¯æä¾›ä¸€ä¸ªâ€åˆ›å»ºäº§å“å¯¹è±¡â€çš„æŽ¥å£ï¼Œè€Œå°†è¿™äº›æŽ¥å£çš„å®žçŽ°æŽ¨è¿Ÿåˆ°å®ƒçš„å­ç±»ä¸­åŽ»ã€‚å› æ­¤å®ƒå…·æœ‰ä¸¤ä¸ªæ˜Žæ˜¾çš„ä¼˜ç‚¹ï¼š(1) å®šä¹‰åˆ›å»ºå¯¹è±¡çš„æŽ¥å£,å°è£…äº†å¯¹è±¡çš„åˆ›å»ºã€‚(2) ä½¿å¾—å…·ä½“åŒ–ç±»çš„å·¥ä½œå»¶è¿Ÿåˆ°äº†å­ç±»ä¸­ã€‚ ä¸‹é¢çœ‹çœ‹å®ƒçš„ç»“æž„å›¾ï¼š å·¥åŽ‚æ–¹æ³•æ¨¡å¼çš„ç»“æž„å…±åŒ…æ‹¬4ä¸ªç»„æˆéƒ¨åˆ†ï¼šæŠ½è±¡å·¥åŽ‚(Factory)ï¼Œå…·ä½“å·¥åŽ‚(ConcreteFactory), æŠ½è±¡äº§å“(Product)ï¼Œå…·ä½“äº§å“(ConcreteProduct)ã€‚ ç»„æˆéƒ¨åˆ† è¯´æ˜Ž Factory å®ƒæä¾›äº†â€åˆ›å»ºäº§å“â€çš„å‡½æ•°æŽ¥å£ï¼Œè¯¥å‡½æ•°æŽ¥å£ç”±å…·ä½“å·¥åŽ‚ConcreteFactoryæ¥å®žçŽ°ã€‚Factoryå¯ä»¥æ˜¯æŽ¥å£æˆ–è€…æŠ½è±¡ç±»ã€‚ ConcreteFactory å®ƒå®žçŽ°äº†Factoryçš„å‡½æ•°æŽ¥å£ã€‚åœ¨ä¸Šé¢çš„ç»“æž„å›¾ä¸­ï¼Œç»™å‡ºäº†ConcreteFactory1å’ŒConcreteFactory2ä¸¤ä¸ªå…·ä½“å·¥åŽ‚ç±»ã€‚ Product å®ƒæ˜¯æŠ½è±¡äº§å“ã€‚ ConcreteProduct å®ƒæ˜¯å…·ä½“äº§å“ï¼Œå®žçŽ°äº†Productä¸­çš„å‡½æ•°æŽ¥å£ã€‚ConcreteFactoryä¸­â€åˆ›å»ºäº§å“â€çš„å‡½æ•°å®žçŽ°ä¸­ï¼Œå®žé™…ä¸Šæ˜¯è¿”å›žçš„ConcreteProductå®žä¾‹ã€‚åœ¨ä¸Šé¢çš„ç»“æž„å›¾ä¸­ï¼Œç»™å‡ºäº†ConcreteProduct1å’ŒConcreteProduct2ä¸¤ä¸ªå…·ä½“äº§å“ç±»ã€‚ å·¥åŽ‚æ–¹æ³•æ¨¡å¼ä»£ç æ¨¡åž‹ä»£ç  public interface Factory { public Product newInstance() ; } public class ConcreteFactory1 implements Factory { public Product newInstance() { return new ConcreteProduct1(); } } public class ConcreteFactory2 implements Factory { public Product newInstance() { return new ConcreteProduct2(); } } public interface Product { } public class ConcreteProduct1 implements Product { public ConcreteProduct1() { // do something } } public class ConcreteProduct2 implements Product { public ConcreteProduct2() { // do something } } æ¨¡åž‹çš„ç±»å›¾ ä»¥ä¸Šæ¨¡åž‹ä¸­ï¼Œå¯¹äºŽâ€æŠ½è±¡å·¥åŽ‚â€å’Œâ€æŠ½è±¡äº§å“â€éƒ½åªç»™å‡ºäº†ä¸¤ä¸ªå®žçŽ°ç±»ï¼›åœ¨å®žé™…ä¸­ï¼Œæƒ…å†µå¯èƒ½æ¯”è¿™å¤æ‚è®¸å¤šã€‚ å·¥åŽ‚æ–¹æ³•æ¨¡å¼ç¤ºä¾‹å°†â€ç®€å•å·¥åŽ‚æ¨¡å¼â€ä¸­çš„ç¤ºä¾‹ï¼Œæ”¹ä¸ºç”±â€å·¥åŽ‚æ–¹æ³•æ¨¡å¼â€å®žçŽ°ã€‚å®ƒçš„UMLç±»å›¾å¦‚ä¸‹ï¼š æŠ½è±¡å·¥åŽ‚ç±»æŠ½è±¡å·¥åŽ‚ç±»ç±»æ˜¯â€FruitFactoryâ€ã€‚FruitFactoryæ˜¯æ°´æžœå·¥åŽ‚ï¼Œæ°´æžœå·¥åŽ‚ä¼šç”Ÿæˆè‹¹æžœï¼Œè‘¡è„å’Œè‰èŽ“è¿™3ç§æ°´æžœã€‚ FruitFactoryçš„æºç  abstract public class FruitFactory { public abstract Fruit newInstance(); } å…·ä½“å·¥åŽ‚ç±»å…·ä½“å·¥åŽ‚ç±»æ˜¯â€AppleFactoryâ€, â€œGrapeFactoryâ€å’Œâ€StrawberryFactoryâ€ï¼›å®ƒä»¬éƒ½ç»§æ‰¿äºŽFruitFactoryã€‚AppleFactoryç”Ÿäº§è‹¹æžœï¼ŒGrapeFactoryç”Ÿæˆè‘¡è„ï¼ŒStrawberryç”Ÿæˆè‰èŽ“ã€‚ AppleFactoryçš„æºç  public class AppleFactory extends FruitFactory { public Fruit newInstance() { return new Apple(); } } GrapeFactoryçš„æºç  public class GrapeFactory extends FruitFactory { public Fruit newInstance() { return new Grape(); } } Strawberryçš„æºç  public class StrawberryFactory extends FruitFactory { public Fruit newInstance() { return new Strawberry(); } } æŠ½è±¡äº§å“ç±»æŠ½è±¡äº§å“ç±»æ˜¯â€Fruitâ€ã€‚Fruitä»£è¡¨æ°´æžœï¼Œå®ƒæ˜¯æŠ½è±¡ç±»ï¼ŒåŒ…å«æ°´æžœçš„åŸºæœ¬ç‰¹å¾ï¼šç”Ÿé•¿ï¼Œç§æ¤ï¼Œæ”¶èŽ·ã€‚ Fruitçš„æºç  public abstract class Fruit { abstract void grow(); // ç”Ÿé•¿ abstract void harvest(); // æ”¶èŽ· abstract void plant(); // ç§æ¤ } å…·ä½“äº§å“ç±»å…·ä½“äº§å“ç±»æ˜¯â€Appleâ€, â€œGrapeâ€å’Œâ€Strawberryâ€ã€‚å®ƒä»¬æ˜¯3ç§å…·ä½“çš„æ°´æžœï¼Œåˆ†åˆ«ä»£è¡¨è‹¹æžœï¼Œè‘¡è„å’Œè‰èŽ“ã€‚ Appleçš„æºç  // Appleå®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ï¼Œå¹¶ä¸”Appleä¸­æœ‰ç§æœ‰æˆå‘˜ageå’Œç§æœ‰æ–¹æ³•logã€‚ public class Apple extends Fruit { private int age; public void grow() { log(&quot;Apple grow()&quot;); } public void harvest() { log(&quot;Apple harvest()&quot;); } public void plant() { log(&quot;Apple plant()&quot;); } public void setAge(int age) { this.age = age; } public int getAge() { return age; } private void log(String msg) { System.out.println(msg); } } Grapeçš„æºç  // Grapeä»…ä»…åªå®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ã€‚ public class Grape extends Fruit { public void grow() { System.out.println(&quot;Grape grow()&quot;); } public void harvest() { System.out.println(&quot;Grape harvest()&quot;); } public void plant() { System.out.println(&quot;Grape plant()&quot;); } } Strawberryçš„æºç  // Strawberryå®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ï¼Œå¹¶ä¸”Strawberryä¸­æœ‰ç§æœ‰æ–¹æ³•log public class Strawberry extends Fruit { public void grow() { log(&quot;Strawberry grow()&quot;); } public void harvest() { log(&quot;Strawberry harvest()&quot;); } public void plant() { log(&quot;Strawberry plant()&quot;); } private void log(String msg) { System.out.println(msg); } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºå®¢æˆ·ç«¯æ˜¯â€Clientâ€ã€‚ Clientçš„æºç  public class Client { public static void main(String[] args) { // åˆ›å»º&quot;æŠ½è±¡å·¥åŽ‚FruitFactory&quot;å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯&quot;å…·ä½“å·¥åŽ‚AppleFactory&quot;çš„å®žä¾‹ FruitFactory appleFac = new AppleFactory(); // æ ¹æ®å·¥åŽ‚å®žä¾‹ï¼Œåˆ›å»ºå¯¹åº”çš„äº§å“ Fruit apple = appleFac.newInstance(); apple.plant(); apple.grow(); apple.harvest(); // åˆ›å»º&quot;æŠ½è±¡å·¥åŽ‚FruitFactory&quot;å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯&quot;å…·ä½“å·¥åŽ‚GrapeFactory&quot;çš„å®žä¾‹ FruitFactory grapeFac = new GrapeFactory(); // æ ¹æ®å·¥åŽ‚å®žä¾‹ï¼Œåˆ›å»ºå¯¹åº”çš„äº§å“ Fruit grape = grapeFac.newInstance(); grape.plant(); grape.grow(); grape.harvest(); // åˆ›å»º&quot;æŠ½è±¡å·¥åŽ‚FruitFactory&quot;å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯&quot;å…·ä½“å·¥åŽ‚StrawberryFactory&quot;çš„å®žä¾‹ FruitFactory strawberryFac = new StrawberryFactory(); // æ ¹æ®å·¥åŽ‚å®žä¾‹ï¼Œåˆ›å»ºå¯¹åº”çš„äº§å“ Fruit strawberry = strawberryFac.newInstance(); strawberry.plant(); strawberry.grow(); strawberry.harvest(); } } è¿è¡Œç»“æžœï¼š Apple plant() Apple grow() Apple harvest() Grape plant() Grape grow() Grape harvest() Strawberry plant() Strawberry grow() Strawberry harvest() å·¥åŽ‚æ–¹æ³•æ¨¡å¼å’Œç®€å•å·¥åŽ‚æ¨¡å¼çš„æ¯”è¾ƒåœ¨ç®€å•å…±å­˜æ¨¡å¼ä¸­ï¼Œâ€å·¥åŽ‚ç±»â€å¤„äºŽå®žä¾‹åŒ–äº§å“çš„ä¸­å¿ƒä½ç½®ï¼›å®ƒçŸ¥é“æ¯ä¸€ä¸ªäº§å“ï¼Œå†³å®šäº†å“ªä¸€ä¸ªäº§å“ç±»åº”è¯¥è¢«å®žä¾‹åŒ–ã€‚å¦‚æžœæœ‰æ–°çš„äº§å“æ·»åŠ åˆ°ç³»ç»Ÿä¸­ï¼Œå°±éœ€è¦å¯¹åº”çš„ä¿®æ”¹â€å·¥åŽ‚ç±»â€ã€‚è€Œå·¥åŽ‚æ–¹æ³•æ¨¡å¼çš„å‡ºçŽ°ï¼Œæ—¢ä¿æŒäº†ç®€å•å·¥åŽ‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œåˆå®¢æœäº†å®ƒçš„ç¼ºç‚¹ã€‚åœ¨å·¥åŽ‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œâ€å·¥åŽ‚ç±»â€ä¸å†è´Ÿè´£äº§å“çš„å®žä¾‹åŒ–ï¼Œè€Œæ˜¯å°†å®žä¾‹åŒ–å·¥ä½œäº¤ç»™å®ƒçš„å­ç±»(å…·ä½“å·¥åŽ‚)åŽ»å®Œæˆã€‚è¿™æ ·ï¼Œå½“æœ‰æ–°çš„äº§å“æ·»åŠ åˆ°ç³»ç»Ÿä¸­æ—¶ï¼Œå°±ä¸éœ€è¦ä¿®æ”¹â€å·¥åŽ‚ç±»â€ï¼Œè€Œåªè¦æ·»åŠ å¯¹åº”çš„â€å…·ä½“å·¥åŽ‚â€ç±»å³å¯! ç®€å•å·¥åŽ‚æ¨¡å¼ç›¸å½“äºŽå·¥åŽ‚æ–¹æ³•æ¨¡å¼çš„ç‰¹æ®Šå½¢å¼ã€‚å³ï¼Œå½“å·¥åŽ‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œåªæœ‰ä¸€ä¸ªâ€å…·ä½“å·¥åŽ‚â€å­˜åœ¨æ—¶ï¼Œå°†â€æŠ½è±¡å·¥åŽ‚â€å’Œâ€å…·ä½“å·¥åŽ‚â€åˆå¹¶æˆä¸€ä¸ªç±»ï¼›æŽ¥ç€ï¼Œå°†å®žä¾‹åŒ–äº§å“çš„æ–¹æ³•æ”¹ä¸ºé™æ€æ–¹æ³•ã€‚æ­¤æ—¶ï¼Œå°±å¾—åˆ°äº†ç®€å•å·¥åŽ‚æ¨¡å¼ã€‚ åä¹‹ï¼Œå·¥åŽ‚æ–¹æ³•æ¨¡å¼ä¹Ÿç›¸å½“äºŽâ€å¤šæ€â€çš„ç®€å•å·¥åŽ‚æ¨¡å¼ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>å·¥åŽ‚æ–¹æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼01ä¹‹ ç®€å•å·¥åŽ‚æ¨¡å¼(åˆ›å»ºæ¨¡å¼)]]></title>
    <url>%2F2014%2F05%2F14%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F01%E4%B9%8B-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ç®€å•å·¥åŽ‚æ¨¡å¼ç®€ä»‹ç®€å•å·¥åŽ‚æ¨¡å¼(Simple Factory)ï¼Œåˆè¢«ç§°ä¸ºâ€é™æ€å·¥åŽ‚æ–¹æ³•æ¨¡å¼â€ã€‚å®ƒå±žäºŽâ€åˆ›å»ºæ¨¡å¼â€(åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼)ï¼Œå¹¶ä¸”æ˜¯â€å·¥åŽ‚æ–¹æ³•â€æ¨¡å¼çš„ä¸€ç§ç‰¹æ®Šå®žçŽ°ã€‚ é€šå¸¸ï¼Œæˆ‘ä»¬åˆ©ç”¨ç®€å•å·¥åŽ‚æ¨¡å¼æ¥è¿›è¡Œç±»çš„åˆ›å»ºã€‚ä¾‹å¦‚ï¼ŒèŽ·å–çº¿ç¨‹æ± å¯¹è±¡ï¼Œå°±æ˜¯é€šè¿‡ç®€å•å·¥åŽ‚æ¨¡å¼æ¥å®žçŽ°çš„ã€‚å®ƒçš„ç»“æž„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ç®€å•å·¥åŽ‚æ¨¡å¼çš„ç»“æž„å…±åŒ…æ‹¬3ä¸ªç»„æˆéƒ¨åˆ†ï¼šå·¥åŽ‚(Factory)ï¼ŒæŠ½è±¡äº§å“(Product)ï¼Œå…·ä½“äº§å“(ConcreteProduct)ã€‚ ç»„æˆéƒ¨åˆ† è¯´æ˜Ž å·¥åŽ‚ å·¥åŽ‚æ˜¯ç®€å•å·¥åŽ‚æ¨¡å¼çš„æ ¸å¿ƒï¼Œæä¾›äº†å¯¹å¤–æŽ¥å£ã€‚å®¢æˆ·ç«¯æˆ–å…¶å®ƒç¨‹åºè¦èŽ·å–Productå¯¹è±¡ï¼Œéƒ½æ˜¯é€šè¿‡Factoryçš„æŽ¥å£æ¥èŽ·å–çš„ã€‚ æŠ½è±¡äº§å“ æŠ½è±¡äº§å“æ˜¯(è®¸å¤š)ä¸åŒäº§å“æŠ½è±¡å‡ºæ¥çš„ã€‚Productå¯ä»¥æ˜¯æŽ¥å£æˆ–è€…æŠ½è±¡ç±»ã€‚ å…·ä½“äº§å“ å·¥åŽ‚ä¸­è¿”å›žçš„äº§å“å¯¹è±¡ï¼Œå®žé™…ä¸Šæ˜¯é€šè¿‡ConcreteProductæ¥åˆ›å»ºçš„ã€‚ ç®€å•å·¥åŽ‚æ¨¡å¼ä»£ç æ¨¡åž‹public class Factory { public static Product newInstance() { return new ConcreteProduct(); } } public abstract Product { } public class ConcreteProduct extends Product { public ConcreteProduct() {} } æ¨¡åž‹çš„ç±»å›¾ ç®€å•å·¥åŽ‚æ¨¡å¼ç¤ºä¾‹å‡è®¾çŽ°åœ¨æœ‰ä¸€ä¸ªæ°´æžœå·¥åŽ‚ï¼Œèƒ½å¤Ÿç”Ÿæˆå„ç§å„æ ·çš„æ°´æžœã€‚ç›®å‰èƒ½ç”Ÿäº§çš„æ°´æžœåŒ…æ‹¬è‹¹æžœï¼Œè‘¡è„å’Œè‰èŽ“ã€‚ æˆ‘ä»¬é€šè¿‡â€ç®€å•å·¥åŽ‚æ¨¡å¼â€æè¿°è¯¥é—®é¢˜ï¼Œå®ƒçš„UMLç±»å›¾å¦‚ä¸‹ï¼š å·¥åŽ‚ç±»å·¥åŽ‚ç±»æ˜¯â€FruitFactoryâ€ã€‚FruitFactoryæ˜¯æ°´æžœå·¥åŽ‚ï¼Œæ°´æžœå·¥åŽ‚ä¼šç”Ÿæˆæ°´æžœã€‚ FruitFactoryçš„æºç  public class FruitFactory { public static Fruit newInstance(String name) throws BadFruitException { // å¦‚æžœnameç­‰äºŽ&quot;apple&quot;(å¿½ç•¥å¤§å°å†™)ï¼Œåˆ™è¿”å›žè‹¹æžœã€‚ if (&quot;apple&quot;.equalsIgnoreCase(name)) { return new Apple(); // å¦‚æžœnameç­‰äºŽ&quot;grape&quot;(å¿½ç•¥å¤§å°å†™)ï¼Œåˆ™è¿”å›žè‘¡è„ã€‚ } else if (&quot;grape&quot;.equalsIgnoreCase(name)) { return new Grape(); // å¦‚æžœnameç­‰äºŽ&quot;strawberry&quot;(å¿½ç•¥å¤§å°å†™)ï¼Œåˆ™è¿”å›žè‰èŽ“ã€‚ } else if (&quot;strawberry&quot;.equalsIgnoreCase(name)) { return new Strawberry(); // å…¶å®ƒæƒ…å†µï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ } else { throw new BadFruitException(&quot;Bad fruit request!&quot;); } } } æŠ½è±¡äº§å“ç±»Productç±»æ˜¯â€Fruitâ€ã€‚Fruitä»£è¡¨æ°´æžœï¼Œå®ƒæ˜¯æŠ½è±¡ç±»ï¼ŒåŒ…å«æ°´æžœçš„åŸºæœ¬ç‰¹å¾ï¼šç”Ÿé•¿ï¼Œç§æ¤ï¼Œæ”¶èŽ·ã€‚ Fruitçš„æºç  public abstract class Fruit { abstract void grow(); // ç”Ÿé•¿ abstract void harvest(); // æ”¶èŽ· abstract void plant(); // ç§æ¤ } å…·ä½“äº§å“ç±»å…·ä½“äº§å“ç±»æ˜¯â€Appleâ€, â€œGrapeâ€å’Œâ€Strawberryâ€ã€‚å®ƒä»¬æ˜¯3ç§å…·ä½“çš„æ°´æžœï¼Œåˆ†åˆ«ä»£è¡¨è‹¹æžœï¼Œè‘¡è„å’Œè‰èŽ“ã€‚ Appleçš„æºç  // Appleå®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ï¼Œå¹¶ä¸”Appleä¸­æœ‰ç§æœ‰æˆå‘˜ageå’Œç§æœ‰æ–¹æ³•logã€‚ public class Apple extends Fruit { private int age; public void grow() { log(&quot;Apple grow()&quot;); } public void harvest() { log(&quot;Apple harvest()&quot;); } public void plant() { log(&quot;Apple plant()&quot;); } public void setAge(int age) { this.age = age; } public int getAge() { return age; } private void log(String msg) { System.out.println(msg); } } Grapeçš„æºç  // Grapeä»…ä»…åªå®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ã€‚ public class Grape extends Fruit { public void grow() { System.out.println(&quot;Grape grow()&quot;); } public void harvest() { System.out.println(&quot;Grape harvest()&quot;); } public void plant() { System.out.println(&quot;Grape plant()&quot;); } } Strawberryçš„æºç  // Strawberryå®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ï¼Œå¹¶ä¸”Strawberryä¸­æœ‰ç§æœ‰æ–¹æ³•log public class Strawberry extends Fruit { public void grow() { log(&quot;Strawberry grow()&quot;); } public void harvest() { log(&quot;Strawberry harvest()&quot;); } public void plant() { log(&quot;Strawberry plant()&quot;); } private void log(String msg) { System.out.println(msg); } } å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åºå®¢æˆ·ç«¯æ˜¯â€Clientâ€ã€‚ Clientçš„æºç  public class Client { public static void main(String[] args) { try { Fruit apple = FruitFactory.newInstance(&quot;Apple&quot;); apple.plant(); apple.grow(); apple.harvest(); Fruit grape = FruitFactory.newInstance(&quot;Grape&quot;); grape.plant(); grape.grow(); grape.harvest(); Fruit strawberry = FruitFactory.newInstance(&quot;strawberry&quot;); strawberry.plant(); strawberry.grow(); strawberry.harvest(); Fruit error = FruitFactory.newInstance(&quot;error&quot;); error.plant(); error.grow(); error.harvest(); } catch (BadFruitException e) { e.printStackTrace(); } } } è¿è¡Œç»“æžœï¼š Apple plant() Apple grow() Apple harvest() Grape plant() Grape grow() Grape harvest() Strawberry plant() Strawberry grow() Strawberry harvest() BadFruitException: Bad fruit request! at FruitFactory.newInstance(FruitFactory.java:17) at Client.main(Client.java:21) ç»“æžœè¯´æ˜Žï¼š ClientæˆåŠŸåˆ›å»ºäº†Apple, Grape, Strawberryè¿™3ä¸ªæ°´æžœå¯¹è±¡ï¼Œå¹¶è°ƒç”¨äº†å®ƒä»¬çš„æ–¹æ³•ï¼›ç„¶åŽåˆ›å»ºerroræ—¶ï¼Œç”±äºŽä¸å­˜åœ¨errorå¯¹åº”çš„æ°´æžœï¼Œå› æ­¤æŠ›å‡ºå¼‚å¸¸ã€‚ (01) Fruitï¼Œæ˜¯æŠ½è±¡äº§å“ã€‚Fruitä¸­å£°æ˜Žäº†grow(), harvest(), plant()è¿™3ä¸ªå‡½æ•°æŽ¥å£ï¼Œå®ƒä»¬æ˜¯æ°´æžœå…±ç”¨æ‹¥æœ‰çš„è¡Œä¸ºã€‚ (02) Apple, Grapeå’ŒStrawberryè¿™ä¸‰ä¸ªç±»æ˜¯å…·ä½“äº§å“ã€‚Apple â€“ å®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ï¼Œå¹¶ä¸”Appleä¸­æœ‰ç§æœ‰æˆå‘˜ageå’Œç§æœ‰æ–¹æ³•logã€‚Grape â€“ ä»…ä»…åªå®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ã€‚Strawberry â€“ å®žçŽ°Fruitçš„å‡½æ•°æŽ¥å£ï¼Œå¹¶ä¸”Strawberryä¸­æœ‰ç§æœ‰æ–¹æ³•log (03) FruitFactoryï¼Œæ˜¯å·¥åŽ‚ç±»ã€‚é€šè¿‡å®ƒçš„newInstance()æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥èŽ·å–ç›¸åº”çš„Fruitå¯¹è±¡ã€‚è‹¥è¦èŽ·å–çš„æ°´æžœä¸å­˜åœ¨ï¼Œåˆ™æŠ›å‡ºBadFruitExceptionå¼‚å¸¸ã€‚BadFruitExceptionæ˜¯Exceptionçš„å­ç±»ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>å·¥åŽ‚æ¨¡å¼</tag>
      </tags>
  </entry>
</search>
